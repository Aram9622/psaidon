function mqPrepTabs(t,e){$(".tab_content").hide(),$("ul.tabs li").removeClass("active").each(function(n,i){if(0==n){$(i).addClass("active").show();var r=$(i).find("a").attr("href");$(r).show()}else if(1==n){var r;$(i).hide()}else 2==n?"int"==e?$(i).show():$(i).hide():3==n?"ineq"==e?$(i).show():$(i).hide():1==t?$(i).show():$(i).hide()})}function mqeemousemove(t){return $("#mqee").css("left",t.pageX-mqmousebase.left+lasteepos.left).css("top",t.pageY-mqmousebase.top+lasteepos.top),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),!1}function mqeetouchmove(t){var e=t.originalEvent.changedTouches[0]||t.originalEvent.touches[0];return $("#mqee").css("left",e.pageX-mqmousebase.left+lasteepos.left).css("top",e.pageY-mqmousebase.top+lasteepos.top),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),!1}function mqeeinsert(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation();var e=$(this).attr("btntext"),n=$(this).attr("btntype");return e=e.replace("\\\\","\\"),0==n?mqarea.mathquill("cmd",e).find("input,textarea").focus():1==n?mqarea.mathquill("write",e).find("input,textarea").focus():2==n?mqarea.mathquill("writesimpfunc",e).find("input,textarea").focus():3==n?mqarea.mathquill("writefunc",e).find("input,textarea").focus():4==n?mqarea.mathquill("writeint",e).find("input,textarea").focus():5==n?mqarea.mathquill("movecursor",e).find("input,textarea").focus():6==n?mqarea.mathquill("writebracket",e).find("input,textarea").focus():7==n&&mqarea.mathquill("writefrac",e).find("input,textarea").focus(),!1}function showeedd(t,e,n){mqeeddclosetimer&&(window.clearTimeout(mqeeddclosetimer),mqeeddclosetimer=null),hideee(),cureedd={id:t,type:e,extras:n};var i=$("#mqeedd"),r=$("#"+t),s=r.offset();s.left+=r.outerWidth(),i.css("left",s.left+"px").css("top",s.top+"px").height(r.outerHeight()-2).show()}function updateeeddpos(){if(cureedd){var t=$("#mqeedd"),e=$("#"+cureedd.id),n=e.offset();n.left+=e.outerWidth(),t.css("left",n.left+"px").css("top",n.top+"px").height(e.outerHeight()-2).show()}}function hideeedd(){mqeeddclosetimer=setTimeout(function(){$("#mqeedd").hide()},250)}function mqeetoggleactive(t){for(var e=1;5>=e;e++)t==e?($("#mqeetab"+e).addClass("mqeeactive").removeClass("mqeehighlight"),document.getElementById("mqee"+e).style.display=""):(document.getElementById("mqee"+e).style.display="none",$("#mqeetab"+e).removeClass("mqeeactive"));mqeeactivetab=t,mqarea.find("input,textarea").focus()}function showee(){mqPrepTabs(cureedd.type-3,cureedd.extras);var t=$("#mqee");if(lasteepos){var e=$(window).scrollTop()-lasteepos.scroll;lasteepos.top=lasteepos.top+e,lasteepos.scroll=$(window).scrollTop()}else lasteepos={left:($(window).width()-t.outerWidth())/2,top:$(window).scrollTop()+((window.innerHeight?window.innerHeight:$(window).height())-t.outerHeight())/2,scroll:$(window).scrollTop()};t.css("left",lasteepos.left).css("top",lasteepos.top).show(),mqarea.mathquill("latex",AMtoMQ($("#"+cureedd.id).val())),mqarea.find("input,textarea").focus()}function hideee(){$("#mqee").hide()}function savemathquill(){var t=MQtoAM(mqarea.mathquill("latex"));$("#"+cureedd.id).val(t),""!=t&&$("#"+cureedd.id).siblings("input[value=spec]").prop("checked",!0);var e=$("#pbtn"+cureedd.id.substr(2));e&&e.trigger("click"),hideee()}function eebasicinsert(t){if(el=document.getElementById(eebasiccurel),el.setSelectionRange)var e=el.selectionEnd-el.selectionStart;else if(document.selection&&document.selection.createRange){el.focus();var n=eebasicselstore,e=n.text.length}if(posshift=0,"("==t?(insb="(",insa=")",posshift=1):"sym"==t.substr(0,3)&&(insb="",insa=t.substr(3)),el.setSelectionRange){var i=el.selectionEnd+insa.length+insb.length;el.value=el.value.substring(0,el.selectionStart)+insb+el.value.substring(el.selectionStart,el.selectionEnd)+insa+el.value.substring(el.selectionEnd,el.value.length),el.focus(),0==e&&posshift>0&&(i-=posshift),el.setSelectionRange(i,i)}else document.selection&&document.selection.createRange&&(n.text=insb+n.text+insa,0==e&&posshift>0&&n.move("character",-1*posshift),n.select());eebasicselstore=null}function showeebasicselstore(t){null==eebasicselstore&&document.selection&&document.selection.createRange&&(document.getElementById(t).focus(),eebasicselstore=document.selection.createRange())}function showeebasic(t){if(el=document.getElementById(t),el.setSelectionRange){el.selectionEnd-el.selectionStart}else if(document.selection&&document.selection.createRange){var e=eebasicselstore;e.text.length}var n=document.getElementById("eebasic");if(0==eebasicinit){els=n.getElementsByTagName("td");for(var i=0;i<els.length;i++)els[i].onmouseover=eebasiccellhighlight,els[i].onmouseout=eebasiccellunhighlight,els[i].onmousedown=eebasiccellhighlightdown,els[i].onmouseup=eebasiccellhighlight;eebasicinit=!0}1==eebasictype?(document.getElementById("eenumber").style.display="none",document.getElementById("eeinterval").style.display=""):(document.getElementById("eenumber").style.display="",document.getElementById("eeinterval").style.display="none"),t!=eebasiccurel?(eebasiccurel=t,p=findPos(el),n.style.top=p[1]+el.offsetHeight+"px",n.style.display="block",n.offsetWidth<el.offsetWidth?n.style.left=p[0]+el.offsetWidth+10-n.offsetWidth+"px":n.style.left=p[0]+"px"):(n.style.display="none",eebasiccurel=null),unhideebasice(0),el.setSelectionRange?el.focus():document.selection&&document.selection.createRange&&e.select()}function unhideebasice(t){eebasiccancelclosetimer()}function hideebasice(t){null!=eebasiccurel&&(eebasicclosetimer=window.setTimeout(reallyhideebasice,250))}function hideebasicedd(){ddbasicclosetimer=window.setTimeout(function(){cureebasicdd=null,document.getElementById("eebasicdd").style.display="none"},250)}function reallyhideebasice(){var t=document.getElementById("eebasic");t.style.display="none",eebasiccurel=null}function eebasiccancelclosetimer(){eebasicclosetimer&&(window.clearTimeout(eebasicclosetimer),eebasicclosetimer=null)}function eebasiccellhighlight(){this.style.background="#ccf"}function eebasiccellunhighlight(){this.style.background="#fff"}function eebasiccellhighlightdown(){this.style.background="#99f",null==eebasicselstore&&document.selection&&document.selection.createRange&&(document.getElementById(eebasiccurel).focus(),eebasicselstore=document.selection.createRange())}function showeebasicdd(t,e){eebasictype=e,ddbasicclosetimer&&(window.clearTimeout(ddbasicclosetimer),ddbasicclosetimer=null);var n=document.getElementById("eebasicdd"),i=document.getElementById(t);p=findPos(i),n.style.left=p[0]+i.offsetWidth+"px",n.style.top=p[1]+"px",n.style.height=i.offsetHeight-2+"px",n.style.lineHeight=i.offsetHeight+"px",n.style.width="10px",n.style.display="block",cureebasicdd=t}function MQtoAM(t){for(t=t.replace(/\\:/g," ");-1!=(i=t.indexOf("\\left|"));){nested=0;do lb=t.indexOf("\\left|",i+1),rb=t.indexOf("\\right|",i+1),-1!=lb&&lb<rb?nested++:-1!=rb&&(-1==lb||rb<lb)&&nested--;while(nested>0&&-1!=rb);-1!=rb?(t=t.substring(0,rb)+")"+t.substring(rb+7),t=t.substring(0,i)+"abs("+t.substring(i+6)):t=t.substring(0,i)+"|"+t.substring(i+6)}for(t=t.replace(/\\text{\s*or\s*}/g," or "),t=t.replace(/\\text{all\s+real\s+numbers}/g,"all real numbers"),t=t.replace(/\\Re/g,"RR"),t=t.replace(/\\le(?!f)/g,"<="),t=t.replace(/\\ge/g,">="),t=t.replace(/\\cup/g,"U"),t=t.replace(/\\left/g,""),t=t.replace(/\\right/g,""),t=t.replace(/\\langle/g,"<"),t=t.replace(/\\rangle/g,">"),t=t.replace(/\\pm/g,"+-"),t=t.replace(/\\cdot/g,"*"),t=t.replace(/\\infty/g,"oo"),t=t.replace(/\\nthroot/g,"root"),t=t.replace(/\\varnothing/g,"DNE"),t=t.replace(/\\overline/g,"bar"),t=t.replace(/\\nabla/g,"grad"),t=t.replace(/\\partial/g,"del"),t=t.replace(/\\/g,""),t=t.replace(/sqrt\[(.*?)\]/g,"root($1)"),t=t.replace(/(\d)frac/g,"$1 frac");-1!=(i=t.indexOf("frac{"));){for(nested=1,curpos=i+5;nested>0&&curpos<t.length-1;)curpos++,c=t.charAt(curpos),"{"==c?nested++:"}"==c&&nested--;t=0==nested?t.substring(0,i)+"("+t.substring(i+5,curpos)+")/"+t.substring(curpos+1):t.substring(0,i)+t.substring(i+4)}return t=t.replace(/_(\w)/g,"_$1 "),t=t.replace(/_{([\d\.]+)}/g,"_$1"),t=t.replace(/{/g,"("),t=t.replace(/}/g,")"),t=t.replace(/\(([\d\.]+)\)\/\(([\d\.]+)\)/g,"$1/$2"),t=t.replace(/\/\(([\d\.]+)\)/g,"/$1"),t=t.replace(/\(([\d\.]+)\)\//g,"$1/"),t=t.replace(/\/\(([\a-zA-Z])\)/g,"/$1"),t=t.replace(/\(([\a-zA-Z])\)\//g,"$1/"),t=t.replace(/\^\(-1\)/g,"^-1"),t=t.replace(/\^\((-?[\d\.]+)\)/g,"^$1")}!function(){function t(){}function e(t){var e=f.call(arguments,1);return function(){return t.apply(this,e)}}function n(t,e){if(!e)throw new Error("prayer failed: "+t)}function i(t){n("a direction was passed",t===x||t===y)}function r(e,n,i,r){function s(){f=a;var t=l.selection?"$"+l.selection.latex()+"$":"";g.select(t)}function o(){c.detach()}var u=e.contents().detach();i||e.addClass("mathquill-rendered-math"),n.jQ=e.attr(p,n.id),n.revert=function(){e.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(u)};var l=n.cursor=ct(n);if(n.renderLatex(u.text()),navigator.userAgent.match("Android"))var c=n.textarea=w('<span class="textarea"><input type="password"/></span>'),h=c.children();else var c=n.textarea=w('<span class="textarea"><textarea></textarea></span>'),h=c.children();var f;n.selectionChanged=function(){f===a&&(f=setTimeout(s)),B(e[0])},e.bind("selectstart.mathquill",function(t){t.target!==h[0]&&t.preventDefault(),t.stopPropagation()});var d,m=l.blink;if(e.bind("mousedown.mathquill",function(n){function i(t){return l.seek(w(t.target),t.pageX,t.pageY),(l[x]!==d[x]||l.parent!==d.parent)&&l.selectFrom(d),!1}function s(t){return delete t.target,i(t)}function o(t){d=a,l.blink=m,l.selection||(r?l.show():c.detach()),e.unbind("mousemove",i),w(t.target.ownerDocument).unbind("mousemove",s).unbind("mouseup",o)}return setTimeout(function(){document.activeElement!=h[0]&&h.focus()}),l.blink=t,l.seek(w(n.target),n.pageX,n.pageY),d=q(l.parent,l[x],l[y]),r||e.prepend(c),e.mousemove(i),w(n.target.ownerDocument).mousemove(s).mouseup(o),!1}),!r){var g=b(h,{container:e});return e.bind("cut paste",!1).bind("copy",s).prepend('<span class="selectable">$'+n.latex()+"$</span>"),void h.blur(function(){l.clearSelection(),setTimeout(o)})}var g=b(h,{container:e,key:function(t,e){l.parent.bubble("onKey",t,e)},text:function(t){l.parent.bubble("onText",t)},cut:function(t){l.selection&&setTimeout(function(){l.prepareEdit(),l.parent.bubble("redraw")}),t.stopPropagation()},paste:function(t){t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}",l.writeLatex(t).show()}});e.prepend(c),e.addClass("mathquill-editable"),i&&e.addClass("mathquill-textbox"),h.focus(function(t){l.parent||l.insAtRightEnd(n),l.parent.jQ.addClass("hasCursor"),l.selection?(l.selection.jQ.removeClass("blur"),setTimeout(n.selectionChanged)):l.show(),t.stopPropagation()}).blur(function(t){l.hide().parent.blur(),l.selection&&l.selection.jQ.addClass("blur"),t.stopPropagation()}),e.bind("focus.mathquill blur.mathquill",function(t){h.trigger(t)}).bind("click.mathquill",function(t){document.activeElement!=h[0]&&h.focus()}).blur()}function s(t,e,n){return g(J,{ctrlSeq:t,htmlTemplate:"<"+e+" "+n+">&0</"+e+">"})}var a,o,u,l=window.jQuery,c="mathquill-command-id",p="mathquill-block-id",h=Math.min,f=(Math.max,[].slice),m=navigator.userAgent.match("Android"),g=function(t,e,n){function i(t){return"object"==typeof t}function r(t){return"function"==typeof t}function s(){}function a(o,u){function l(){var t=new c;return r(t.init)&&t.init.apply(t,arguments),t}function c(){}u===n&&(u=o,o=Object),l.Bare=c;var p,h=s[t]=o[t],f=c[t]=l[t]=new s;return f.constructor=l,l.mixin=function(e){return c[t]=l[t]=a(l,e)[t],l},(l.open=function(t){if(p={},r(t)?p=t.call(l,f,h,l,o):i(t)&&(p=t),i(p))for(var n in p)e.call(p,n)&&(f[n]=p[n]);return r(f.init)||(f.init=o),l})(u)}return a}("prototype",{}.hasOwnProperty),b=function(){function e(t){var e,i=t.which||t.keyCode,r=n[i],s=[];return t.ctrlKey&&s.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&s.push("Meta"),t.altKey&&s.push("Alt"),t.shiftKey&&s.push("Shift"),e=r||String.fromCharCode(i),s.length||r?(s.push(e),s.join("-")):e}var n={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};return function(n,i){function r(t){C=t,clearTimeout(x),x=setTimeout(t)}function s(e){C(),C=t,clearTimeout(x),j.val(e),e&&j[0].select()}function a(){var t=j[0];return"selectionStart"in t?t.selectionStart!==t.selectionEnd:document.selection&&"Text"===document.selection.type&&document.selection.createRange&&document.selection.createRange().parentElement()===j[0]?!0:!1}function o(t){var e=l.trim(j.val());j.val(" "),e&&t(e)}function u(){w(e(b),b)}function c(t){b=t,v=null;b.which||b.keyCode;m?p():u()}function p(t){b.which||b.keyCode;b&&(v||m)&&u(),v=t,r(h)}function h(){a()||o(y)}function f(){b=v=null}function d(t){j.focus(),r(g)}function g(){o(q)}var b=null,v=null;i||(i={});var x,y=i.text||t,w=i.key||t,q=i.paste||t,k=i.cut||t,j=l(n),Q=l(i.container||j),C=t;return Q.bind("keydown keypress input keyup focusout paste",function(){C()}),Q.bind({keydown:c,keypress:p,focusout:f,cut:k,paste:d}),{select:s}}}(),v=g(function(t,e,i){function r(t,e){throw t=t?"'"+t+"'":"EOF","Parse Error: "+e+" at "+t}t.init=function(t){this._=t},t.parse=function(t){function e(t,e){return e}return this.skip(o)._(t,e,r)},t.or=function(t){n("or is passed a parser",t instanceof i);var e=this;return i(function(n,i,r){function s(e){return t._(n,i,r)}return e._(n,i,s)})},t.then=function(t){var e=this;return i(function(r,s,a){function o(e,r){var o=t instanceof i?t:t(r);return n("a parser is returned",o instanceof i),o._(e,s,a)}return e._(r,o,a)})},t.many=function(){var t=this;return i(function(e,n,i){function r(t,n){return e=t,a.push(n),!0}function s(){return!1}for(var a=[];t._(e,r,s););return n(e,a)})},t.times=function(t,e){arguments.length<2&&(e=t);var n=this;return i(function(i,r,s){function a(t,e){return c.push(e),i=t,!0}function o(t,e){return l=e,i=t,!1}function u(t,e){return!1}for(var l,c=[],p=!0,h=0;t>h;h+=1)if(p=n._(i,a,o),!p)return s(i,l);for(;e>h&&p;h+=1)p=n._(i,a,u);return r(i,c)})},t.result=function(t){return this.then(a(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var e=this;return e.times(t).then(function(t){return e.many().map(function(e){return t.concat(e)})})},t.map=function(t){return this.then(function(e){return a(t(e))})},t.skip=function(t){return this.then(function(e){return t.result(e)})};var s=(this.string=function(t){var e=t.length,n="expected '"+t+"'";return i(function(i,r,s){var a=i.slice(0,e);return a===t?r(i.slice(e),a):s(i,n)})},this.regex=function(t){n("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return i(function(n,i,r){var s=t.exec(n);if(s){var a=s[0];return i(n.slice(a.length),a)}return r(n,e)})}),a=i.succeed=function(t){return i(function(e,n){return n(e,t)})},o=(i.fail=function(t){return i(function(e,n,i){return i(e,t)})},i.letter=s(/^[a-z]/i),i.letters=s(/^[a-z]*/i),i.digit=s(/^[0-9]/),i.digits=s(/^[0-9]*/),i.whitespace=s(/^\s+/),i.optWhitespace=s(/^\s*/),i.any=i(function(t,e,n){return t?e(t.slice(1),t.charAt(0)):n(t,"expected any character")}),i.all=i(function(t,e,n){return e("",t)}),i.eof=i(function(t,e,n){return t?n(t,"expected EOF"):e(t,t)}))}),x=-1,y=1,w=g(l,function(t){t.insDirOf=function(t,e){return t===x?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return t===x?this.prependTo(e):this.appendTo(e)}}),q=g(function(t){t.parent=0,t[x]=0,t[y]=0,t.init=function(t,e,n){this.parent=t,this[x]=e,this[y]=n}}),k=g(function(t){t[x]=0,t[y]=0,t.parent=0,t.init=function(){this.ends={},this.ends[x]=0,this.ends[y]=0},t.children=function(){return j(this.ends[x],this.ends[y])},t.eachChild=function(t){return this.children().each(t)},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.adopt=function(t,e,n){return j(this,this).adopt(t,e,n),this},t.disown=function(){return j(this,this).disown(),this}}),j=g(function(t){function e(t,e,i){n("a parent is always present",t),n("leftward is properly set up",function(){return e?e[y]===i&&e.parent===t:t.ends[x]===i}()),n("rightward is properly set up",function(){return i?i[x]===e&&i.parent===t:t.ends[y]===e}())}t.init=function(t,e){n("no half-empty fragments",!t==!e),this.ends={},t&&(n("left end node is passed to Fragment",t instanceof k),n("right end node is passed to Fragment",e instanceof k),n("leftEnd and rightEnd have the same parent",t.parent===e.parent),this.ends[x]=t,this.ends[y]=e)},t.adopt=function(t,n,i){e(t,n,i);var r=this;r.disowned=!1;var s=r.ends[x];if(!s)return this;var a=r.ends[y];return n||(t.ends[x]=s),i?i[x]=a:t.ends[y]=a,r.ends[y][y]=i,r.each(function(e){e[x]=n,e.parent=t,n&&(n[y]=e),n=e}),r},t.disown=function(){var t=this,n=t.ends[x];if(!n||t.disowned)return t;t.disowned=!0;var i=t.ends[y],r=n.parent;return e(r,n[x],n),e(r,i,i[y]),n[x]?n[x][y]=i[y]:r.ends[x]=i[y],i[y]?i[y][x]=n[x]:r.ends[y]=n[x],t},t.each=function(t){var e=this,n=e.ends[x];if(!n)return e;for(;n!==e.ends[y][y]&&t.call(e,n)!==!1;n=n[y]);return e},t.fold=function(t,e){return this.each(function(n){t=e.call(this,t,n)}),t}}),Q=function(){var t=0;return function(){return t+=1}}(),C=g(k,function(t,e){t.init=function(t){e.init.call(this),this.id=Q(),C[this.id]=this},t.toString=function(){return"[MathElement "+this.id+"]"},t.bubble=function(t){for(var e=f.call(arguments,1),n=this;n;n=n.parent){var i=n[t]&&n[t].apply(n,e);if(i===!1)break}return this},t.postOrder=function(t){var e=f.call(arguments,1);if("string"==typeof t){var n=t;t=function(t){n in t&&t[n].apply(t,e)}}!function i(e){e.eachChild(i),t(e)}(this)},t.jQ=w(),t.jQadd=function(t){this.jQ=this.jQ.add(t)},this.jQize=function(t){var e=w(t);return e.find("*").andSelf().each(function(){var t=w(this),e=t.attr("mathquill-command-id"),n=t.attr("mathquill-block-id");e&&C[e].jQadd(t),n&&C[n].jQadd(t)}),e},t.finalizeInsert=function(){var t=this;t.postOrder("finalizeTree"),t.postOrder("blur"),t.postOrder("respace"),t[y].respace&&t[y].respace(),t[x].respace&&t[x].respace(),t.postOrder("redraw"),t.bubble("redraw")}}),A=g(C,function(e,i){e.init=function(t,e,n){var r=this;i.init.call(r),r.ctrlSeq||(r.ctrlSeq=t),e&&(r.htmlTemplate=e),n&&(r.textTemplate=n)},e.replaces=function(t){t.disown(),this.replacedFragment=t},e.isEmpty=function(){return this.foldChildren(!0,function(t,e){return t&&e.isEmpty()})},e.parser=function(){var t=lt.block,e=this;return t.times(e.numBlocks()).map(function(t){e.blocks=t;for(var n=0;n<t.length;n+=1)t[n].adopt(e,e.ends[y],0);return e})},e.createLeftOf=function(t){var e=this,n=e.replacedFragment;e.createBlocks(),C.jQize(e.html()),n&&(n.adopt(e.ends[x],0,0),n.jQ.appendTo(e.ends[x].jQ)),t.jQ.before(e.jQ),t[x]=e.adopt(t.parent,t[x],t[y]),e.finalizeInsert(t),e.placeCursor(t)},e.createBlocks=function(){for(var t=this,e=t.numBlocks(),n=t.blocks=Array(e),i=0;e>i;i+=1){var r=n[i]=$();r.adopt(t,t.ends[y],0)}},e.respace=t,e.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[x],function(t,e){return t.isEmpty()?t:e}))},e.remove=function(){return this.disown(),this.jQ.remove(),this.postOrder(function(t){delete C[t.id]}),this},e.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},e.html=function(){var t=this,e=t.blocks,i=" mathquill-command-id="+t.id,r=t.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);n("no unmatched angle brackets",r.join("")===this.htmlTemplate);for(var s=0,a=r[0];a;s+=1,a=r[s])if("/>"===a.slice(-2))r[s]=a.slice(0,-2)+i+"/>";else if("<"===a.charAt(0)){n("not an unmatched top-level close tag","/"!==a.charAt(1)),r[s]=a.slice(0,-1)+i+">";var o=1;do s+=1,a=r[s],n("no missing close tags",a),"</"===a.slice(0,2)?o-=1:"<"===a.charAt(0)&&"/>"!==a.slice(-2)&&(o+=1);while(o>0)}return r.join("").replace(/>&(\d+)/g,function(t,n){return" mathquill-block-id="+e[n].id+">"+e[n].join("html")})},e.latex=function(){return this.foldChildren(this.ctrlSeq,function(t,e){return t+"{"+(e.latex()||" ")+"}"})},e.textTemplate=[""],e.text=function(){var t=0;return this.foldChildren(this.textTemplate[t],function(e,n){t+=1;var i=n.text();return e&&"("===this.textTemplate[t]&&"("===i[0]&&")"===i.slice(-1)?e+i.slice(1,-1)+this.textTemplate[t]:e+n.text()+(this.textTemplate[t]||"")})}}),L=g(A,function(e,n){e.init=function(t,e,i){i||(i=t&&t.length>1?t.slice(1):t),n.init.call(this,t,e,[i])},e.parser=function(){return v.succeed(this)},e.numBlocks=function(){return 0},e.replaces=function(t){t.remove()},e.createBlocks=t,e.latex=function(){return this.ctrlSeq},e.text=function(){return this.textTemplate},e.placeCursor=t,e.isEmpty=function(){return!0}}),$=g(C,function(t){t.join=function(t){return this.foldChildren("",function(e,n){return e+n[t]()})},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[x]===this.ends[y]?this.ends[x].text():"("+this.join("text")+")"},t.isEmpty=function(){return 0===this.ends[x]&&0===this.ends[y]},t.write=function(t,e,n){var i;i=e.match(/^[a-eg-zA-Z]$/)?et(e):(i=R[e]||T[e])?i(e):nt(e),n&&i.replaces(n),i.createLeftOf(t)},t.focus=function(){return this.jQ.addClass("hasCursor"),this.jQ.removeClass("empty"),this},t.blur=function(){return this.jQ.removeClass("hasCursor"),this.isEmpty()&&this.jQ.addClass("empty"),this}}),S=g(j,function(t,e){t.init=function(t,n){e.init.call(this,t,n||t),this.jQ=this.fold(w(),function(t,e){return e.jQ.add(t)})},t.latex=function(){return this.fold("",function(t,e){return t+e.latex()})},t.remove=function(){return this.jQ.remove(),this.each(function(t){t.postOrder(function(t){delete C[t.id]})}),this.disown()}}),E=g($,function(t,e){t.latex=function(){return e.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},t.text=function(){return this.foldChildren("",function(t,e){return t+e.text()})},t.renderLatex=function(t){var e=this.jQ;e.children().slice(1).remove(),this.ends[x]=this.ends[y]=0,delete this.cursor.selection,this.cursor.insAtRightEnd(this).writeLatex(t)},t.onKey=function(t,e){switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":for(;this.cursor[x]||this.cursor.selection;)this.cursor.backspace();break;case"Shift-Backspace":case"Backspace":this.cursor.backspace();break;case"Esc":case"Tab":case"Spacebar":var n=this.cursor.parent;if(n===this.cursor.root)return void("Spacebar"===t&&e.preventDefault());this.cursor.prepareMove(),n[y]?this.cursor.insAtLeftEnd(n[y]):this.cursor.insRightOf(n.parent);break;case"Shift-Tab":case"Shift-Esc":case"Shift-Spacebar":var n=this.cursor.parent;if(n===this.cursor.root)return void("Shift-Spacebar"===t&&e.preventDefault());this.cursor.prepareMove(),n[x]?this.cursor.insAtRightEnd(n[x]):this.cursor.insLeftOf(n.parent);break;case"Enter":"function"==typeof savemathquill&&savemathquill();break;case"End":this.cursor.prepareMove().insAtRightEnd(this.cursor.parent);break;case"Ctrl-End":this.cursor.prepareMove().insAtRightEnd(this);break;case"Shift-End":for(;this.cursor[y];)this.cursor.selectRight();break;case"Ctrl-Shift-End":for(;this.cursor[y]||this.cursor.parent!==this;)this.cursor.selectRight();break;case"Home":this.cursor.prepareMove().insAtLeftEnd(this.cursor.parent);break;case"Ctrl-Home":this.cursor.prepareMove().insAtLeftEnd(this);break;case"Shift-Home":for(;this.cursor[x];)this.cursor.selectLeft();break;case"Ctrl-Shift-Home":for(;this.cursor[x]||this.cursor.parent!==this;)this.cursor.selectLeft();break;case"Left":this.cursor.moveLeft();break;case"Shift-Left":this.cursor.selectLeft();break;case"Ctrl-Left":break;case"Right":this.cursor.moveRight();break;case"Shift-Right":this.cursor.selectRight();break;case"Ctrl-Right":break;case"Up":this.cursor.moveUp();break;case"Down":this.cursor.moveDown();break;case"Shift-Up":if(this.cursor[x])for(;this.cursor[x];)this.cursor.selectLeft();else this.cursor.selectLeft();case"Shift-Down":if(this.cursor[y])for(;this.cursor[y];)this.cursor.selectRight();else this.cursor.selectRight();case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":for(;this.cursor[y]||this.cursor.selection;)this.cursor.deleteForward();break;case"Shift-Del":case"Del":this.cursor.deleteForward();break;case"Meta-A":case"Ctrl-A":if(this!==this.cursor.root)return;for(this.cursor.prepareMove().insAtRightEnd(this);this.cursor[x];)this.cursor.selectLeft();break;default:return!1}return e.preventDefault(),!1},t.onText=function(t){return this.cursor.write(t),!1}}),D=g(A,function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mathquill-rendered-math">&0</span>',t.createBlocks=function(){this.ends[x]=this.ends[y]=E(),this.blocks=[this.ends[x]],this.ends[x].parent=this,this.ends[x].cursor=this.cursor,this.ends[x].write=function(t,e,n){"$"!==e?$.prototype.write.call(this,t,e,n):this.isEmpty()?(t.insRightOf(this.parent).backspace().show(),nt("\\$","$").createLeftOf(t)):t[y]?t[x]?$.prototype.write.call(this,t,e,n):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[x].latex()+"$"}}),O=g($,function(t){t.renderLatex=function(t){var e=this,n=e.cursor;e.jQ.children().slice(1).remove(),e.ends[x]=e.ends[y]=0,delete n.selection,n.show().insAtRightEnd(e);var i=v.regex,r=v.string,s=v.eof,a=v.all,o=r("$").then(lt).skip(r("$").or(s)).map(function(t){var e=D(n);e.createBlocks();var i=e.ends[x];return t.children().adopt(i,0,0),e}),u=r("\\$").result("$"),l=u.or(i(/^[^$]/)).map(nt),c=o.or(l).many(),p=c.skip(s).or(a.result(!1)).parse(t);if(p){for(var h=0;h<p.length;h+=1)p[h].adopt(e,e.ends[y],0);var f=e.join("html");C.jQize(f).appendTo(e.jQ),this.finalizeInsert()}},t.onKey=function(t){"Spacebar"!==t&&"Shift-Spacebar"!==t&&E.prototype.onKey.apply(this,arguments)},t.onText=E.prototype.onText,t.write=function(t,e,n){if(n&&n.remove(),"$"===e)D(t).createLeftOf(t);else{var i;"<"===e?i="&lt;":">"===e&&(i="&gt;"),nt(e,i).createLeftOf(t)}}}),R={},T={},B=t,z=document.createElement("div"),I=z.style,_={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1};for(var P in _)if(P in I){u=P;break}u?o=function(t,e,n){t.css(u,"scale("+e+","+n+")")}:"filter"in I?(B=function(t){t.className=t.className},o=function(t,e,n){function i(){t.css("marginRight",(1+t.width())*(e-1)/e+"px")}e/=1+(n-1)/2,t.addClass("matrixed").css({fontSize:n+.05+"em",marginTop:"-.05em",filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')"}),i();var r=setInterval(i);w(window).load(function(){clearTimeout(r),i()})}):o=function(t,e,n){t.css("fontSize",n+"em")};var W=g(A,function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+" "+i+">&0</"+n+">")}});T.mathrm=e(W,"\\mathrm","span",'class="roman font"'),T.mathit=e(W,"\\mathit","i",'class="font"'),T.mathbf=e(W,"\\mathbf","b",'class="font"'),T.mathsf=e(W,"\\mathsf","span",'class="sans-serif font"'),T.mathtt=e(W,"\\mathtt","span",'class="monospace font"'),T.underline=e(W,"\\underline","span",'class="non-leaf underline"'),T.overline=T.bar=e(W,"\\overline","span",'class="non-leaf overline"');var M=g(A,function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+' class="non-leaf">&0</'+n+">",[i])},t.finalizeTree=function(){function t(t){var e=this.parent,n=t;do{if(n[y])return t.insLeftOf(e),!1;n=n.parent.parent}while(n!==e);return t.insRightOf(e),!1}n("SupSub is only _ and ^","^"===this.ctrlSeq||"_"===this.ctrlSeq),"_"===this.ctrlSeq?(this.down=this.ends[x],this.ends[x].up=t):(this.up=this.ends[x],this.ends[x].down=t)},t.latex=function(){var t=this.ends[x].latex();return 1===t.length?this.ctrlSeq+t:this.ctrlSeq+"{"+(t||" ")+"}"},t.redraw=function(){this[x]&&this[x].respace(),this[x]instanceof M||(this.respace(),!this[y]||this[y]instanceof M||this[y].respace())},t.respace=function(){if("\\int "===this[x].ctrlSeq||this[x]instanceof M&&this[x].ctrlSeq!=this.ctrlSeq&&this[x][x]&&"\\int "===this[x][x].ctrlSeq?this.limit||(this.limit=!0,this.jQ.addClass("limit")):this.limit&&(this.limit=!1,this.jQ.removeClass("limit")),this.respaced=this[x]instanceof M&&this[x].ctrlSeq!=this.ctrlSeq&&!this[x].respaced,this.respaced){var t=+this.jQ.css("fontSize").slice(0,-2),e=this[x].jQ.outerWidth(),n=this.jQ.outerWidth();this.jQ.css({left:(this.limit&&"_"===this.ctrlSeq?-.25:0)-e/t+"em",marginRight:.1-h(n,e)/t+"em"})}else this.limit&&"_"===this.ctrlSeq?this.jQ.css({left:"-.25em",marginRight:""}):this.jQ.css({left:"",marginRight:""});return this[y]instanceof M&&this[y].respace(),this}});T.subscript=T._=e(M,"_","sub","_"),T.superscript=T.supscript=T["^"]=e(M,"^","sup","**");var H=T.frac=T.dfrac=T.cfrac=T.fraction=g(A,function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="fraction non-leaf"><span class="numerator">&0</span><span class="denominator">&1</span><span style="display:inline-block;width:0">&nbsp;</span></span>',t.textTemplate=["(","/",")"],t.finalizeTree=function(){this.up=this.ends[y].up=this.ends[x],this.down=this.ends[x].down=this.ends[y]},t.redraw=function(){if(l.browser.msie&&parseInt(l.browser.version,10)<=7){var t,e=this.jQ,n=e.children(".numerator"),i=e.children(".denominator");n.css("width","auto"),i.css("width","auto"),t=Math.max(n.width(),i.width()),n.css("width",t+"px"),i.css("width",t+"px")}}}),U=T.over=R["/"]=g(H,function(t,e){t.createLeftOf=function(t){if(!this.replacedFragment){for(var n=t[x];n&&!(n instanceof st||n instanceof J||n instanceof ot||",;:".indexOf(n.ctrlSeq)>-1);)n=n[x];n instanceof ot&&n[y]instanceof M&&(n=n[y],n[y]instanceof M&&n[y].ctrlSeq!=n.ctrlSeq&&(n=n[y])),n!==t[x]&&(this.replaces(S(n[y]||t.parent.ends[x],t[x])),t[x]=n)}e.createLeftOf.call(this,t)}}),F=T.sqrt=T["âˆš"]=g(A,function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="non-leaf"><span class="scaled sqrt-prefix">&radic;</span><span class="non-leaf sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return lt.optBlock.then(function(t){return lt.block.map(function(e){var n=N();return n.blocks=[t,e],t.adopt(n,0,0),e.adopt(n,t,0),n})}).or(e.parser.call(this))},t.redraw=function(){var t=this.ends[y].jQ;o(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1)}}),N=(T.vec=g(A,function(t,e){t.ctrlSeq="\\vec",t.htmlTemplate='<span class="non-leaf"><span class="vector-prefix">&rarr;</span><span class="vector-stem">&0</span></span>',t.textTemplate=["vec(",")"]}),T.nthroot=g(F,function(t,e){t.htmlTemplate='<sup class="nthroot non-leaf">&0</sup><span class="scaled"><span class="sqrt-prefix scaled">&radic;</span><span class="sqrt-stem non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[x].latex()+"]{"+this.ends[y].latex()+"}"}})),K=g(A,function(t,e){t.init=function(t,n,i,r){e.init.call(this,"\\left"+i,'<span class="non-leaf"><span class="scaled paren">'+t+'</span><span class="non-leaf">&0</span><span class="scaled paren">'+n+"</span></span>",[t,n]),this.end="\\right"+r},t.jQadd=function(){e.jQadd.apply(this,arguments);var t=this.jQ;this.bracketjQs=t.children(":first").add(t.children(":last"))},t.latex=function(){return this.ctrlSeq+this.ends[x].latex()+this.end},t.redraw=function(){var t=this.ends[x].jQ,e=t.outerHeight()/+t.css("fontSize").slice(0,-2);o(this.bracketjQs,h(1+.2*(e-1),1.2),1.05*e)}});T.left=g(A,function(t){t.parser=function(){var t=v.regex,e=v.string,n=v.succeed,i=v.optWhitespace;return i.then(t(/^(?:[([|]|\\\{)/)).then(function(r){"\\"===r.charAt(0)&&(r=r.slice(1));var s=R[r]();return lt.map(function(t){s.blocks=[t],t.adopt(s,0,0)}).then(e("\\right")).skip(i).then(t(/^(?:[\])|]|\\\})/)).then(function(t){return t.slice(-1)!==s.end.slice(-1)?v.fail("open doesn't match close"):n(s)})})}}),T.right=g(A,function(t){t.parser=function(){return v.fail("unmatched \\right")}}),T.intervalopenleft=e(K,"(","]","(","]"),T.intervalopenright=e(K,"[",")","[",")"),T.lbrace=R["{"]=e(K,"{","}","\\{","\\}"),T.langle=T.lang=e(K,"&lang;","&rang;","\\langle ","\\rangle ");var X=g(K,function(t,e){t.createLeftOf=function(t){t[y]||!t.parent.parent||t.parent.parent.end!==this.end||this.replacedFragment?e.createLeftOf.call(this,t):t.insRightOf(t.parent.parent);
},t.placeCursor=function(t){this.ends[x].blur(),t.insRightOf(this)}});T.rbrace=R["}"]=e(X,"{","}","\\{","\\}"),T.rangle=T.rang=e(X,"&lang;","&rang;","\\langle ","\\rangle ");var Z=function(t,e){t.init=function(t,n){e.init.call(this,t,n,t,n)}},Y=g(K,Z);T.lparen=R["("]=e(Y,"(",")"),T.lbrack=T.lbracket=R["["]=e(Y,"[","]");var G=g(X,Z);T.rparen=R[")"]=e(G,"(",")"),T.rbrack=T.rbracket=R["]"]=e(G,"[","]");var J=(T.lpipe=T.rpipe=R["|"]=g(Y,function(t,e){t.init=function(){e.init.call(this,"|","|")},t.createLeftOf=X.prototype.createLeftOf}),R.$=T.text=T.textnormal=T.textrm=T.textup=T.textmd=g(A,function(t,e){t.ctrlSeq="\\text",t.htmlTemplate='<span class="text">&0</span>',t.replaces=function(t){t instanceof S?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t)},t.textTemplate=['"','"'],t.parser=function(){var t=this,e=v.string,n=v.regex,i=v.optWhitespace;return i.then(e("{")).then(n(/^[^}]*/)).skip(e("}")).map(function(e){t.createBlocks();for(var n=t.ends[x],i=0;i<e.length;i+=1){var r=nt(e.charAt(i));r.adopt(n,n.ends[y],0)}return t})},t.createBlocks=function(){this.ends[x]=this.ends[y]=V(),this.blocks=[this.ends[x]],this.ends[x].parent=this},t.finalizeInsert=function(){this.ends[x].blur=function(){return delete this.blur,this},e.finalizeInsert.call(this)},t.createLeftOf=function(t){if(e.createLeftOf.call(this,this.cursor=t),this.replacedText)for(var n=0;n<this.replacedText.length;n+=1)this.ends[x].write(t,this.replacedText.charAt(n))}})),V=g($,function(t,e){t.onKey=function(t,e){return"Spacebar"===t||"Shift-Spacebar"===t?!1:void 0},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this.parent)},t.write=function(t,e,n){if(n&&n.remove(),"$"!==e){var i;"<"===e?i="&lt;":">"===e&&(i="&gt;"),nt(e,i).createLeftOf(t)}else if(this.isEmpty())t.insRightOf(this.parent).backspace(),nt("\\$","$").createLeftOf(t);else if(t[y])if(t[x]){var r=J();r.replaces(S(t[y],this.ends[y])),t.insRightOf(this.parent),r.adopt=function(){delete this.adopt,this.adopt.apply(this,arguments),this[x]=0},r.createLeftOf(t),r[x]=this.parent,t.insLeftOf(r)}else t.insLeftOf(this.parent);else t.insRightOf(this.parent);return!1},t.blur=function(){if(this.jQ.removeClass("hasCursor"),this.isEmpty()){var t=this.parent,e=t.cursor;e.parent===this?this.jQ.addClass("empty"):(e.hide(),t.remove(),e[y]===t?e[y]=t[y]:e[x]===t&&(e[x]=t[x]),e.show().parent.bubble("redraw"))}return this},t.focus=function(){e.focus.call(this);var t=this.parent;if(t[y].ctrlSeq===t.ctrlSeq){var n=this,i=t.cursor,r=t[y].ends[x];r.eachChild(function(t){t.parent=n,t.jQ.appendTo(n.jQ)}),this.ends[y]?this.ends[y][y]=r.ends[x]:this.ends[x]=r.ends[x],r.ends[x][x]=this.ends[y],this.ends[y]=r.ends[y],r.parent.remove(),i[x]?i.insRightOf(i[x]):i.insAtLeftEnd(this),i.parent.bubble("redraw")}else if(t[x].ctrlSeq===t.ctrlSeq){var i=t.cursor;i[x]?t[x].ends[x].focus():i.insAtRightEnd(t[x].ends[x])}return this}});T.em=T.italic=T.italics=T.emph=T.textit=T.textsl=s("\\textit","i",'class="text"'),T.strong=T.bold=T.textbf=s("\\textbf","b",'class="text"'),T.sf=T.textsf=s("\\textsf","span",'class="sans-serif text"'),T.tt=T.texttt=s("\\texttt","span",'class="monospace text"'),T.textsc=s("\\textsc","span",'style="font-variant:small-caps" class="text"'),T.uppercase=s("\\uppercase","span",'style="text-transform:uppercase" class="text"'),T.lowercase=s("\\lowercase","span",'style="text-transform:lowercase" class="text"');var tt=(R["\\"]=g(A,function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="latex-command-input non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[x].focus=function(){return this.parent.jQ.addClass("hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("empty"),this},this.ends[x].blur=function(){return this.parent.jQ.removeClass("hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("empty"),this}},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this.cursor=t.insAtRightEnd(this.ends[x]),this._replacedFragment){var n=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(t){return w(t.target=n).trigger(t),!1}).insertBefore(this.jQ).add(this.jQ)}this.ends[x].write=function(t,e,n){n&&n.remove(),e.match(/[a-z]/i)?nt(e).createLeftOf(t):(this.parent.renderCommand(),"\\"===e&&this.isEmpty()||this.parent.parent.write(t,e))}},t.latex=function(){return"\\"+this.ends[x].latex()+" "},t.onKey=function(t,e){return"Tab"===t||"Enter"===t||"Spacebar"===t?(this.renderCommand(),e.preventDefault(),!1):void 0},t.renderCommand=function(){this.jQ=this.jQ.last(),this.remove(),this[y]?this.cursor.insLeftOf(this[y]):this.cursor.insAtRightEnd(this.parent);var t=this.ends[x].latex();t||(t="backslash"),this.cursor.insertCmd(t,this._replacedFragment)}}),T.binom=T.binomial=g(A,function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="paren scaled">(</span><span class="non-leaf"><span class="array non-leaf"><span>&0</span><span>&1</span></span></span><span class="paren scaled">)</span>',t.textTemplate=["choose(",",",")"],t.redraw=function(){var t=this.jQ.eq(1),e=t.outerHeight()/+t.css("fontSize").slice(0,-2),n=this.jQ.filter(".paren");o(n,h(1+.2*(e-1),1.2),1.05*e)}}));T.choose=g(tt,function(t){t.createLeftOf=U.prototype.createLeftOf}),T.vector=g(A,function(t,e){t.ctrlSeq="\\vector",t.htmlTemplate='<span class="array"><span>&0</span></span>',t.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(t,e){return t.push(e.latex()),t}).join("\\\\")+"\\end{matrix}"},t.text=function(){return"["+this.foldChildren([],function(t,e){return t.push(e.text()),t}).join()+"]"},t.createLeftOf=function(t){e.createLeftOf.call(this,this.cursor=t)},t.onKey=function(t,e){var n=this.cursor.parent;if(n.parent===this){if("Enter"===t){var i=$();return i.parent=this,i.jQ=w("<span></span>").attr(p,i.id).insertAfter(n.jQ),n[y]?n[y][x]=i:this.ends[y]=i,i[y]=n[y],n[y]=i,i[x]=n,this.bubble("redraw").cursor.insAtRightEnd(i),e.preventDefault(),!1}if("Tab"===t&&!n[y]){if(n.isEmpty())return n[x]?(this.cursor.insRightOf(this),delete n[x][y],this.ends[y]=n[x],n.jQ.remove(),this.bubble("redraw"),e.preventDefault(),!1):void 0;var i=$();return i.parent=this,i.jQ=w("<span></span>").attr(p,i.id).appendTo(this.jQ),this.ends[y]=i,n[y]=i,i[x]=n,this.bubble("redraw").cursor.insAtRightEnd(i),e.preventDefault(),!1}if(8===e.which){if(n.isEmpty())return n[x]?(this.cursor.insAtRightEnd(n[x]),n[x][y]=n[y]):(this.cursor.insLeftOf(this),this.ends[x]=n[y]),n[y]?n[y][x]=n[x]:this.ends[y]=n[x],n.jQ.remove(),this.isEmpty()?this.cursor.deleteForward():this.bubble("redraw"),e.preventDefault(),!1;if(!this.cursor[x])return e.preventDefault(),!1}}}});T.editable=g(D,function(t,e){t.init=function(){A.prototype.init.call(this,"\\editable")},t.jQadd=function(){var t=this;e.jQadd.apply(t,arguments);var n=t.ends[x].disown(),i=t.jQ.children().detach();t.ends[x]=t.ends[y]=E(),t.blocks=[t.ends[x]],t.ends[x].parent=t,r(t.jQ,t.ends[x],!1,!0),t.cursor=t.ends[x].cursor,n.children().adopt(t.ends[x],0,0),i.appendTo(t.ends[x].jQ),t.ends[x].cursor.insAtRightEnd(t.ends[x])},t.latex=function(){return this.ends[x].latex()},t.text=function(){return this.ends[x].text()}}),T.f=e(L,"f",'<var class="florin">&fnof;</var><span style="display:inline-block;width:0">&nbsp;</span>');var et=g(L,function(t,e){t.init=function(t,n){e.init.call(this,t,"<var>"+(n||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return!this[x]||this[x]instanceof et||this[x]instanceof st||(t="*"+t),!this[y]||this[y]instanceof st||"^"===this[y].ctrlSeq||(t+="*"),t},t.createLeftOf=function(t){var e=this.ctrlSeq;for(d=t[x];d&&d instanceof et;)e=d.ctrlSeq+e,d=d[x];var n;if(n=e.match(/(sqrt|root|arcsin|arccos|arctan|sin|cos|tan|sec|csc|cot|log|ln)/)){for(var i=0;i<n[0].length-1;i++)t.selectLeft();"root"==n[0]&&(n[0]="nthroot{3}"),n[0].match(/(sqrt|root)/)?t.writeLatex("\\"+n[0]+"{}").parent.blur():t.writeLatex("\\"+n[0]+"\\left(\\right)").parent.blur(),t.moveLeft()}else(n=e.match(/(pi|^oo)$/))?("oo"==n[0]&&(n[0]="infty"),t.selectLeft(),t.writeLatex("\\"+n[0]).parent.blur()):A.prototype.createLeftOf.apply(this,arguments)}}),nt=g(L,function(t,e){t.init=function(t,n){e.init.call(this,t,"<span>"+(n||t)+"</span>")}});R[" "]=e(nt,"\\:"," "),T.prime=R["'"]=e(nt,"'","&prime;");var it=g(L,function(t,e){t.init=function(t,n){e.init.call(this,t,'<span class="nonSymbola">'+(n||t)+"</span>")}});T["@"]=it,T["&"]=e(it,"\\&","&amp;"),T["%"]=e(it,"\\%","%"),T.alpha=T.beta=T.gamma=T.delta=T.zeta=T.eta=T.theta=T.iota=T.kappa=T.mu=T.nu=T.xi=T.rho=T.sigma=T.tau=T.chi=T.psi=T.omega=g(et,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),T.phi=e(et,"\\phi ","&#981;"),T.phiv=T.varphi=e(et,"\\varphi ","&phi;"),T.epsilon=e(et,"\\epsilon ","&#1013;"),T.epsiv=T.varepsilon=e(et,"\\varepsilon ","&epsilon;"),T.piv=T.varpi=e(et,"\\varpi ","&piv;"),T.sigmaf=T.sigmav=T.varsigma=e(et,"\\varsigma ","&sigmaf;"),T.thetav=T.vartheta=T.thetasym=e(et,"\\vartheta ","&thetasym;"),T.upsilon=T.upsi=e(et,"\\upsilon ","&upsilon;"),T.gammad=T.Gammad=T.digamma=e(et,"\\digamma ","&#989;"),T.kappav=T.varkappa=e(et,"\\varkappa ","&#1008;"),T.rhov=T.varrho=e(et,"\\varrho ","&#1009;"),T.pi=T["Ï€"]=e(it,"\\pi ","&pi;"),T.lambda=e(it,"\\lambda ","&lambda;"),T.Upsilon=T.Upsi=T.upsih=T.Upsih=e(L,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),T.Gamma=T.Delta=T.Theta=T.Lambda=T.Xi=T.Pi=T.Sigma=T.Phi=T.Psi=T.Omega=T.forall=g(nt,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}});var rt=g(A,function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){t.writeLatex(this.latex)},t.parser=function(){var t=lt.parse(this.latex).children();return v.succeed(t)}});T["¹"]=e(rt,"^1"),T["²"]=e(rt,"^2"),T["³"]=e(rt,"^3"),T["¼"]=e(rt,"\\frac14"),T["½"]=e(rt,"\\frac12"),T["¾"]=e(rt,"\\frac34");var st=g(L,function(t,e){t.init=function(t,n,i){e.init.call(this,t,'<span class="binary-operator">'+n+"</span>",i)}}),at=g(st,function(t){t.init=nt.prototype.init,t.respace=function(){return this[x]?this[x]instanceof st&&this[y]&&!(this[y]instanceof st)?this.jQ[0].className="unary-operator":this.jQ[0].className="binary-operator":this.jQ[0].className="",this}});T["+"]=e(at,"+","+"),T["–"]=T["-"]=e(at,"-","&minus;"),T["±"]=T.pm=T.plusmn=T.plusminus=e(at,"\\pm ","&plusmn;"),T.mp=T.mnplus=T.minusplus=e(at,"\\mp ","&#8723;"),R["*"]=T.sdot=T.cdot=e(st,"\\cdot ","&middot;"),T["="]=e(st,"=","="),T["<"]=e(st,"<","&lt;"),T[">"]=e(st,">","&gt;"),T.notin=T.sim=T.cong=T.equiv=T.oplus=T.otimes=g(st,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),T.times=e(st,"\\times ","&times;","[x]"),T["÷"]=T.div=T.divide=T.divides=e(st,"\\div ","&divide;","[/]"),T["≠"]=T.ne=T.neq=e(st,"\\ne ","&ne;"),T.ast=T.star=T.loast=T.lowast=e(st,"\\ast ","&lowast;"),T.therefor=T.therefore=e(st,"\\therefore ","&there4;"),T.cuz=T.because=e(st,"\\because ","&#8757;"),T.prop=T.propto=e(st,"\\propto ","&prop;"),T["≈"]=T.asymp=T.approx=e(st,"\\approx ","&asymp;"),T.lt=e(st,"<","&lt;"),T.gt=e(st,">","&gt;"),T["≤"]=T.le=T.leq=e(st,"\\le ","&le;"),T["≥"]=T.ge=T.geq=e(st,"\\ge ","&ge;"),T.isin=T["in"]=e(st,"\\in ","&isin;"),T.ni=T.contains=e(st,"\\ni ","&ni;"),T.notni=T.niton=T.notcontains=T.doesnotcontain=e(st,"\\not\\ni ","&#8716;"),T.sub=T.subset=e(st,"\\subset ","&sub;"),T.sup=T.supset=T.superset=e(st,"\\supset ","&sup;"),T.nsub=T.notsub=T.nsubset=T.notsubset=e(st,"\\not\\subset ","&#8836;"),T.nsup=T.notsup=T.nsupset=T.notsupset=T.nsuperset=T.notsuperset=e(st,"\\not\\supset ","&#8837;"),T.sube=T.subeq=T.subsete=T.subseteq=e(st,"\\subseteq ","&sube;"),T.supe=T.supeq=T.supsete=T.supseteq=T.supersete=T.superseteq=e(st,"\\supseteq ","&supe;"),T.nsube=T.nsubeq=T.notsube=T.notsubeq=T.nsubsete=T.nsubseteq=T.notsubsete=T.notsubseteq=e(st,"\\not\\subseteq ","&#8840;"),T.nsupe=T.nsupeq=T.notsupe=T.notsupeq=T.nsupsete=T.nsupseteq=T.notsupsete=T.notsupseteq=T.nsupersete=T.nsuperseteq=T.notsupersete=T.notsuperseteq=e(st,"\\not\\supseteq ","&#8841;");var ot=g(L,function(t,e){t.init=function(t,n){e.init.call(this,t,"<big>"+n+"</big>")}});T["∑"]=T.sum=T.summation=e(ot,"\\sum ","&sum;"),T["∏"]=T.prod=T.product=e(ot,"\\prod ","&prod;"),T.coprod=T.coproduct=e(ot,"\\coprod ","&#8720;"),T["∫"]=T["int"]=T.integral=e(ot,"\\int ","&int;"),T.N=T.naturals=T.Naturals=e(nt,"\\mathbb{N}","&#8469;"),T.P=T.primes=T.Primes=T.projective=T.Projective=T.probability=T.Probability=e(nt,"\\mathbb{P}","&#8473;"),T.Z=T.integers=T.Integers=e(nt,"\\mathbb{Z}","&#8484;"),T.Q=T.rationals=T.Rationals=e(nt,"\\mathbb{Q}","&#8474;"),T.R=T.reals=T.Reals=e(nt,"\\mathbb{R}","&#8477;"),T.C=T.complex=T.Complex=T.complexes=T.Complexes=T.complexplane=T.Complexplane=T.ComplexPlane=e(nt,"\\mathbb{C}","&#8450;"),T.H=T.Hamiltonian=T.quaternions=T.Quaternions=e(nt,"\\mathbb{H}","&#8461;"),T.quad=T.emsp=e(nt,"\\quad ","    "),T.qquad=e(nt,"\\qquad ","        "),T.diamond=e(nt,"\\diamond ","&#9671;"),T.bigtriangleup=e(nt,"\\bigtriangleup ","&#9651;"),T.ominus=e(nt,"\\ominus ","&#8854;"),T.uplus=e(nt,"\\uplus ","&#8846;"),T.bigtriangledown=e(nt,"\\bigtriangledown ","&#9661;"),T.sqcap=e(nt,"\\sqcap ","&#8851;"),T.triangleleft=e(nt,"\\triangleleft ","&#8882;"),T.sqcup=e(nt,"\\sqcup ","&#8852;"),T.triangleright=e(nt,"\\triangleright ","&#8883;"),T.odot=e(nt,"\\odot ","&#8857;"),T.bigcirc=e(nt,"\\bigcirc ","&#9711;"),T.dagger=e(nt,"\\dagger ","&#0134;"),T.ddagger=e(nt,"\\ddagger ","&#135;"),T.wr=e(nt,"\\wr ","&#8768;"),T.amalg=e(nt,"\\amalg ","&#8720;"),T.models=e(nt,"\\models ","&#8872;"),T.prec=e(nt,"\\prec ","&#8826;"),T.succ=e(nt,"\\succ ","&#8827;"),T.preceq=e(nt,"\\preceq ","&#8828;"),T.succeq=e(nt,"\\succeq ","&#8829;"),T.simeq=e(nt,"\\simeq ","&#8771;"),T.mid=e(nt,"\\mid ","&#8739;"),T.ll=e(nt,"\\ll ","&#8810;"),T.gg=e(nt,"\\gg ","&#8811;"),T.parallel=e(nt,"\\parallel ","&#8741;"),T.bowtie=e(nt,"\\bowtie ","&#8904;"),T.sqsubset=e(nt,"\\sqsubset ","&#8847;"),T.sqsupset=e(nt,"\\sqsupset ","&#8848;"),T.smile=e(nt,"\\smile ","&#8995;"),T.sqsubseteq=e(nt,"\\sqsubseteq ","&#8849;"),T.sqsupseteq=e(nt,"\\sqsupseteq ","&#8850;"),T.doteq=e(nt,"\\doteq ","&#8784;"),T.frown=e(nt,"\\frown ","&#8994;"),T.vdash=e(nt,"\\vdash ","&#8870;"),T.dashv=e(nt,"\\dashv ","&#8867;"),T.longleftarrow=e(nt,"\\longleftarrow ","&#8592;"),T.longrightarrow=e(nt,"\\longrightarrow ","&#8594;"),T.Longleftarrow=e(nt,"\\Longleftarrow ","&#8656;"),T.Longrightarrow=e(nt,"\\Longrightarrow ","&#8658;"),T.longleftrightarrow=e(nt,"\\longleftrightarrow ","&#8596;"),T.updownarrow=e(nt,"\\updownarrow ","&#8597;"),T.Longleftrightarrow=e(nt,"\\Longleftrightarrow ","&#8660;"),T.Updownarrow=e(nt,"\\Updownarrow ","&#8661;"),T.mapsto=e(nt,"\\mapsto ","&#8614;"),T.nearrow=e(nt,"\\nearrow ","&#8599;"),T.hookleftarrow=e(nt,"\\hookleftarrow ","&#8617;"),T.hookrightarrow=e(nt,"\\hookrightarrow ","&#8618;"),T.searrow=e(nt,"\\searrow ","&#8600;"),T.leftharpoonup=e(nt,"\\leftharpoonup ","&#8636;"),T.rightharpoonup=e(nt,"\\rightharpoonup ","&#8640;"),T.swarrow=e(nt,"\\swarrow ","&#8601;"),T.leftharpoondown=e(nt,"\\leftharpoondown ","&#8637;"),T.rightharpoondown=e(nt,"\\rightharpoondown ","&#8641;"),T.nwarrow=e(nt,"\\nwarrow ","&#8598;"),T.ldots=e(nt,"\\ldots ","&#8230;"),T.cdots=e(nt,"\\cdots ","&#8943;"),T.vdots=e(nt,"\\vdots ","&#8942;"),T.ddots=e(nt,"\\ddots ","&#8944;"),T.surd=e(nt,"\\surd ","&#8730;"),T.triangle=e(nt,"\\triangle ","&#9653;"),T.ell=e(nt,"\\ell ","&#8467;"),T.top=e(nt,"\\top ","&#8868;"),T.flat=e(nt,"\\flat ","&#9837;"),T.natural=e(nt,"\\natural ","&#9838;"),T.sharp=e(nt,"\\sharp ","&#9839;"),T.wp=e(nt,"\\wp ","&#8472;"),T.bot=e(nt,"\\bot ","&#8869;"),T.clubsuit=e(nt,"\\clubsuit ","&#9827;"),T.diamondsuit=e(nt,"\\diamondsuit ","&#9826;"),T.heartsuit=e(nt,"\\heartsuit ","&#9825;"),T.spadesuit=e(nt,"\\spadesuit ","&#9824;"),T.oint=e(nt,"\\oint ","&#8750;"),T.bigcap=e(nt,"\\bigcap ","&#8745;"),T.bigcup=e(nt,"\\bigcup ","&#8746;"),T.bigsqcup=e(nt,"\\bigsqcup ","&#8852;"),T.bigvee=e(nt,"\\bigvee ","&#8744;"),T.bigwedge=e(nt,"\\bigwedge ","&#8743;"),T.bigodot=e(nt,"\\bigodot ","&#8857;"),T.bigotimes=e(nt,"\\bigotimes ","&#8855;"),T.bigoplus=e(nt,"\\bigoplus ","&#8853;"),T.biguplus=e(nt,"\\biguplus ","&#8846;"),T.lfloor=e(nt,"\\lfloor ","&#8970;"),T.rfloor=e(nt,"\\rfloor ","&#8971;"),T.lceil=e(nt,"\\lceil ","&#8968;"),T.rceil=e(nt,"\\rceil ","&#8969;"),T.slash=e(nt,"\\slash ","&#47;"),T.opencurlybrace=e(nt,"\\opencurlybrace ","&#123;"),T.closecurlybrace=e(nt,"\\closecurlybrace ","&#125;"),T.caret=e(nt,"\\caret ","^"),T.underscore=e(nt,"\\underscore ","_"),T.backslash=e(nt,"\\backslash ","\\"),T.vert=e(nt,"|"),T.perp=T.perpendicular=e(nt,"\\perp ","&perp;"),T.nabla=T.del=e(nt,"\\nabla ","&nabla;"),T.hbar=e(nt,"\\hbar ","&#8463;"),T.AA=T.Angstrom=T.angstrom=e(nt,"\\text\\AA ","&#8491;"),T.ring=T.circ=T.circle=e(nt,"\\circ ","&#8728;"),T.bull=T.bullet=e(nt,"\\bullet ","&bull;"),T.setminus=T.smallsetminus=e(nt,"\\setminus ","&#8726;"),T.not=T["¬"]=T.neg=e(nt,"\\neg ","&not;"),T["…"]=T.dots=T.ellip=T.hellip=T.ellipsis=T.hellipsis=e(nt,"\\dots ","&hellip;"),T.converges=T.darr=T.dnarr=T.dnarrow=T.downarrow=e(nt,"\\downarrow ","&darr;"),T.dArr=T.dnArr=T.dnArrow=T.Downarrow=e(nt,"\\Downarrow ","&dArr;"),T.diverges=T.uarr=T.uparrow=e(nt,"\\uparrow ","&uarr;"),T.uArr=T.Uparrow=e(nt,"\\Uparrow ","&uArr;"),T.to=e(st,"\\to ","&rarr;"),T.rarr=T.rightarrow=e(nt,"\\rightarrow ","&rarr;"),T.implies=e(st,"\\Rightarrow ","&rArr;"),T.rArr=T.Rightarrow=e(nt,"\\Rightarrow ","&rArr;"),T.gets=e(st,"\\gets ","&larr;"),T.larr=T.leftarrow=e(nt,"\\leftarrow ","&larr;"),T.impliedby=e(st,"\\Leftarrow ","&lArr;"),T.lArr=T.Leftarrow=e(nt,"\\Leftarrow ","&lArr;"),T.harr=T.lrarr=T.leftrightarrow=e(nt,"\\leftrightarrow ","&harr;"),T.iff=e(st,"\\Leftrightarrow ","&hArr;"),T.hArr=T.lrArr=T.Leftrightarrow=e(nt,"\\Leftrightarrow ","&hArr;"),T.Re=T.Real=T.real=e(nt,"\\Re ","&real;"),T.Im=T.imag=T.image=T.imagin=T.imaginary=T.Imaginary=e(nt,"\\Im ","&image;"),T.part=T.partial=e(nt,"\\partial ","&part;"),T.inf=T.infin=T.infty=T.infinity=e(nt,"\\infty ","&infin;"),T.alef=T.alefsym=T.aleph=T.alephsym=e(nt,"\\aleph ","&alefsym;"),T.xist=T.xists=T.exist=T.exists=e(nt,"\\exists ","&exist;"),T.and=T.land=T.wedge=e(nt,"\\wedge ","&and;"),T.or=T.lor=T.vee=e(nt,"\\vee ","&or;"),T.o=T.O=T.empty=T.emptyset=T.oslash=T.Oslash=T.nothing=T.varnothing=e(st,"\\varnothing ","&empty;"),T.cup=T.union=e(st,"\\cup ","&cup;"),T.cap=T.intersect=T.intersection=e(st,"\\cap ","&cap;"),T.deg=T.degree=e(nt,"^\\circ ","&deg;"),T.ang=T.angle=e(nt,"\\angle ","&ang;");var ut=g(L,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","<span>"+t+"</span>")},t.respace=function(){this.jQ[0].className=this[y]instanceof M||this[y]instanceof K?"":"non-italicized-function"}});T.ln=T.lg=T.log=T.span=T.proj=T.det=T.dim=T.min=T.max=T.mod=T.lcm=T.gcd=T.gcf=T.hcf=T.lim=ut,function(){var t=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(var e in t)T[t[e]]=T[t[e]+"h"]=T["a"+t[e]]=T["arc"+t[e]]=T["a"+t[e]+"h"]=T["arc"+t[e]+"h"]=ut}();var lt=function(){function t(t){var e=$();return t.adopt(e,0,0),e}function e(t){for(var e=t[0]||$(),n=1;n<t.length;n+=1)t[n].children().adopt(e,e.ends[y],0);return e}var n=v.string,i=v.regex,r=v.letter,s=v.any,a=v.optWhitespace,o=v.succeed,u=v.fail,l=r.map(et),c=i(/^[^${}\\_^]/).map(nt),p=i(/^[^\\a-eg-zA-Z]/).or(n("\\").then(i(/^[a-z]+/i).or(i(/^\s+/).result(" ")).or(s))).then(function(t){var e=T[t];return e?e(t).parser():u("unknown command: \\"+t)}),h=p.or(l).or(c),f=n("{").then(function(){return m}).skip(n("}")),d=a.then(f.or(h.map(t))),m=d.many().map(e).skip(a),g=n("[").then(d.then(function(t){return"]"!==t.join("latex")?o(t):u()}).many().map(e).skip(a)).skip(n("]")),b=m;return b.block=d,b.optBlock=g,b}(),ct=g(q,function(t){function e(t,e){if(t[y][e])t.insAtLeftEnd(t[y][e]);else if(t[x][e])t.insAtRightEnd(t[x][e]);else{var i=t.parent;do{var r=i[e];if(r&&("function"==typeof r&&(r=i[e](t)),r===!1||r instanceof $)){if(t.upDownCache[i.id]=q(t.parent,t[x],t[y]),r instanceof $){var s=t.upDownCache[r.id];if(s)s[y]?t.insLeftOf(s[y]):t.insAtRightEnd(s.parent);else{var a=n(t).left;t.insAtRightEnd(r),t.seekHoriz(a,r)}}break}i=i.parent.parent}while(i)}return t.clearSelection().show()}function n(t){var e=t.jQ.removeClass("cursor").offset();return t.jQ.addClass("cursor"),e}function r(t){t.upDownCache={}}t.init=function(t){this.parent=this.root=t;var e=this.jQ=this._jQ=w('<span class="cursor">&zwj;</span>');this.blink=function(){e.toggleClass("blink")},this.upDownCache={}},t.show=function(){return this.jQ=this._jQ.removeClass("blink"),"intervalId"in this?clearInterval(this.intervalId):(this[y]?this.selection&&this.selection.ends[x][x]===this[x]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[y].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=w(),this},t.withDirInsertAt=function(t,e,n,i){var r=this.parent;this.parent=e,this[t]=n,this[-t]=i,r.blur()},t.insDirOf=function(t,e){return i(t),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("hasCursor"),this.jQ.insDirOf(t,e.jQ),this},t.insLeftOf=function(t){return this.insDirOf(x,t)},t.insRightOf=function(t){return this.insDirOf(y,t)},t.insAtDirEnd=function(t,e){return i(t),this.withDirInsertAt(t,e,0,e.ends[t]),t===x&&e.textarea?this.jQ.insDirOf(-t,e.textarea):this.jQ.insAtDirEnd(t,e.jQ),e.focus(),this},t.insAtLeftEnd=function(t){return this.insAtDirEnd(x,t)},t.insAtRightEnd=function(t){return this.insAtDirEnd(y,t)},t.hopDir=function(t){return i(t),this.jQ.insDirOf(t,this[t].jQ),this[-t]=this[t],this[t]=this[t][t],this},t.hopLeft=function(){return this.hopDir(x)},t.hopRight=function(){return this.hopDir(y)},t.moveDirWithin=function(t,e){if(i(t),this[t])this[t].ends[-t]?this.insAtDirEnd(-t,this[t].ends[-t]):this.hopDir(t);else{if(this.parent===e)return;this.parent[t]?this.insAtDirEnd(-t,this.parent[t]):this.insDirOf(t,this.parent.parent)}},t.moveLeftWithin=function(t){return this.moveDirWithin(x,t)},t.moveRightWithin=function(t){return this.moveDirWithin(y,t)},t.moveDir=function(t){return i(t),r(this),this.selection?this.insDirOf(t,this.selection.ends[t]).clearSelection():this.moveDirWithin(t,this.root),this.show()},t.moveLeft=function(){return this.moveDir(x)},t.moveRight=function(){return this.moveDir(y)},t.moveUp=function(){return e(this,"up")},t.moveDown=function(){return e(this,"down")},t.seek=function(t,e,n){r(this);var i,s,a=this.clearSelection().show();return t.hasClass("empty")?(a.insAtLeftEnd(C[t.attr(p)]),a):(i=C[t.attr(c)],i instanceof L?(t.outerWidth()>2*(e-t.offset().left)?a.insLeftOf(i):a.insRightOf(i),a):(i||(s=C[t.attr(p)],s||(t=t.parent(),i=C[t.attr(c)],i||(s=C[t.attr(p)],s||(s=a.root)))),i?a.insRightOf(i):a.insAtRightEnd(s),a.seekHoriz(e,a.root)))},t.seekHoriz=function(t,e){var i,r=this,s=n(r).left-t;do r.moveLeftWithin(e),i=s,s=n(r).left-t;while(s>0&&(r[x]||r.parent!==e));return-s>i&&r.moveRightWithin(e),r},t.writeLatex=function(t){var e=this;r(e),e.show().deleteSelection();var n=v.all,i=v.eof,s=lt.skip(i).or(n.result(!1)).parse(t);return s&&(s.children().adopt(e.parent,e[x],e[y]),C.jQize(s.join("html")).insertBefore(e.jQ),e[x]=s.ends[y],s.finalizeInsert(),e.parent.bubble("redraw")),this.hide()},t.write=function(t){var e=this.prepareWrite();return this.insertCh(t,e)},t.insertCh=function(t,e){return this.parent.write(this,t,e),this},t.insertCmd=function(t,e){var n=T[t];return n?(n=n(t),e&&n.replaces(e),n.createLeftOf(this)):(n=J(),n.replaces(t),n.ends[x].focus=function(){return delete this.focus,this},n.createLeftOf(this),this.insRightOf(n),e&&e.remove()),this},t.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,n=t[y],i=t[x];if(t.disown().eachChild(function(r){r.isEmpty()||(r.children().adopt(e,i,n).each(function(e){e.jQ.insertBefore(t.jQ.first())}),i=r.ends[y])}),!this[y])if(this[x])this[y]=this[x][y];else for(;!this[y];){if(this.parent=this.parent[y],!this.parent){this[y]=t[y],this.parent=e;break}this[y]=this.parent.ends[x]}this[y]?this.insLeftOf(this[y]):this.insAtRightEnd(e),t.jQ.remove(),t[x]&&t[x].respace(),t[y]&&t[y].respace()},t.deleteDir=function(t){if(i(t),r(this),this.show(),this.deleteSelection());else if(this[t])this[t].isEmpty()?this[t]=this[t].remove()[t]:this.selectDir(t);else if(this.parent!==this.root){if(this.parent.parent.isEmpty())return this.insDirOf(-t,this.parent.parent).deleteDir(t);this.unwrapGramp()}return this[x]&&this[x].respace(),this[y]&&this[y].respace(),this.parent.bubble("redraw"),this},t.backspace=function(){return this.deleteDir(x)},t.deleteForward=function(){return this.deleteDir(y)},t.selectFrom=function(t){var e=this,n=t;t:for(;;){for(var i=this;i!==e.parent.parent;i=i.parent.parent)if(i.parent===n.parent){s=i,a=n;break t}for(var r=t;r!==n.parent.parent;r=r.parent.parent)if(e.parent===r.parent){s=e,a=r;break t}e.parent.parent&&(e=e.parent.parent),n.parent.parent&&(n=n.parent.parent)}var s,a,o;if(s[y]!==a){for(var u=s;u;u=u[y])if(u===a[x]){o=!0;break}o||(o=a,a=s,s=o)}this.hide().selection=pt(s[x][y]||s.parent.ends[x],a[y][x]||a.parent.ends[y]),this.insRightOf(a[y][x]||a.parent.ends[y]),this.root.selectionChanged()},t.selectDir=function(t){if(i(t),r(this),this.selection)if(this.selection.ends[t]===this[-t])this[t]?this.hopDir(t).selection.extendDir(t):this.parent!==this.root&&this.insDirOf(t,this.parent.parent).selection.levelUp();else{if(this.hopDir(t),this.selection.ends[t]===this.selection.ends[-t])return void this.clearSelection().show();this.selection.retractDir(t)}else{if(this[t])this.hopDir(t);else{if(this.parent===this.root)return;this.insDirOf(t,this.parent.parent)}this.hide().selection=pt(this[-t])}this.root.selectionChanged()},t.selectLeft=function(){return this.selectDir(x)},t.selectRight=function(){return this.selectDir(y)},t.prepareMove=function(){return r(this),this.show().clearSelection()},t.prepareEdit=function(){return r(this),this.show().deleteSelection()},t.prepareWrite=function(){return r(this),this.show().replaceSelection()},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.root.selectionChanged()),this},t.deleteSelection=function(){return this.selection?(this[x]=this.selection.ends[x][x],this[y]=this.selection.ends[y][y],this.selection.remove(),this.root.selectionChanged(),delete this.selection):!1},t.replaceSelection=function(){var t=this.selection;return t&&(this[x]=t.ends[x][x],this[y]=t.ends[y][y],delete this.selection),t}}),pt=g(S,function(t,e){t.init=function(){var t=this;e.init.apply(t,arguments),t.jQwrap(t.jQ)},t.jQwrap=function(t){this.jQ=t.wrapAll('<span class="selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ.children()),this},t.levelUp=function(){var t=this,e=t.ends[x]=t.ends[y]=t.ends[y].parent.parent;return t.clear().jQwrap(e.jQ),t},t.extendDir=function(t){return i(t),this.ends[t]=this.ends[t][t],this.ends[t].jQ.insAtDirEnd(t,this.jQ),this},t.extendLeft=function(){return this.extendDir(x)},t.extendRight=function(){return this.extendDir(y)},t.retractDir=function(t){i(t),this.ends[-t].jQ.insDirOf(-t,this.jQ),this.ends[-t]=this.ends[-t][t]},t.retractRight=function(){return this.retractDir(y)},t.retractLeft=function(){return this.retractDir(x)}});l.fn.mathquill=function(t,e){switch(t){case"redraw":return this.each(function(){var t=w(this).attr(p),e=t&&C[t];e&&!function n(t){t.eachChild(n),t.redraw&&t.redraw()}(e)});case"revert":return this.each(function(){var t=w(this).attr(p),e=t&&C[t];e&&e.revert&&e.revert()});case"latex":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),n=t&&C[t];n&&n.renderLatex(e)});var n=w(this).attr(p),i=n&&C[n];return i&&i.latex();case"text":var n=w(this).attr(p),i=n&&C[n];return i&&i.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span class="?cursor( blink)?"?><\/span>/i,"").replace(/<span class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),n=t&&C[t],i=n&&n.cursor;i&&i.writeLatex(e).parent.blur()});case"cmd":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),n=t&&C[t],i=n&&n.cursor;if(i){var r=i.prepareWrite();/^\\[a-z]+$/i.test(e)?i.insertCmd(e.slice(1),r):i.insertCh(e,r),i.hide().parent.blur()}});case"writesimpfunc":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),n=t&&C[t],i=n&&n.cursor;i&&(i.selection?i.writeLatex(e+"{"+i.selection.latex()+"}").parent.blur():i.writeLatex(e+"{}").parent.blur(),i.moveLeft())});case"writefunc":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),n=t&&C[t],i=n&&n.cursor;i&&(i.selection?i.writeLatex(e+"\\left("+i.selection.latex()+"\\right)").parent.blur():i.writeLatex(e+"\\left(\\right)").parent.blur(),i.moveLeft())});case"movecursor":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),n=t&&C[t],i=n&&n.cursor;i&&("b"==e?i.backspace():(i.clearSelection().show(),"l"==e?i.moveLeft():"r"==e?i.moveRight():"u"==e?i.moveUp():"d"==e&&i.moveDown()))});case"writefrac":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),e=t&&C[t],n=e&&e.cursor;n&&(n.selection?n.writeLatex("\\frac{"+n.selection.latex()+"}{}").parent.blur():(n.writeLatex("\\frac{}{}").parent.blur(),n.moveLeft()),n.moveLeft())});case"writeint":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),n=t&&C[t],i=n&&n.cursor;if("["==e)var r="\\left[",s="\\right]";else if("("==e)var r="\\left(",s="\\right)";else var r=e+"{",s="}";i&&(i.selection?i.selection.latex().match(/,/)?i.writeLatex(r+i.selection.latex()+s).parent.blur():i.writeLatex(r+i.selection.latex()+","+s).parent.blur():(i.writeLatex(r+","+s).parent.blur(),i.moveLeft()),i.moveLeft())});case"writebracket":if(arguments.length>1)return this.each(function(){var t=w(this).attr(p),n=t&&C[t],i=n&&n.cursor;if("["==e)var r="\\left[",s="\\right]";else if("("==e)var r="\\left(",s="\\right)";else if("|"==e)var r="\\left|",s="\\right|";i&&(i.selection?i.writeLatex(r+i.selection.latex()+s).parent.blur():i.writeLatex(r+s).parent.blur(),i.moveLeft())});default:var s="textbox"===t,a=s||"editable"===t,o=s?O:E;return this.each(function(){r(w(this),o(),s,a)})}},l(function(){l(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable"),l(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox"),l(".mathquill-embedded-latex").mathquill()})}();var mqarea,mqmousebase;$(function(){$(window).load(function(){"ontouchstart"in document.documentElement;mqarea=$(".mathquill-editable"),$(".mathquill-rendered-math").mathquill("redraw"),mqarea.find("input,textarea").focus(),$("input,textarea").attr("autocapitalize","off"),$("#mqee td.mqeebtn").bind("mouseover mouseup",function(){$(this).hasClass("mqeeactive")||$(this).addClass("mqeehighlight")}).bind("mousedown",function(){$(this).addClass("mqeeclick")}).bind("mouseout",function(){$(this).removeClass("mqeehighlight"),$(this).removeClass("mqeeclick")}).bind("mouseup",function(){$(this).removeClass("mqeeclick")}).bind("click",mqeeinsert),$("#mqeeclosebutton").bind("click",hideee),$("#mqeetopbar").mousedown(function(t){t.preventDefault&&t.preventDefault(),$("body").addClass("unselectable"),mqmousebase={left:t.pageX,top:t.pageY},$("body").bind("mousemove",mqeemousemove),$("body").mouseup(function(t){var e=$("#mqee").offset();lasteepos.left=e.left,lasteepos.top=e.top,$("body").unbind("mousemove",mqeemousemove),$("body").removeClass("unselectable"),$(this).unbind(t)})}),$("#mqee td.mqeebtn").bind("touchstart",function(t){t.preventDefault&&t.preventDefault(),$(this).addClass("mqeeclick")}).bind("touchend",function(t){t.preventDefault&&t.preventDefault(),$(this).delay(500).removeClass("mqeeclick")}).bind("touchend",mqeeinsert),
$("#mqeeclosebutton").bind("touchend",function(t){t.preventDefault&&t.preventDefault(),hideee()}),$("#mqeetopbar").bind("touchstart",function(t){t.preventDefault&&t.preventDefault();var e=t.originalEvent.changedTouches[0]||t.originalEvent.touches[0];mqmousebase={left:e.pageX,top:e.pageY},$("body").addClass("unselectable"),$("body").bind("touchmove",mqeetouchmove),$("body").bind("touchend",function(t){var e=$("#mqee").offset();lasteepos.left=e.left,lasteepos.top=e.top,$("body").unbind("touchmove",mqeetouchmove),$("body").removeClass("unselectable"),$(this).unbind(t)})})}),$(document).ready(function(){$(".tab_content").hide(),$("ul.tabs li").click(function(){$("ul.tabs li").removeClass("active"),$(this).addClass("active"),$(".tab_content").hide();var t=$(this).find("a").attr("href");return $(t).show(),!1})})});var mqeeddclosetimer=null,cureedd=null,lasteepos=null,eebasiccurel=null,eebasicinit=!1,eebasicselstore=null,eebasicclosetimer=0,ddbasicclosetimer=0,cureebasicdd=null,eebasictype=0,AMtoMQ=function(){function t(t,e){return t.input>e.input?1:-1}function e(){var e,n=[];for(e=0;e<z.length;e++)"undefined"==typeof z[e].tex||null==z[e].tex||"boolean"==typeof z[e].notexcopy&&z[e].notexcopy||(n[n.length]={input:z[e].tex,tag:z[e].tag,output:z[e].output,ttype:z[e].ttype});for(z=z.concat(n),z.sort(t),e=0;e<z.length;e++)I[e]=z[e].input}function n(t,e){var n;n="\\"==t.charAt(e)&&"\\"!=t.charAt(e+1)&&" "!=t.charAt(e+1)?t.slice(e+1):t.slice(e);for(var i=0;i<n.length&&n.charCodeAt(i)<=32;i+=1);return n.slice(i)}function i(t,e,n){if(0==n){var i,r;for(n=-1,i=t.length;i>n+1;)r=n+i>>1,t[r]<e?n=r:i=r;return i}for(var s=n;s<t.length&&t[s]<e;s++);return s}function r(t){for(var e,n,r,s=0,a=0,o="",u=!0,l=1;l<=t.length&&u;l++)n=t.slice(0,l),a=s,s=i(I,n,a),s<I.length&&t.slice(0,I[s].length)==I[s]&&(o=I[s],e=s,l=o.length),u=s<I.length&&t.slice(0,I[s].length)>=I[s];if(f=d,""!=o)return d=z[e].ttype,z[e];d=g,s=1,n=t.slice(0,1);for(var c=!0;n>="0"&&"9">=n&&s<=t.length;)n=t.slice(s,s+1),s++;if(n==m&&(n=t.slice(s,s+1),n>="0"&&"9">=n))for(c=!1,s++;n>="0"&&"9">=n&&s<=t.length;)n=t.slice(s,s+1),s++;return c&&s>1||s>2?(n=t.slice(0,s-1),r="mn"):(s=2,n=t.slice(0,1),r=("A">n||n>"Z")&&("a">n||n>"z")?"mo":"mi"),"-"==n&&f==x?(d=x,{input:n,tag:r,output:n,ttype:b,func:!0,val:!0}):{input:n,tag:r,output:n,ttype:g,val:!0}}function s(t){var e;return t=a(t),e=t.charAt(0),("("==e||"["==e)&&(t=t.substr(1)),e=t.substr(0,6),("\\left("==e||"\\left["==e||"\\left{"==e)&&(t=t.substr(6)),e=t.substr(0,12),("\\left\\lbrace"==e||"\\left\\langle"==e)&&(t=t.substr(12)),e=t.charAt(t.length-1),(")"==e||"]"==e||"."==e)&&(t=t.substr(0,t.length-7)),e=t.substr(t.length-7,7),("\\rbrace"==e||"\\rangle"==e)&&(t=t.substr(0,t.length-13)),t}function a(t){for(var t=t.replace(/^\s\s*/,""),e=/\s/,n=t.length;e.test(t.charAt(--n)););return t.slice(0,n+1)}function o(t){return"boolean"==typeof t.val&&t.val?pre="":pre="\\",null==t.tex?pre+(""==pre?t.input:t.input.toLowerCase()):pre+t.tex}function u(t){return null==t.tex?t.input:"\\"+t.tex}function l(t){var e,i,a,c,f,d="";if(t=n(t,0),e=r(t),null==e||e.ttype==w&&h>0)return[null,t];switch(e.ttype==j&&(t=e.output+n(t,e.input.length),e=r(t)),e.ttype){case k:case g:t=n(t,e.input.length);var m=o(e);return"\\"==m.charAt(0)||"mo"==e.tag?[m,t]:[m,t];case y:return h++,t=n(t,e.input.length),a=p(t,!0),h--,"\\right"==a[0].substr(0,6)?("\\right."==a[0].substr(0,7)?a[0]=a[0].substr(7):a[0]=a[0].substr(6),i="boolean"==typeof e.invisible&&e.invisible?a[0]:u(e)+a[0]):i="boolean"==typeof e.invisible&&e.invisible?"\\left."+a[0]:"("==e.input&&"]"==a[0].substr(a[0].length-1)?"\\intervalopenleft{"+a[0].substr(0,a[0].length-7)+"}":"["==e.input&&")"==a[0].substr(a[0].length-1)?"\\intervalopenright{"+a[0].substr(0,a[0].length-7)+"}":"<<"==e.input&&"rangle"==a[0].substr(a[0].length-6)?"\\langle{"+a[0].substr(0,a[0].length-7-6)+"}":"\\left"+u(e)+a[0],[i,a[1]];case C:return e!=B&&(t=n(t,e.input.length)),c="{"==t.charAt(0)?t.indexOf("}"):"("==t.charAt(0)?t.indexOf(")"):"["==t.charAt(0)?t.indexOf("]"):e==B?t.slice(1).indexOf('"')+1:0,-1==c&&(c=t.length),f=t.slice(1,c),d+="\\text{"+f+"}",t=n(t,c+1),[d,t];case b:return t=n(t,e.input.length),a=l(t),null==a[0]?[o(e),t]:"boolean"==typeof e.func&&e.func?(f=t.charAt(0),"^"==f||"_"==f||"/"==f||"|"==f||","==f?[o(e),t]:(i="-"==e.input?"-"+a[0]:"abs"==e.input?"\\left|"+s(a[0])+"\\right|":o(e)+("("==f?"":" ")+a[0],[i,a[1]])):(a[0]=s(a[0]),"sqrt"==e.input?["\\sqrt{"+a[0]+"}",a[1]]:"boolean"==typeof e.acc&&e.acc?[o(e)+"{"+a[0]+"}",a[1]]:[o(e)+"{"+a[0]+"}",a[1]]);case v:if(t=n(t,e.input.length),a=l(t),null==a[0])return[o(e),t];a[0]=s(a[0]);var A=l(a[1]);return null==A[0]?[o(e),t]:(A[0]=s(A[0]),"color"==e.input&&(d="{\\color{"+a[0].replace(/[\{\}]/g,"")+"}"+A[0]+"}}"),("root"==e.input||"stackrel"==e.input)&&(d="root"==e.input?"\\nthroot{"+a[0]+"}{"+A[0]+"}":o(e)+"{"+a[0]+"}{"+A[0]+"}"),"frac"==e.input&&(d="\\frac{"+a[0]+"}{"+A[0]+"}"),[d,A[1]]);case x:return t=n(t,e.input.length),[e.output,t];case q:return t=n(t,e.input.length),["\\quad\\text{"+e.input+"}\\quad",t];case Q:h++,t=n(t,e.input.length),a=p(t,!1),h--;var f="";return f=a[0].charAt(a[0].length-1),"|"==f?(i="\\left|"+a[0],[i,a[1]]):(i="\\mid",[i,t]);default:return t=n(t,e.input.length),[o(e),t]}}function c(t){var e,i,a,o,u,c;if(t=n(t,0),i=r(t),u=l(t),o=u[0],t=u[1],e=r(t),e.ttype==x&&"/"!=e.input)if(t=n(t,e.input.length),u=l(t),null==u[0]?u[0]="{}":u[0]=s(u[0]),t=u[1],"_"==e.input)if(a=r(t),c=i.ttype==k,"^"==a.input){t=n(t,a.input.length);var p=l(t);p[0]=s(p[0]),t=p[1],o="{"+o,o+="_{"+u[0]+"}",o+="^{"+p[0]+"}",o+="}"}else o+="_{"+u[0]+"}";else o=o+"^{"+u[0]+"}";return[o+" ",t]}function p(t,e){var i,a,o,l,p="",f=!1;do t=n(t,0),o=c(t),a=o[0],t=o[1],i=r(t),i.ttype==x&&"/"==i.input?(t=n(t,i.input.length),o=c(t),null==o[0]?o[0]="{}":o[0]=s(o[0]),t=o[1],a=s(a),a="\\frac{"+a+"}",a+="{"+o[0]+"}",p+=a,i=r(t)):void 0!=a&&(p+=a);while((i.ttype!=w&&(i.ttype!=Q||e)||0==h)&&null!=i&&""!=i.output);if(i.ttype==w||i.ttype==Q){var d=p.length;if(d>2&&"{"==p.charAt(0)&&p.indexOf(",")>0){var m=p.charAt(d-2);if(")"==m||"]"==m){var g=p.charAt(6);if("("==g&&")"==m&&"}"!=i.output||"["==g&&"]"==m){var b="\\matrix{",v=new Array;v.push(0);var y=!0,q=0,k=[];k[0]=[0];var j=0,C=0;for(l=1;d-1>l;l++)p.charAt(l)==g&&q++,p.charAt(l)==m&&(q--,0==q&&","==p.charAt(l+2)&&"{"==p.charAt(l+3)&&(v.push(l+2),j=l+2,k[j]=[l+2])),("["==p.charAt(l)||"("==p.charAt(l))&&C++,("]"==p.charAt(l)||")"==p.charAt(l))&&C--,","==p.charAt(l)&&1==C&&k[j].push(l);v.push(d);var A=-1;if(0==q&&v.length>0)for(l=0;l<v.length-1;l++){if(l>0&&(b+="\\\\"),0==l)if(1==k[v[l]].length)var L=[p.substr(v[l]+7,v[l+1]-v[l]-15)];else{for(var L=[p.substring(v[l]+7,k[v[l]][1])],$=2;$<k[v[l]].length;$++)L.push(p.substring(k[v[l]][$-1]+1,k[v[l]][$]));L.push(p.substring(k[v[l]][k[v[l]].length-1]+1,v[l+1]-8))}else if(1==k[v[l]].length)var L=[p.substr(v[l]+8,v[l+1]-v[l]-16)];else{for(var L=[p.substring(v[l]+8,k[v[l]][1])],$=2;$<k[v[l]].length;$++)L.push(p.substring(k[v[l]][$-1]+1,k[v[l]][$]));L.push(p.substring(k[v[l]][k[v[l]].length-1]+1,v[l+1]-8))}A>0&&L.length!=A?y=!1:-1==A&&(A=L.length),b+=L.join("&")}b+="}",y&&(p=b)}}}t=n(t,i.input.length),"boolean"==typeof i.invisible&&i.invisible?(p+="\\right.",f=!0):(a="\\right"+u(i),p+=a,f=!0)}return h>0&&!f&&(p+="\\right."),[p,t]}var h,f,d,m=".",g=0,b=1,v=2,x=3,y=4,w=5,q=6,k=7,j=8,Q=9,C=10,A={input:"sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:b},L={input:"root",tag:"mroot",output:"root",tex:null,ttype:v},$={input:"frac",tag:"mfrac",output:"/",tex:null,ttype:v},S={input:"/",tag:"mfrac",output:"/",tex:null,ttype:x},E={input:"stackrel",tag:"mover",output:"stackrel",tex:null,ttype:v},D={input:"_",tag:"msub",output:"_",tex:null,ttype:x},O={input:"^",tag:"msup",output:"^",tex:null,ttype:x},R={input:"text",tag:"mtext",output:"text",tex:null,ttype:C},T={input:"mbox",tag:"mtext",output:"mbox",tex:null,ttype:C},B={input:'"',tag:"mtext",output:"mbox",tex:null,ttype:C},z=[{input:"alpha",tag:"mi",output:"α",tex:null,ttype:g},{input:"beta",tag:"mi",output:"β",tex:null,ttype:g},{input:"chi",tag:"mi",output:"χ",tex:null,ttype:g},{input:"delta",tag:"mi",output:"δ",tex:null,ttype:g},{input:"Delta",tag:"mo",output:"Δ",tex:null,ttype:g},{input:"epsi",tag:"mi",output:"ε",tex:"epsilon",ttype:g},{input:"varepsilon",tag:"mi",output:"ɛ",tex:null,ttype:g},{input:"eta",tag:"mi",output:"η",tex:null,ttype:g},{input:"gamma",tag:"mi",output:"γ",tex:null,ttype:g},{input:"Gamma",tag:"mo",output:"Γ",tex:null,ttype:g},{input:"iota",tag:"mi",output:"ι",tex:null,ttype:g},{input:"kappa",tag:"mi",output:"κ",tex:null,ttype:g},{input:"lambda",tag:"mi",output:"λ",tex:null,ttype:g},{input:"Lambda",tag:"mo",output:"Λ",tex:null,ttype:g},{input:"mu",tag:"mi",output:"μ",tex:null,ttype:g},{input:"nu",tag:"mi",output:"ν",tex:null,ttype:g},{input:"omega",tag:"mi",output:"ω",tex:null,ttype:g},{input:"Omega",tag:"mo",output:"Ω",tex:null,ttype:g},{input:"phi",tag:"mi",output:"φ",tex:null,ttype:g},{input:"varphi",tag:"mi",output:"ϕ",tex:null,ttype:g},{input:"Phi",tag:"mo",output:"Φ",tex:null,ttype:g},{input:"pi",tag:"mi",output:"π",tex:null,ttype:g},{input:"Pi",tag:"mo",output:"Π",tex:null,ttype:g},{input:"psi",tag:"mi",output:"ψ",tex:null,ttype:g},{input:"Psi",tag:"mi",output:"Ψ",tex:null,ttype:g},{input:"rho",tag:"mi",output:"ρ",tex:null,ttype:g},{input:"sigma",tag:"mi",output:"σ",tex:null,ttype:g},{input:"Sigma",tag:"mo",output:"Σ",tex:null,ttype:g},{input:"tau",tag:"mi",output:"τ",tex:null,ttype:g},{input:"theta",tag:"mi",output:"θ",tex:null,ttype:g},{input:"vartheta",tag:"mi",output:"ϑ",tex:null,ttype:g},{input:"Theta",tag:"mo",output:"Θ",tex:null,ttype:g},{input:"upsilon",tag:"mi",output:"υ",tex:null,ttype:g},{input:"xi",tag:"mi",output:"ξ",tex:null,ttype:g},{input:"Xi",tag:"mo",output:"Ξ",tex:null,ttype:g},{input:"zeta",tag:"mi",output:"ζ",tex:null,ttype:g},{input:"*",tag:"mo",output:"⋅",tex:"cdot",ttype:g},{input:"xx",tag:"mo",output:"×",tex:"times",ttype:g},{input:"-:",tag:"mo",output:"÷",tex:"div",ttype:g},{input:"uu",tag:"mo",output:"∪",tex:"cup",ttype:g},{input:"U",tag:"mo",output:"∪",tex:"cup",ttype:g},{input:"sum",tag:"mo",output:"∑",tex:null,ttype:k},{input:"!=",tag:"mo",output:"≠",tex:"ne",ttype:g},{input:"lt",tag:"mo",output:"<",tex:null,ttype:g},{input:"gt",tag:"mo",output:">",tex:null,ttype:g},{input:"<=",tag:"mo",output:"≤",tex:"le",ttype:g},{input:"lt=",tag:"mo",output:"≤",tex:"leq",ttype:g},{input:"gt=",tag:"mo",output:"≥",tex:"geq",ttype:g},{input:">=",tag:"mo",output:"≥",tex:"ge",ttype:g},{input:"geq",tag:"mo",output:"≥",tex:null,ttype:g},{input:"in",tag:"mo",output:"∈",tex:null,ttype:g},{input:"!in",tag:"mo",output:"∉",tex:"notin",ttype:g},{input:"sub",tag:"mo",output:"⊂",tex:"subset",ttype:g},{input:"sup",tag:"mo",output:"⊃",tex:"supset",ttype:g},{input:"sube",tag:"mo",output:"⊆",tex:"subseteq",ttype:g},{input:"supe",tag:"mo",output:"⊇",tex:"supseteq",ttype:g},{input:"(",tag:"mo",output:"(",tex:null,ttype:y},{input:")",tag:"mo",output:")",tex:null,ttype:w},{input:"[",tag:"mo",output:"[",tex:null,ttype:y},{input:"]",tag:"mo",output:"]",tex:null,ttype:w},{input:"{",tag:"mo",output:"{",tex:"lbrace",ttype:y},{input:"}",tag:"mo",output:"}",tex:"rbrace",ttype:w},{input:"|",tag:"mo",output:"|",tex:null,ttype:Q},{input:"(:",tag:"mo",output:"〈",tex:"langle",ttype:y},{input:":)",tag:"mo",output:"〉",tex:"rangle",ttype:w},{input:"<<",tag:"mo",output:"〈",tex:"langle",ttype:y},{input:">>",tag:"mo",output:"〉",tex:"rangle",ttype:w},{input:"int",tag:"mo",output:"∫",tex:null,ttype:g},{input:"+-",tag:"mo",output:"±",tex:"pm",ttype:g},{input:"O/",tag:"mo",output:"∅",tex:"emptyset",ttype:g},{input:"oo",tag:"mo",output:"∞",tex:"infty",ttype:g},{input:"del",tag:"mo",output:"∂",tex:"partial",ttype:g},{input:"grad",tag:"mo",output:"∇",tex:"nabla",ttype:g},{input:"RR",tag:"mo",output:"ℝ",tex:"real",ttype:g},{input:"f",tag:"mi",output:"f",tex:null,ttype:b,func:!0,val:!0},{input:"lim",tag:"mo",output:"lim",tex:null,ttype:k},{input:"Lim",tag:"mo",output:"Lim",tex:null,ttype:k},{input:"sin",tag:"mo",output:"sin",tex:null,ttype:b,func:!0},{input:"cos",tag:"mo",output:"cos",tex:null,ttype:b,func:!0},{input:"tan",tag:"mo",output:"tan",tex:null,ttype:b,func:!0},{input:"arcsin",tag:"mo",output:"arcsin",tex:null,ttype:b,func:!0},{input:"arccos",tag:"mo",output:"arccos",tex:null,ttype:b,func:!0},{input:"arctan",tag:"mo",output:"arctan",tex:null,ttype:b,func:!0},{input:"sinh",tag:"mo",output:"sinh",tex:null,ttype:b,func:!0},{input:"cosh",tag:"mo",output:"cosh",tex:null,ttype:b,func:!0},{input:"tanh",tag:"mo",output:"tanh",tex:null,ttype:b,func:!0},{input:"cot",tag:"mo",output:"cot",tex:null,ttype:b,func:!0},{input:"coth",tag:"mo",output:"coth",tex:null,ttype:b,func:!0},{input:"sech",tag:"mo",output:"sech",tex:null,ttype:b,func:!0},{input:"csch",tag:"mo",output:"csch",tex:null,ttype:b,func:!0},{input:"sec",tag:"mo",output:"sec",tex:null,ttype:b,func:!0},{input:"csc",tag:"mo",output:"csc",tex:null,ttype:b,func:!0},{input:"log",tag:"mo",output:"log",tex:null,ttype:b,func:!0},{input:"ln",tag:"mo",output:"ln",tex:null,ttype:b,func:!0},{input:"abs",tag:"mo",output:"abs",tex:null,ttype:b,func:!0},{input:"Sin",tag:"mo",output:"sin",tex:null,ttype:b,func:!0},{input:"Cos",tag:"mo",output:"cos",tex:null,ttype:b,func:!0},{input:"Tan",tag:"mo",output:"tan",tex:null,ttype:b,func:!0},{input:"Arcsin",tag:"mo",output:"arcsin",tex:null,ttype:b,func:!0},{input:"Arccos",tag:"mo",output:"arccos",tex:null,ttype:b,func:!0},{input:"Arctan",tag:"mo",output:"arctan",tex:null,ttype:b,func:!0},{input:"Sinh",tag:"mo",output:"sinh",tex:null,ttype:b,func:!0},{input:"Sosh",tag:"mo",output:"cosh",tex:null,ttype:b,func:!0},{input:"Tanh",tag:"mo",output:"tanh",tex:null,ttype:b,func:!0},{input:"Cot",tag:"mo",output:"cot",tex:null,ttype:b,func:!0},{input:"Sec",tag:"mo",output:"sec",tex:null,ttype:b,func:!0},{input:"Csc",tag:"mo",output:"csc",tex:null,ttype:b,func:!0},{input:"Log",tag:"mo",output:"log",tex:null,ttype:b,func:!0},{input:"Ln",tag:"mo",output:"ln",tex:null,ttype:b,func:!0},{input:"Abs",tag:"mo",output:"abs",tex:null,ttype:b,func:!0},A,L,$,S,E,D,O,{input:"Sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:b},{input:"bar",tag:"mover",output:"¯",tex:"overline",ttype:b,acc:!0},{input:"vec",tag:"mover",output:"→",tex:null,ttype:b,acc:!0},R,T,B],I=[];return e(),function(t){return h=0,t=t.replace(/(&nbsp;|\u00a0|&#160;)/g,""),t=t.replace(/^\s*<(.*?)>\s*$/,"<<$1>>"),t=t.replace(/&gt;/g,">"),t=t.replace(/&lt;/g,"<"),t=t.replace(/\s*\bor\b\s*/g,'" or "'),t=t.replace(/all\s+real\s+numbers/g,'"all real numbers"'),null==t.match(/\S/)?"":p(t.replace(/^\s+/g,""),!1)[0]}}();