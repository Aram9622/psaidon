var closetimer=0,ddmenuitem=0,homemenuloaded=0;function mopen(a,b){"homemenu"==a&&0==homemenuloaded&&(basicahah(imasroot+"/gethomemenu.php?cid="+b,"homemenu"),homemenuloaded=1);mcancelclosetime();ddmenuitem?(ddmenuitem.style.visibility="hidden",ddmenuitem=null):(ddmenuitem=document.getElementById(a),ddmenuitem.style.visibility="visible")}function mclose(){ddmenuitem&&(ddmenuitem.style.visibility="hidden",ddmenuitem=null)}function mclosetime(){closetimer=window.setTimeout(mclose,250)}
function mcancelclosetime(){closetimer&&(window.clearTimeout(closetimer),closetimer=null)}function basicahah(a,b,c){null==c&&(c=" Fetching data... ");document.getElementById(b).innerHTML=c;c=!1;window.XMLHttpRequest?(req=new XMLHttpRequest,c=!0):window.ActiveXObject&&(req=new ActiveXObject("Microsoft.XMLHTTP"),c=!0);c&&(req.onreadystatechange=function(){basicahahDone(a,b)},req.open("GET",a,!0),req.send(""))}
function basicahahDone(a,b){4==req.readyState&&(200==req.status?document.getElementById(b).innerHTML=req.responseText:document.getElementById(b).innerHTML=" AHAH Error:\n"+req.status+"\n"+req.statusText)}function arraysearch(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return c;return-1}var tipobj=0;
function tipshow(a,b){"object"!=typeof tipobj&&(tipobj=document.createElement("div"),tipobj.className="tips",document.getElementsByTagName("body")[0].appendChild(tipobj));tipobj.innerHTML=b;tipobj.style.left="5px";tipobj.style.display="block";"undefined"!=typeof usingASCIIMath&&"undefined"!=typeof noMathRender&&usingASCIIMath&&!noMathRender&&rendermathnode(tipobj);var c=findPos(a);self.innerHeight?x=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?x=document.documentElement.clientWidth:
document.body&&(x=document.body.clientWidth);var g=0;"number"==typeof window.pageYOffset?g=window.pageXOffset:document.body&&(document.body.scrollLeft||document.body.scrollTop)?g=document.body.scrollLeft:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(g=document.documentElement.scrollLeft);x+=g;c[0]+tipobj.offsetWidth>x&&(c[0]=x-tipobj.offsetWidth-30);tipobj.style.left=c[0]+20+"px";tipobj.style.top=30>c[1]?c[1]+20+"px":c[1]-tipobj.offsetHeight+
"px"}var popupwins=[];function popupwindow(a,b,c,g,l){"fit"==g&&(g=window.height-80);c="width="+c+",height="+g+",status=0,resizable=1,directories=0,menubar=0";null!=l&&1==l&&(c+=",scrollbars=1");"undefined"==typeof popupwins[a]||popupwins[a].closed||popupwins[a].focus();b.match(/^http/)?popupwins[a]=window.open(b,a,c):(l=window.open("",a,c),l.document.write("<html><head><title>Popup</title></head><body>"),l.document.write(b),l.document.write("</body></html>"),l.document.close(),popupwins[a]=l)}
function tipout(a){tipobj.style.display="none"}function findPos(a){var b=curtop=0;if(a.offsetParent){do b+=a.offsetLeft,curtop+=a.offsetTop,a.offsetParent&&(a.parentNode&&a.offsetParent!=a.parentNode?(b-=a.parentNode.scrollLeft,curtop-=a.parentNode.scrollTop):(b-=a.offsetParent.scrollLeft,curtop-=a.offsetParent.scrollTop));while(a=a.offsetParent)}return[b,curtop]}
function togglepic(a){a.getAttribute("src").match("userimg_sm")?a.setAttribute("src",a.getAttribute("src").replace("_sm","_")):a.setAttribute("src",a.getAttribute("src").replace("_","_sm"))}function addLoadEvent(a){var b=window.onload;window.onload="function"!=typeof window.onload?a:function(){b&&b();a()}}
function submitlimiter(a){var b=a.target;"submitted"==b.className?(alert("You have already submitted this page.  Please be patient while your submission is processed."),b.className="submitted2",a.preventDefault?a.preventDefault():a.returnValue=!1):"submitted2"==b.className?a.preventDefault?a.preventDefault():a.returnValue=!1:b.className="submitted"}
function setupFormLimiters(){for(var a=document.getElementsByTagName("form"),b=0;b<a.length;b++)if("function"!=typeof a[b].onsubmit&&"nolimit"!=a[b].className)$(a[b]).on("submit",submitlimiter)}addLoadEvent(setupFormLimiters);var GB_loaded=!1;
function GB_show(a,b,c,g){if(0==GB_loaded){var l=document.createElement("div");l.id="GB_overlay";l.onclick=GB_hide;document.getElementsByTagName("body")[0].appendChild(l);l=document.createElement("div");l.id="GB_window";l.innerHTML='<div id="GB_caption"></div><div id="GB_loading">Loading...</div><div id="GB_frameholder" ></div>';document.getElementsByTagName("body")[0].appendChild(l);GB_loaded=!0}document.getElementById("GB_frameholder").innerHTML='<iframe onload="GB_doneload()" id="GB_frame" src="'+
b+'"></iframe>';jQuery("#GB_frameholder").isolatedScroll();b.match(/libtree/)?(document.getElementById("GB_caption").innerHTML='<span class="floatright"><input type="button" value="Use Libraries" onClick="document.getElementById(\'GB_frame\').contentWindow.setlib()" /> <span class="pointer" onclick="GB_hide()">[X]</span>&nbsp;</span>Select Libraries<div class="clear"></div>',a=self.innerHeight||h&&h.clientHeight||document.body.clientHeight):(document.getElementById("GB_caption").innerHTML='<span class="floatright"><span class="pointer" onclick="GB_hide()">[X]</span></span>'+
a,document.getElementById("GB_caption").onclick=GB_hide,a="auto"==g?self.innerHeight||h&&h.clientHeight||document.body.clientHeight:g);document.getElementById("GB_window").style.display="block";document.getElementById("GB_overlay").style.display="block";document.getElementById("GB_loading").style.display="block";var h=document.documentElement,h=self.innerWidth||h&&h.clientWidth||document.body.clientWidth;document.getElementById("GB_window").style.width=c+"px";document.getElementById("GB_window").style.height=
a-30+"px";document.getElementById("GB_window").style.left=(h-c)/2+"px";document.getElementById("GB_frame").style.height=a-30-34+"px"}function GB_doneload(){document.getElementById("GB_loading").style.display="none"}function GB_hide(){document.getElementById("GB_window").style.display="none";document.getElementById("GB_overlay").style.display="none"}
function chkAllNone(a,b,c,g){a=document.getElementById(a);for(i=0;i<=a.elements.length;i++)try{if("all"==b&&"checkbox"==a.elements[i].type||a.elements[i].name==b)a.elements[i].checked=g&&a.elements[i].className==g?!c:c}catch(l){}return!1}
function initeditor(a,b,c,g,l){c=c||0;g=g||0;var h="";"exact"==a?h="#"+b.split(/,/).join(",#"):"textareas"==a?h="textarea."+b:"divs"==a?h="div."+b:"selector"==a&&(h=b);a={selector:h,inline:g,plugins:["advlist attach image charmap anchor","searchreplace code link textcolor","media table paste asciimath asciisvg rollups"],menubar:!1,toolbar1:"myEdit myInsert styleselect | bold italic underline subscript superscript | forecolor backcolor | code | saveclose",toolbar2:" alignleft aligncenter alignright | bullist numlist outdent indent  | attach link unlink image | table | asciimath asciimathcharmap asciisvg",
extended_valid_elements:"iframe[src|width|height|name|align|allowfullscreen|frameborder],param[name|value],@[sscr]",content_css:imasroot+(1==c?"/assessment/mathtest.css,":"/imascore.css,")+imasroot+"/themes/"+coursetheme,AScgiloc:imasroot+"/filter/graph/svgimg.php",convert_urls:!1,file_picker_callback:filePickerCallBackFunc,file_browser_types:"file image",images_upload_url:imasroot+"/tinymce4/upload_handler.php",paste_data_images:!0,default_link_target:"_blank",browser_spellcheck:!0,resize:"both",
width:"100%",content_style:"body {background-color: #ffffff !important;}",table_class_list:[{title:"None",value:""},{title:"Gridded",value:"gridded"},{title:"Gridded Centered",value:"gridded centered"}],style_formats_merge:!0,style_formats:[{title:"Font Family",items:[{title:"Arial",inline:"span",styles:{"font-family":"arial"}},{title:"Book Antiqua",inline:"span",styles:{"font-family":"book antiqua"}},{title:"Comic Sans MS",inline:"span",styles:{"font-family":"comic sans ms,sans-serif"}},{title:"Courier New",
inline:"span",styles:{"font-family":"courier new,courier"}},{title:"Georgia",inline:"span",styles:{"font-family":"georgia,palatino"}},{title:"Helvetica",inline:"span",styles:{"font-family":"helvetica"}},{title:"Impact",inline:"span",styles:{"font-family":"impact,chicago"}},{title:"Open Sans",inline:"span",styles:{"font-family":"Open Sans"}},{title:"Symbol",inline:"span",styles:{"font-family":"symbol"}},{title:"Tahoma",inline:"span",styles:{"font-family":"tahoma"}},{title:"Terminal",inline:"span",
styles:{"font-family":"terminal,monaco"}},{title:"Times New Roman",inline:"span",styles:{"font-family":"times new roman,times"}},{title:"Verdana",inline:"span",styles:{"font-family":"Verdana"}}]},{title:"Font Size",items:[{title:"8pt",inline:"span",styles:{fontSize:"12px","font-size":"8px"}},{title:"10pt",inline:"span",styles:{fontSize:"12px","font-size":"10px"}},{title:"12pt",inline:"span",styles:{fontSize:"12px","font-size":"12px"}},{title:"14pt",inline:"span",styles:{fontSize:"12px","font-size":"14px"}},
{title:"16pt",inline:"span",styles:{fontSize:"12px","font-size":"16px"}},{title:"20pt",inline:"span",styles:{fontSize:"12px","font-size":"20px"}}]}]};385>document.documentElement.clientWidth?(a.toolbar1="myEdit myInsert styleselect | bold italic underline",a.toolbar2="bullist numlist outdent indent  | link image | asciimath asciisvg"):465>document.documentElement.clientWidth?(a.toolbar1="myEdit myInsert styleselect | bold italic underline forecolor",a.toolbar2="bullist numlist outdent indent  | link unlink image | asciimath asciisvg"):
575>document.documentElement.clientWidth&&(a.toolbar1="myEdit myInsert styleselect | bold italic underline subscript superscript | forecolor",a.toolbar2=" alignleft aligncenter | bullist numlist outdent indent  | link unlink image | asciimath asciimathcharmap asciisvg");l&&(a.setup=l);for(var m in tinymce.editors)tinymce.editors[m].remove();tinymce.init(a)}
function filePickerCallBack(a,b,c){b=imasroot+"/tinymce4/file_manager.php";switch(c.filetype){case "image":b+="?type=img";break;case "file":b+="?type=files"}tinyMCE.activeEditor.windowManager.open({file:b,title:"File Manager",width:350,height:450,resizable:"yes",inline:"yes",close_previous:"no"},{oninsert:function(b,c){a(b)}})}
function imascleanup(a,b){"get_from_editor"==a&&(b=b.replace(/\x3c!--([\s\S]*?)--\x3e|&lt;!--([\s\S]*?)--&gt;|<style>[\s\S]*?<\/style>/g,""),b=b.replace(/class="?Mso\w+"?/g,""),b=b.replace(/<p\s*>\s*<\/p>/gi,""),b=b.replace(/<script.*?\/script>/gi,""),b=b.replace(/<input[^>]*button[^>]*>/gi,""));return b}
function readCookie(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var g=b[c];" "==g.charAt(0);)g=g.substring(1,g.length);if(0==g.indexOf(a))return unescape(g.substring(a.length,g.length))}return null}
function selectByDivID(a){var b=a.value;a=a.value.split(":")[0];for(var c=document.getElementsByTagName("div"),g=0;g<c.length;g++)c[g].className.match(a)&&(c[g].style.display=c[g].id==b?"block":"none");c=new Date;c.setDate(c.getDate()+365);document.cookie=a+"store="+escape(b)+";expires="+c.toGMTString()}
function setselectbycookie(){for(var a=document.getElementsByTagName("select"),b=0;b<a.length;b++)if(a[b].className.match("alts")){var c=a[b].className.replace(/alts/,"").replace(/\s/g,"");null!=(co=readCookie(c+"store"))&&(co=co.replace("store",""),a[b].value=co,selectByDivID(a[b]))}}addLoadEvent(setselectbycookie);var recordedunload=!1;
function recclick(a,b,c,g){if(0<cid){var l="",h;null!==(h=window.location.href.match(/showlinkedtext.*?&id=(\d+)/))&&0==recordedunload&&(l="&unloadinglinked="+h[1],recordedunload=!0);jQuery.ajax({type:"POST",url:imasroot+"/course/rectrack.php?cid="+cid,data:"type="+encodeURIComponent(a)+"&typeid="+encodeURIComponent(b)+"&info="+encodeURIComponent(c+"::"+g)+l})}}
function setuptracklinks(a,b){jQuery(b).attr("data-base")&&jQuery(b).click(function(a){var g=jQuery(this).attr("data-base").split("-");recclick(g[0],g[1],jQuery(this).attr("href"),jQuery(this).text());if("undefined"==typeof jQuery(b).attr("target"))return a.preventDefault(),setTimeout('window.location.href = "'+jQuery(this).attr("href")+'"',100),!1}).mousedown(function(a){3==a.which&&(a=jQuery(this).attr("data-base").split("-"),recclick(a[0],a[1],jQuery(this).attr("href"),jQuery(this).text()))})}
var videoembedcounter=0;
function togglevideoembed(){var a=this.id.substr(13),b=jQuery("#videoiframe"+a);if(0<b.length)"none"==b.css("display")?(b.show(),b.parent(".fluid-width-video-wrapper").show(),jQuery(this).text(" [-]"),jQuery(this).attr("title",_("Hide video"))):(b.hide(),b.get(0).contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),b.parent(".fluid-width-video-wrapper").hide(),jQuery(this).text(" [+]"),jQuery(this).attr("title",_("Watch video here")));else{var b=jQuery(this).prev().attr("href"),
c="?";if(b.match(/youtube\.com/))if(-1<b.indexOf("playlist?list="))var g=b.split("list=")[1].split(/[#&]/)[0],l="www.youtube.com/embed/videoseries?list=",c="&";else g=b.split("v=")[1].split(/[#&]/)[0],l="www.youtube.com/embed/";else b.match(/youtu\.be/)?(g=b.split(".be/")[1].split(/[#&]/)[0],l="www.youtube.com/embed/"):b.match(/vimeo/)&&(g=b.split(".com/")[1].split(/[#&]/)[0],l="player.vimeo.com/video/");var h=b.match(/.*\Wt=((\d+)m)?((\d+)s)?.*/);null==h?(c+="rel=0",h=b.match(/.*start=(\d+)/),null!=
h&&(c+="&start="+h[1])):c=c+"rel=0&start="+((h[2]?60*h[2]:0)+(h[4]?1*h[4]:0));h=b.match(/.*end=(\d+)/);null!=h&&(c+="&end="+h[1]);jQuery("<iframe/>",{id:"videoiframe"+a,width:640,height:400,src:location.protocol+"//"+l+g+(c+"&enablejsapi=1"),frameborder:0,allowfullscreen:1}).insertAfter(jQuery(this));jQuery(this).parent().fitVids();jQuery("<br/>").insertAfter(jQuery(this));jQuery(this).text(" [-]");jQuery(this).attr("title",_("Hide video"));jQuery(this).prev().attr("data-base")&&(a=jQuery(this).prev().attr("data-base").split("-"),
recclick(a[0],a[1],b,jQuery(this).prev().text()))}}function setupvideoembeds(a,b){jQuery("<span/>",{text:" [+]",title:_("Watch video here"),id:"videoembedbtn"+videoembedcounter,click:togglevideoembed,"class":"videoembedbtn"}).insertAfter(b);videoembedcounter++}function addNoopener(a,b){!b.rel&&b.target&&b.host!==window.location.host&&b.setAttribute("rel","noopener noreferrer")}
function addmultiselect(a,b){var c=jQuery(a).parent(),g=jQuery("#"+b).val(),l=jQuery("#"+b+" option[value="+g+"]").prop("disabled",!0).html();"null"!=g&&c.append('<div class="multiselitem"><span class="right"><a href="#" onclick="removemultiselect(this);return false;">Remove</a></span><input type="hidden" name="'+b+'[]" value="'+g+'"/>'+l+"</div>");jQuery("#"+b).val("null")}
function removemultiselect(a){a=jQuery(a).parent().parent();var b=a.find("input").val();a.parent().find("option[value="+b+"]").prop("disabled",!1);a.remove()}function hidefromcourselist(a,b){confirm("Are you SURE you want to hide this course from your course list?")&&jQuery.ajax({type:"GET",url:imasroot+"/admin/hidefromcourselist.php?cid="+b}).done(function(b){"OK"==b&&(jQuery(a).parent().slideUp(),jQuery("#unhidelink").show())})}
function rotateimg(a){var b=$(a).data("rotation")?($(a).data("rotation")+90)%360:90;$(a).data("rotation",b).css({transform:"rotate("+b+"deg)"});90==b%180?(b=($(a).width()-$(a).height())/2,0<b&&$(a).parent().css({"padding-top":b,"padding-bottom":b})):$(a).parent().css({"padding-top":0,"padding-bottom":0})}
jQuery(document).ready(function(a){a(window).on("message",function(b){if(b.originalEvent.data.match(/lti\.frameResize/))for(var c=JSON.parse(b.originalEvent.data),g=document.getElementsByTagName("iframe"),l=0;l<g.length;l++)if(g[l].contentWindow===b.originalEvent.source){a(g[l]).height(c.height);break}})});
jQuery(document).ready(function(a){a("a").each(setuptracklinks).each(addNoopener);a('a[href*="youtu"]').each(setupvideoembeds);a('a[href*="vimeo"]').each(setupvideoembeds);a("body").fitVids();a('a[target="_blank"]').each(function(){this.href.match(/youtu/)||this.href.match(/vimeo/)||a(this).append(' <img src="'+imasroot+'/img/extlink.png"/>')})});
jQuery.fn.isolatedScroll=function(){this.bind("mousewheel DOMMouseScroll",function(a){var b=a.wheelDelta||a.originalEvent&&a.originalEvent.wheelDelta||-a.detail,c=0<=this.scrollTop+jQuery(this).outerHeight()-this.scrollHeight,g=0>=this.scrollTop;(0>b&&c||0<b&&g)&&a.preventDefault()});return this};
jQuery(document).ready(function(a){for(var b=a(".fixedonscroll"),c=[],g=0;g<b.length;g++)c[g]=a(b[g]).offset().top,a(b[g]).height()>a(window).height()&&(c[g]=-1);0<b.length&&"left"==a(b[0]).css("float")&&a(window).scroll(function(){for(var g=a(window).scrollTop(),h=0;h<b.length;h++)g>c[h]&&0<c[h]?a(b[h]).css("position","fixed").css("top","5px"):a(b[h]).css("position","static")})});
function _(a){var b="undefined"!=typeof i18njs&&i18njs[a]?i18njs[a]:a;if(1<arguments.length)for(var c=1;c<arguments.length;c++)b=b.replace("$"+c,arguments[c]);return b}
(function(a){a.fn.fitVids=function(){return this.each(function(){a(this).find("iframe[src*='player.vimeo.com'],iframe[src*='youtube.com'],iframe[src*='youtube-nocookie.com']").each(function(){var b=a(this);if(0<b.closest(".textsegment").length)return!0;b.parentsUntil(".intro","table").each(function(){a(this).css("width","100%")});var c=b.attr("height")&&!isNaN(parseInt(b.attr("height"),10))?parseInt(b.attr("height"),10):b.height(),g=isNaN(parseInt(b.attr("width"),10))?b.width():parseInt(b.attr("width"),
10),c=c/g;b.attr("id")||b.attr("id","fitvid"+Math.floor(999999*Math.random()));b.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*c+"%").wrap('<div class="video-wrapper-wrapper"></div>').parent(".video-wrapper-wrapper").css("max-width",g+"px");b.removeAttr("height").removeAttr("width").css("height","").css("width","")})})}})(window.jQuery||window.Zepto);
function setAltSelectors(a,b){console.log("looking for "+a);$(".alts."+a).parents(".altWrap").find(".altContentOn").removeClass("altContentOn").addClass("altContentOff");$(".alts."+a).parents(".altWrap").find("."+b).addClass("altContentOn").removeClass("altContentOff");$("select.alts."+a).val(a+":"+b);var c=new Date;c.setDate(c.getDate()+365);document.cookie="alt_store_"+a+"="+escape(b)+";expires="+c.toGMTString()+";path=/"}
jQuery(document).ready(function(a){a(".alts").on("change",function(){var a=this.value.split(":");1<a.length&&setAltSelectors(a[0],a[1])}).each(function(b,c){var g=c.value.split(":");null!=(co=readCookie("alt_store_"+g[0]))?setAltSelectors(g[0],co):a(c).hasClass("setDefault")&&setAltSelectors(g[0],g[1])});a(document).on("keydown",function(b){8!==b.which||a(b.target).is("input[type='text']:not([readonly]),input:not([type]):not([readonly]),input[type='password']:not([readonly]), textarea, [contenteditable='true']")||
b.preventDefault()})});
+function(a){function b(b){var c=b.attr("data-target");c||(c=(c=b.attr("href"))&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));return(c=c&&a(c))&&c.length?c:b.parent()}function c(c){c&&3===c.which||(a(".dropdown-backdrop").remove(),a('[data-toggle="dropdown"]').each(function(){var g=a(this),l=b(g),t={relatedTarget:this};!l.hasClass("open")||c&&"click"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(l[0],c.target)||(l.trigger(c=a.Event("hide.bs.dropdown",t)),c.isDefaultPrevented()||
(g.attr("aria-expanded","false"),l.removeClass("open").trigger("hidden.bs.dropdown",t)))}))}var g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.5";g.prototype.toggle=function(g){var l=a(this);if(!l.is(".disabled, :disabled")){var q=b(l);g=q.hasClass("open");c();if(!g){if("ontouchstart"in document.documentElement&&!q.closest(".navbar-nav").length)a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",c);var t={relatedTarget:this};q.trigger(g=
a.Event("show.bs.dropdown",t));if(g.isDefaultPrevented())return;l.trigger("focus").attr("aria-expanded","true");q.toggleClass("open").trigger("shown.bs.dropdown",t)}return!1}};g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var g=a(this);c.preventDefault();c.stopPropagation();if(!g.is(".disabled, :disabled")){var l=b(g),t=l.hasClass("open");if(!t&&27!=c.which||t&&27==c.which)return 27==c.which&&l.find('[data-toggle="dropdown"]').trigger("focus"),
g.trigger("click");g=l.find(".dropdown-menu li:not(.disabled):visible a");g.length&&(l=g.index(c.target),38==c.which&&0<l&&l--,40==c.which&&l<g.length-1&&l++,~l||(l=0),g.eq(l).trigger("focus"))}}};var l=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),l=c.data("bs.dropdown");l||c.data("bs.dropdown",l=new g(this));"string"==typeof b&&l[b].call(c)})};a.fn.dropdown.Constructor=g;a.fn.dropdown.noConflict=function(){a.fn.dropdown=l;return this};a(document).on("click.bs.dropdown.data-api",
c).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",'[data-toggle="dropdown"]',g.prototype.toggle).on("keydown.bs.dropdown.data-api",'[data-toggle="dropdown"]',g.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",g.prototype.keydown)}(jQuery);
var pi=Math.PI,ln=Math.log,e=Math.E,arcsin=Math.asin,arccos=Math.acos,arctan=Math.atan,sec=function(a){return 1/Math.cos(a)},csc=function(a){return 1/Math.sin(a)},cot=function(a){return 1/Math.tan(a)},arcsec=function(a){return arccos(1/a)},arccsc=function(a){return arcsin(1/a)},arccot=function(a){return arctan(1/a)},sinh=function(a){return(Math.exp(a)-Math.exp(-a))/2},cosh=function(a){return(Math.exp(a)+Math.exp(-a))/2},tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))},
sech=function(a){return 1/cosh(a)},csch=function(a){return 1/sinh(a)},coth=function(a){return 1/tanh(a)},arcsinh=function(a){return ln(a+Math.sqrt(a*a+1))},arccosh=function(a){return ln(a+Math.sqrt(a*a-1))},arctanh=function(a){return ln((1+a)/(1-a))/2},sech=function(a){return 1/cosh(a)},csch=function(a){return 1/sinh(a)},coth=function(a){return 1/tanh(a)},arcsech=function(a){return arccosh(1/a)},arccsch=function(a){return arcsinh(1/a)},arccoth=function(a){return arctanh(1/a)},sign=function(a){return 0==
a?0:0>a?-1:1},logten=function(a){return Math.LOG10E*Math.log(a)},sinn=function(a,b){return Math.pow(Math.sin(b),a)},cosn=function(a,b){return Math.pow(Math.cos(b),a)},tann=function(a,b){return Math.pow(Math.tan(b),a)},cscn=function(a,b){return 1/Math.pow(Math.sin(b),a)},secn=function(a,b){return 1/Math.pow(Math.cos(b),a)},cotn=function(a,b){return 1/Math.pow(Math.tan(b),a)};function factorial(a,b){null==b&&(b=1);for(var c=a-b;0<c;c-=b)a*=c;return 0>a?NaN:0==a?1:a}
function C(a,b){for(var c=1,g=0;g<b;g++)c*=(a-g)/(b-g);return c}function matchtolower(a){return a.toLowerCase()}function nthroot(a,b){return safepow(b,1/a)}function nthlogten(a,b){return Math.log(b)/Math.log(a)}var funcstoindexarr="sinh cosh tanh sech csch coth sqrt ln log sin cos tan sec csc cot abs root arcsin arccos arctan arcsec arccsc arccot arcsinh arccosh arctanh arcsech arccsch arccoth".split(" ");
function functoindex(a){for(var b=0;b<funcstoindexarr.length;b++)if(funcstoindexarr[b]==a)return"@"+b+"@"}function indextofunc(a,b){return funcstoindexarr[b]}function safepow(a,b){if(0>a&&Math.floor(b)!=b){for(var c=3;50>c;c+=2)if(1E-6>Math.abs(Math.round(c*b)-c*b))return 0==Math.round(c*b)%2?Math.pow(Math.abs(a),b):-1*Math.pow(Math.abs(a),b);return Math.sqrt(-1)}return Math.pow(a,b)}
function mathjs(a,b){a=a.replace("[","(");a=a.replace("]",")");a=a.replace(/root\s*(\d+)/,"root($1)");a=a.replace(/arc(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)/gi,"$1^-1");a=a.replace(/(Sin|Cos|Tan|Sec|Csc|Cot|Arc|Abs|Log|Ln|Sqrt)/gi,matchtolower);if(null!=b){var c=b.split("|");a=a.replace(/(sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)/g,functoindex);var g=RegExp("(sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)[(]","g");a=a.replace(g,"$1#(");g=new RegExp("("+
b+")("+b+")$","g");a=a.replace(g,"($1)($2)");g=new RegExp("("+b+")(a#|sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)","g");a=a.replace(g,"($1)$2");g=new RegExp("("+b+")("+b+")([^a-df-zA-Z#])","g");a=a.replace(g,"($1)($2)$3");g=new RegExp("([^a-df-zA-Z#])("+b+")([^a-df-zA-Z#])","g");a=a.replace(g,"$1($2)$3");g=new RegExp("([^a-df-zA-Z#(])("+b+")([^a-df-zA-Z#)])","g");a=a.replace(g,"$1($2)$3");g=new RegExp("^("+b+")([^a-df-zA-Z])","g");a=a.replace(g,"($1)$2");g=new RegExp("([^a-df-zA-Z])("+b+")$","g");
a=a.replace(g,"$1($2)");a=a.replace(new RegExp("(("+b+"))","g"),function(a){for(var b=0;b<c.length;b++)if(c[b]==a)return"(@v"+b+"@)"});a=a.replace(/@(\d+)@/g,indextofunc)}a=a.replace(/([0-9])\s+([0-9])/g,"$1*$2");a=a.replace(/#/g,"");a=a.replace(/\s/g,"");a=a.replace(/log_([a-zA-Z\d\.]+)\(/g,"nthlog($1,");a=a.replace(/log_\(([a-zA-Z\/\d\.]+)\)\(/g,"nthlog($1,");a=a.replace(/log/g,"logten");-1!=a.indexOf("^-1")&&(a=a.replace(/sin\^-1/g,"arcsin"),a=a.replace(/cos\^-1/g,"arccos"),a=a.replace(/tan\^-1/g,
"arctan"),a=a.replace(/sec\^-1/g,"arcsec"),a=a.replace(/csc\^-1/g,"arccsc"),a=a.replace(/cot\^-1/g,"arccot"),a=a.replace(/sinh\^-1/g,"arcsinh"),a=a.replace(/cosh\^-1/g,"arccosh"),a=a.replace(/tanh\^-1/g,"arctanh"),a=a.replace(/sech\^-1/g,"arcsech"),a=a.replace(/csch\^-1/g,"arccsch"),a=a.replace(/coth\^-1/g,"arccoth"));a=a.replace(/(sin|cos|tan|sec|csc|cot)\^(\d+)\(/g,"$1n($2,");a=a.replace(/root\((\d+)\)\(/g,"nthroot($1,");a=a.replace(/([0-9])E([\-0-9])/g,"$1(EE)$2");a=a.replace(/^e$/g,"(E)");a=a.replace(/pi/g,
"(pi)");a=a.replace(/@v(\d+)@/g,function(a,b){return c[b]});a=a.replace(/^e([^a-zA-Z])/g,"(E)$1");a=a.replace(/([^a-zA-Z])e$/g,"$1(E)");a=a.replace(/([^a-zA-Z])e(?=[^a-zA-Z])/g,"$1(E)");a=a.replace(/([0-9])([\(a-zA-Z])/g,"$1*$2");a=a.replace(/(!)([0-9\(])/g,"$1*$2");a=a.replace(/([0-9])\*\(EE\)([\-0-9])/,"$1e$2");a=a.replace(/\)([\(0-9a-zA-Z]|\.\d+)/g,")*$1");for(var l,h,m,q;-1!=(g=a.indexOf("^"));){if(0==g)return"Error: missing argument";l=g-1;m=a.charAt(l);if("0"<=m&&"9">=m){for(l--;0<=l&&"0"<=
(m=a.charAt(l))&&"9">=m;)l--;if("."==m)for(l--;0<=l&&"0"<=(m=a.charAt(l))&&"9">=m;)l--}else if(")"==m){q=1;for(l--;0<=l&&0<q;)m=a.charAt(l),"("==m?q--:")"==m&&q++,l--;for(;0<=l&&("a"<=(m=a.charAt(l))&&"z">=m||"A"<=m&&"Z">=m);)l--}else if("a"<=m&&"z">=m||"A"<=m&&"Z">=m)for(l--;0<=l&&("a"<=(m=a.charAt(l))&&"z">=m||"A"<=m&&"Z">=m);)l--;else return"Error: incorrect syntax in "+a+" at position "+l;if(g==a.length-1)return"Error: missing argument";h=g+1;m=a.charAt(h);nch=a.charAt(h+1);if("0"<=m&&"9">=m||
"-"==m&&"("!=nch||"."==m){for(h++;h<a.length&&"0"<=(m=a.charAt(h))&&"9">=m;)h++;if("."==m)for(h++;h<a.length&&"0"<=(m=a.charAt(h))&&"9">=m;)h++}else if("("==m||"-"==m&&"("==nch)for("-"==m&&h++,q=1,h++;h<a.length&&0<q;)m=a.charAt(h),"("==m?q++:")"==m&&q--,h++;else if("a"<=m&&"z">=m||"A"<=m&&"Z">=m){for(h++;h<a.length&&("a"<=(m=a.charAt(h))&&"z">=m||"A"<=m&&"Z">=m);)h++;if("("==m&&a.slice(g+1,h).match(/^(sin|cos|tan|sec|csc|cot|logten|log|ln|exp|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|sqrt|abs|nthroot)$/))for(q=
1,h++;h<a.length&&0<q;)m=a.charAt(h),"("==m?q++:")"==m&&q--,h++}else return"Error: incorrect syntax in "+a+" at position "+h;a=a.slice(0,l+1)+"safepow("+a.slice(l+1,g)+","+a.slice(g+1,h)+")"+a.slice(h)}for(;-1!=(g=a.indexOf("!"));){if(0==g)return"Error: missing argument";l=g-1;m=a.charAt(l);if("0"<=m&&"9">=m){for(l--;0<=l&&"0"<=(m=a.charAt(l))&&"9">=m;)l--;if("."==m)for(l--;0<=l&&"0"<=(m=a.charAt(l))&&"9">=m;)l--}else if(")"==m){q=1;for(l--;0<=l&&0<q;)m=a.charAt(l),"("==m?q--:")"==m&&q++,l--;for(;0<=
l&&("a"<=(m=a.charAt(l))&&"z">=m||"A"<=m&&"Z">=m);)l--}else if("a"<=m&&"z">=m||"A"<=m&&"Z">=m)for(l--;0<=l&&("a"<=(m=a.charAt(l))&&"z">=m||"A"<=m&&"Z">=m);)l--;else return"Error: incorrect syntax in "+a+" at position "+l;a=a.slice(0,l+1)+"factorial("+a.slice(l+1,g)+")"+a.slice(g+1)}return a}var updateeeddpos=function(){},updateehpos=function(){},LivePreviews=[];
function setupLivePreview(a){LivePreviews.hasOwnProperty(a)||("MathJax"==mathRenderer||"Katex"==mathRenderer?(LivePreviews[a]={delay:"MathJax"==mathRenderer?100:20,finaldelay:1E3,preview:null,buffer:null,timeout:null,finaltimeout:null,mjRunning:!1,mjPending:!1,oldText:null,Init:function(){$("#p"+a).css("positive","relative").append('<span id="lpbuf1'+a+'" style="visibility:hidden;position:absolute;"></span>').append('<span id="lpbuf2'+a+'" style="visibility:hidden;position:absolute;"></span>');this.preview=
document.getElementById("lpbuf1"+a);this.buffer=document.getElementById("lpbuf2"+a)},SwapBuffers:function(){var a=this.preview,c=this.buffer;this.buffer=a;this.preview=c;a.style.visibility="hidden";a.style.position="absolute";c.style.position="";c.style.visibility=""},Update:function(a){this.timeout&&clearTimeout(this.timeout);this.finaltimeout&&clearTimeout(this.finaltimeout);this.timeout=setTimeout(this.callback,this.delay);this.finaltimeout=setTimeout(this.DoFinalPreview,this.finaldelay)},RenderNow:function(a){this.buffer.innerHTML=
this.oldtext=a;this.mjRunning=!0;this.RenderBuffer()},RenderBuffer:function(){"MathJax"==mathRenderer?MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.buffer],["PreviewDone",this]):"Katex"==mathRenderer&&(renderMathInElement(this.buffer),0<$(this.buffer).children(".mj").length?MathJax.Hub.Queue(["PreviewDone",this]):this.PreviewDone())},DoFinalPreview:function(){$("#pbtn"+a).trigger("click")},preformat:function(b){if(intcalctoproc.hasOwnProperty(a))calcformat[a].match(/inequality/)?(b=b.replace("<=",
"le").replace(">=","ge").replace("<","lt").replace(">","gt"),b.match(/all\s*real/i)&&(b="text("+b+")")):b=b.replace(/U/g,"uu");else if(vlist.hasOwnProperty(a))b=AMnumfuncPrepVar(a,b)[1];else if(calcformat.hasOwnProperty(a)){var c=calcformat[a];-1==c.indexOf("list")&&-1==c.indexOf("set")&&(b=b.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1"))}return b},CreatePreview:function(){this.timeout=null;if(!this.mjPending){var b=null==document.getElementById("tc"+a)?document.getElementById("qn"+a).value:document.getElementById("tc"+
a).value;b!==this.oldtext&&(this.mjRunning?(this.mjPending=!0,MathJax.Hub.Queue(["CreatePreview",this])):(this.oldtext=b,this.buffer.innerHTML="`"+this.preformat(b)+"`",this.mjRunning=!0,this.RenderBuffer()))}},PreviewDone:function(){this.mjRunning=this.mjPending=!1;this.SwapBuffers();updateeeddpos();updateehpos()}},LivePreviews[a].callback=MathJax.Callback(["CreatePreview",LivePreviews[a]]),LivePreviews[a].callback.autoReset=!0,LivePreviews[a].Init()):LivePreviews[a]={finaldelay:1E3,finaltimeout:null,
Update:function(a){this.finaltimeout&&clearTimeout(this.finaltimeout);this.finaltimeout=setTimeout(this.DoFinalPreview,this.finaldelay)},RenderNow:function(b){var c=document.getElementById("p"+a);c.innerHTML=b;rendermathnode(c)},DoFinalPreview:function(){$("#pbtn"+a).trigger("click")}})}function updateLivePreview(a){a=a.id.substr(2);setupLivePreview(a);LivePreviews[a].Update()}
function normalizemathunicode(a){a=a.replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F]/g,"");a=a.replace(/\u2013|\u2014|\u2015|\u2212/g,"-");a=a.replace(/\u2044|\u2215/g,"/");a=a.replace(/\u221e/g,"oo").replace(/\u2264/g,"<=").replace(/\u2265/g,">=").replace(/\u222a/g,"U");a=a.replace(/\u00b1/g,"+-").replace(/\u00f7/g,"/").replace(/\u00b7|\u2715|\u00d7|\u22c5/g,"*");a=a.replace(/\u221a/g,"sqrt").replace(/\u221b/g,"root(3)");a=a.replace(/\u00b2/g,"^2").replace(/\u00b3/g,"^3");a=a.replace(/\bOO\b/i,"oo");a=
a.replace(/\u03b8/,"theta").replace(/\u03c6/,"phi").replace(/\u03c0/,"pi").replace(/\u03c3/,"sigma").replace(/\u03bc/,"mu");a=a.replace(/\u03b1/,"alpha").replace(/\u03b2/,"beta").replace(/\u03b3/,"gamma").replace(/\u03b4/,"delta").replace(/\u03b5/,"epsilon").replace(/\u03ba/,"kappa");a=a.replace(/\u03bb/,"lambda").replace(/\u03c1/,"rho").replace(/\u03c4/,"tau").replace(/\u03c7/,"chi").replace(/\u03c9/,"omega");return a=a.replace(/\u03a9/,"Omega").replace(/\u0393/,"Gamma").replace(/\u03a6/,"Phi").replace(/\u0394/,
"Delta").replace(/\u03a3/,"Sigma")}function wrapAMnotice(a){return'<span class="AMHnotice">'+a+"</span>"}
function calculate(a,b,c){var g=document.getElementById(a).value,g=normalizemathunicode(g),g=g.replace(/=/,"");if(-1!=c.indexOf("list"))var l=g.split(/,/);else-1!=c.indexOf("set")?l=g.replace(/[\{\}]/g,"").split(/,/):(l=[],l[0]=g);for(g=0;g<l.length;g++){str=l[g];str=str.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");var h="";if(str.match(/DNE/i))str=str.toUpperCase();else if(str.match(/oo$/)||str.match(/oo\W/))str="`"+str+"`";else{h+=singlevalsyntaxcheck(str,c);str.match(/,/)&&(h+=_("Invalid use of a comma."));
-1!=c.indexOf("allowxtimes")&&(str=str.replace(/(x|X|\u00D7)/,"*"));-1!=c.indexOf("mixed")?str=str.replace(/_/," "):-1!=c.indexOf("scinot")?str=str.replace(/(x|X|\u00D7)/,"xx"):(str=str.replace(/([0-9])\s+([0-9])/g,"$1*$2"),str=str.replace(/\s/g,""));h+=syntaxcheckexpr(str,c);try{var m=str,m=m.replace(",","*NaN*");m.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(m=m.replace(/%/,"")+"/100");-1!=c.indexOf("mixed")&&(m=m.replace(/(\d+)\s+(\d+\s*\/\s*\d+)/,"($1+$2)"));-1!=c.indexOf("scinot")&&
(m=m.replace("xx","*"));with(Math)var q=eval(mathjs(m))}catch(t){h=_("syntax incomplete")+". "+h,q=NaN}isNaN(q)||"Infinity"==q?""!=str&&(str="`"+str+"` = "+_("undefined")+". "+wrapAMnotice(h)):str=-1!=c.indexOf("fraction")||-1!=c.indexOf("reducedfraction")||-1!=c.indexOf("mixednumber")||-1!=c.indexOf("scinot")||-1!=c.indexOf("noval")?"`"+str+"` "+wrapAMnotice(h):"`"+str+" =` "+(1E-15>Math.abs(q)?0:q)+". "+wrapAMnotice(h)}l[g]=str+" "}g=l.join(", ");-1!=c.indexOf("set")&&(g=document.getElementById(a).value.match(/^\s*{.*?}\s*$/)?
"{"+g+"}":g+wrapAMnotice(_("syntax error: this answer must be in set notation, a list wrapped in braces like {1,2,3}")));a=b.substr(1);setupLivePreview(a);LivePreviews[a].RenderNow(g)}
function ineqtointerval(a){a=a.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");a=a.split(/or/);for(i=0;i<a.length;i++){str=a[i];var b="";(pat=str.match(/^([^<]+)\s*(<=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*(<=?)([^<]+)$/))?(b="<="==pat[2]?b+"[":b+"(",b+=pat[1]+","+pat[5],b="<="==pat[4]?b+"]":b+")"):(pat=str.match(/^([^>]+)\s*(>=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*(>=?)([^>]+)$/))?(b=">="==pat[4]?b+"[":b+"(",b+=pat[5]+","+pat[1],b=">="==pat[2]?b+"]":b+")"):(pat=str.match(/^([^><]+)\s*([><]=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*$/))?
">"==pat[2]?b="(-oo,"+pat[1]+")":">="==pat[2]?b="(-oo,"+pat[1]+"]":"<"==pat[2]?b="("+pat[1]+",oo)":"<="==pat[2]&&(b="["+pat[1]+",oo)"):(pat=str.match(/^\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*([><]=?)\s*([^><]+)$/))?"<"==pat[2]?b="(-oo,"+pat[3]+")":"<="==pat[2]?b="(-oo,"+pat[3]+"]":">"==pat[2]?b="("+pat[3]+",oo)":">="==pat[2]&&(b="["+pat[3]+",oo)"):b=str.match(/all\s*real/i)?"(-oo,oo)":"";a[i]=b}return b=a.join("U")}
function intcalculate(a,b,c){a=document.getElementById(a).value;a=normalizemathunicode(a);if(a.match(/DNE/i))a=a.toUpperCase();else if(""==a.replace(/\s+/g,""))a=_("no answer given");else{var g=[],l=[];if(-1!=c.indexOf("inequality")){var h=a=a.replace(/or/g," or ");a=ineqtointerval(a);var m=str.match(/\b([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+\b)/),q=str.match(/([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)/),m=null!=m?m[1]:null!=q?q[1]:""}else h=a,a=a.replace(/\s+/g,"");if(-1!=c.indexOf("list")){for(var t=
0,q=[],A=1;A<a.length-1;A++)","!=a.charAt(A)||")"!=a.charAt(A-1)&&"]"!=a.charAt(A-1)||"("!=a.charAt(A+1)&&"["!=a.charAt(A+1)||(q.push(a.substring(t,A)),t=A+1);q.push(a.substring(t))}else q=a.split(/U/i);t=!0;A="";for(i=0;i<q.length;i++){str=q[i];sm=str.charAt(0);em=str.charAt(str.length-1);vals=str.substring(1,str.length-1);vals=vals.split(/,/);if(2!=vals.length||"("!=sm&&"["!=sm||")"!=em&&"]"!=em){-1!=c.indexOf("inequality")?(h=h.replace("<=","le").replace(">=","ge").replace("<","lt").replace(">",
"gt"),a="`"+h+"`: "+wrapAMnotice(_("invalid inequality notation"))):a="`"+h.replace(/U/g,"uu")+"`: "+wrapAMnotice(_("invalid interval notation"));t=!1;break}for(j=0;2>j;j++)if(vals[j].match(/oo$/)||vals[j].match(/oo\W/))g[j]=vals[j];else{var E="",I=NaN,E=E+singlevalsyntaxcheck(vals[j],c);-1!=c.indexOf("mixed")?vals[j]=vals[j].replace(/_/," "):vals[j]=vals[j].replace(/\s/g,"");E+=syntaxcheckexpr(vals[j],c);if(""==E)try{with(Math)var I=eval(mathjs(vals[j]))}catch(aa){E=_("syntax incomplete")+". "}isNaN(I)||
"Infinity"==I?g[j]=_("undefined"):(vals[j]=vals[j],g[j]=(1E-15>Math.abs(I)?0:I).toString());""!=E&&(A+=E)}q[i]=sm+vals[0]+","+vals[1]+em;-1!=c.indexOf("inequality")?(g[0].match(/oo/)?g[1].match(/oo/)?l[i]="RR":l[i]=m+("]"==em?"le":"lt")+g[1]:g[1].match(/oo/)?l[i]=m+("["==sm?"ge":"gt")+g[0]:l[i]=g[0]+("["==sm?"le":"lt")+m+("]"==em?"le":"lt")+g[1],l[i]=l[i].replace("undefined",'"undefined"')):l[i]=sm+g[0]+","+g[1]+em}t&&(-1!=c.indexOf("inequality")?h.match(/all\s*real/)?a=h:(h=h.replace(/or/g,' \\ "or" \\ '),
h=h.replace(/<=/g,"le"),h=h.replace(/>=/g,"ge"),h=h.replace(/</g,"lt"),h=h.replace(/>/g,"gt"),a=-1!=c.indexOf("fraction")||-1!=c.indexOf("reducedfraction")||-1!=c.indexOf("mixednumber")||-1!=c.indexOf("scinot")||-1!=c.indexOf("noval")?"`"+h+"`. "+wrapAMnotice(A):"`"+h+"= "+l.join(' \\ "or" \\ ')+"`. "+wrapAMnotice(A)):a=-1!=c.indexOf("fraction")||-1!=c.indexOf("reducedfraction")||-1!=c.indexOf("mixednumber")||-1!=c.indexOf("scinot")||-1!=c.indexOf("noval")?"`"+q.join("uu")+"`. "+wrapAMnotice(A):-1!=
c.indexOf("list")?"`"+q.join(",")+"` = "+l.join(" , ")+". "+wrapAMnotice(A):"`"+q.join("uu")+"` = "+l.join(" U ")+". "+wrapAMnotice(A))}b=b.substr(1);setupLivePreview(b);LivePreviews[b].RenderNow(a)}
function ntuplecalc(a,b,c){var g=document.getElementById(a).value,g=normalizemathunicode(g),g=g.replace(/\s+/g,"");if(g.match(/DNE/i))g.toUpperCase(),outstr=a="DNE";else{a="";var l=0,h=0,m="",q=!0;g.charAt(0).match(/[\(\[\<\{]/)||(q=!1);for(var t=0;t<g.length;t++)if(dec=!1,0==l&&(a+=g.charAt(t),h=t+1,","==g.charAt(t)&&(g.charAt(t+1).match(/[\(\[\<\{]/)&&g.charAt(t-1).match(/[\)\]\>\}]/)||(q=!1))),g.charAt(t).match(/[\(\[\<\{]/)?l++:g.charAt(t).match(/[\)\]\>\}]/)&&(l--,dec=!0),0==l&&dec||1==l&&","==
g.charAt(t)){sub=g.substring(h,t);h=NaN;try{with(Math)h=eval(mathjs(sub))}catch(A){m+=_("syntax incomplete")+". "}m+=singlevalsyntaxcheck(sub,c);sub=-1!=c.indexOf("mixed")?sub.replace(/_/," "):sub.replace(/\s/g,"");m+=syntaxcheckexpr(sub,c);a=isNaN(h)||"Infinity"==h?a+_("undefined"):a+h;a+=g.charAt(t);h=t+1}0!=l&&(q=!1);0==q&&(m+=_("Invalid notation")+". ");outstr=-1!=c.indexOf("fraction")||-1!=c.indexOf("reducedfraction")||-1!=c.indexOf("mixednumber")||-1!=c.indexOf("scinot")||-1!=c.indexOf("noval")||
0==q?"`"+g+"`. "+wrapAMnotice(m):"`"+g+"` = "+a+". "+wrapAMnotice(m)}null!=b&&(b=b.substr(1),setupLivePreview(b),LivePreviews[b].RenderNow(outstr));return a}
function complexcalc(a,b,c){var g=document.getElementById(a).value,g=normalizemathunicode(g),g=g.replace(/\s+/g,"");if(g.match(/DNE/i))g.toUpperCase(),outstr=a="DNE";else{for(var l=a="",h=g.split(","),m=0;m<h.length;m++){var q=mathjs(h[m],"i");if(-1==c.indexOf("sloppycomplex"))var t=parsecomplex(h[m]),l=l+singlevalsyntaxcheck(t[0],c),l=l+singlevalsyntaxcheck(t[1],c);l+=syntaxcheckexpr(h[m],c);try{with(Math)var A=scopedeval("var i=0;"+q);with(Math)var E=scopedeval("var i=1;"+q)}catch(I){l+=_("syntax incomplete")}if("synerr"==
A||"synerr"==E)l+=_("syntax incomplete"),A=NaN;if(isNaN(A)||"Infinity"==A||isNaN(E)||"Infinity"==E){a+=_("undefined");break}else E-=A,0!=m&&(a+=","),a+=A+(0<=E?"+":"")+E+"i"}outstr=-1!=c.indexOf("fraction")||-1!=c.indexOf("reducedfraction")||-1!=c.indexOf("mixednumber")||-1!=c.indexOf("scinot")||-1!=c.indexOf("noval")?"`"+g+"`. "+wrapAMnotice(l):"`"+g+"` = "+a+". "+wrapAMnotice(l)}null!=b&&(b=b.substr(1),setupLivePreview(b),LivePreviews[b].RenderNow(outstr));return a}
function parsecomplex(a){var b,c,g,l,h;a=a.replace(/\s/,"");a=a.replace(/sin/,"s$n");a=a.replace(/pi/,"p$");var m=a.length;if(2<a.split("i").length)return _("error - more than 1 i in expression");g=a.indexOf("i");if(-1==g)b="0";else{c=0;for(h=g-1;0<h;h--)if(b=a.charAt(h),")"==b)c++;else if("("==b)c--;else if(("+"==b||"-"==b)&&0==c)break;c=0;for(l=g+1;l<m;l++)if(b=a.charAt(l),"("==b)c++;else if(")"==b)c--;else if(("+"==b||"-"==b)&&0==c)break;if(1<g-h&&1<l-g)return _("error - invalid form");if(1<g-
h)b=a.substr(h,g-h),a=a.substr(0,h)+a.substr(g+1);else if(1<l-g)if(0<g){if("+"!=a.charAt(g-1)&&"-"!=a.charAt(g-1))return _("error - invalid form");b=a.charAt(g-1)+a.substr(g+1+("*"==a.charAt(g+1)?1:0),l-g-1);a=a.substr(0,g-1)+a.substr(l)}else b=a.substr(g+1,l-g-1),a=a.substr(0,g)+a.substr(l);else b="+"==a.charAt(h)?"1":"-"==a.charAt(h)?"-1":0==g?"1":a.charAt(h),a=(0<g?a.substr(0,h):"")+a.substr(g+1);""==a&&(a="0");"/"==b.charAt(0)?b="1"+b:"+"!=b.charAt(0)&&"-"!=b.charAt(0)||"/"!=b.charAt(1)||(b=b.charAt(0)+
"1"+b.substr(1));"*"==b.charAt(b.length-1)&&(b=b.substr(0,b.length-1));"+"==b.charAt(0)&&(b=b.substr(1));"+"==a.charAt(0)&&(a=a.substr(1))}a=a.replace("s$n","sin");a=a.replace("p$","pi");b=b.replace("s$n","sin");b=b.replace("p$","pi");return[a,b]}
function matrixcalc(a,b,c,g){function l(a){var b="";try{with(Math)var c=eval(mathjs(a))}catch(g){b=_("syntax incomplete")}isNaN(c)||"Infinity"==c?""!=a&&(a=_("undefined")):a=(1E-15>Math.abs(c)?0:c)+b;return a}if(null!=c&&null!=g){for(var h=0,m="[",q="[",t=0;t<c;t++){0<t&&(m+=",",q+=",");for(var m=m+"(",q=q+"(",A=0;A<g;A++)0<A&&(m+=",",q+=","),val=normalizemathunicode(document.getElementById(a+"-"+h).value),m+=val,q+=l(val),h++;m+=")";q+=")"}m+="]";q+="]"}else{m=normalizemathunicode(document.getElementById(a).value);
g=0;q=m.replace("[","(");q=q.replace("]",")");q=q.replace(/\s+/g,"");c=[];q=q.substring(1,q.length-1);for(a=h=0;a<q.length;a++)"("==q.charAt(a)?g++:")"==q.charAt(a)?g--:","==q.charAt(a)&&0==g&&(c[c.length]=q.substring(h+1,a-1),h=a+1);c[c.length]=q.substring(h+1,q.length-1);for(a=0;a<c.length;a++){calclist2=c[a].split(",");for(q=0;q<calclist2.length;q++)calclist2[q]=l(calclist2[q]);c[a]=calclist2.join(",")}q="[("+c.join("),(")+")]"}m="`"+m+"` = `"+q+"`";if(null!=b){b=document.getElementById(b);c=b.childNodes.length;
for(a=0;a<c;a++)b.removeChild(b.firstChild);b.appendChild(document.createTextNode(m));noMathRender||rendermathnode(b)}return q}function mathjsformat(a,b){var c=document.getElementById(a).value;document.getElementById(b).value=mathjs(c)}function stringqpreview(a,b){var c=document.getElementById(a).value,g=b.substr(1);setupLivePreview(g);LivePreviews[g].RenderNow("`"+c+"`")}
function AMnumfuncPrepVar(a,b){var c=vlist[a].split("|");b=b.replace(/,/g,"");b=normalizemathunicode(b);var g=[],l;l=b.replace(/(arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)/g,functoindex);for(var h=0;h<c.length;h++)if("varE"==c[h])b=b.replace("E","varE"),l=l.replace("E","varE");else{g[h]=!1;for(var m=0;m<c.length;m++)if(h!=m&&c[m].toLowerCase()==c[h].toLowerCase()&&c[m]!=c[h]){g[h]=
!0;break}g[h]||(b=b.replace(new RegExp(c[h],"gi"),c[h]),l=l.replace(new RegExp(c[h],"gi"),c[h]))}for(var m=[],q,h=0;h<c.length;h++)if(1<c[h].length)if(q=!1,-1!=arraysearch(c[h].toLowerCase(),greekletters)&&(q=!0),c[h].match(/^\w+_\w+$/)){q=g[h]?"g":"gi";var t=(new RegExp(/^(\w+)_(\w+)$/,q)).exec(c[h]),A=new RegExp(t[1]+"_\\("+t[2]+"\\)",q);l=l.replace(A,c[h]);b=b.replace(A,c[h]);1<t[1].length&&-1==arraysearch(t[1].toLowerCase(),greekletters)&&(t[1]='"'+t[1]+'"');1<t[2].length&&-1==arraysearch(t[2].toLowerCase(),
greekletters)&&(t[2]='"'+t[2]+'"');l=l.replace(new RegExp(t[0],q),t[1]+"_"+t[2]);b=b.replace(new RegExp(t[0],"g"),"repvars"+h);c[h]="repvars"+h}else q||"varE"==c[h]||m.push(c[h]);0<m.length&&(vltq=m.join("|"),l=l.replace(new RegExp("("+vltq+")","g"),'"$1"'));l=l.replace("varE","E");l=l.replace(/@(\d+)@/g,indextofunc);return[b,l,c.join("|")]}
function AMpreview(a,b){var c=a.slice(2),g=AMnumfuncPrepVar(c,document.getElementById(a).value),l=g[0],h=g[1],m=g[2],q=flist[c];ptlist=pts[c].split(",");var t="",A=0,g=NaN,E=!1;1==iseqn[c]?(l.match(/=/)?1<l.match(/=/g).length&&(E=!0):E=!0,l=l.replace(/(.*)=(.*)/,"$1-($2)")):l.match(/=/)||(E=!0);""!=q&&(reg=new RegExp("("+q+")\\(","g"),l=l.replace(reg,"$1*sin($1+"));vars=m.split("|");for(q=mathjs(l,m);A<ptlist.length&&(isNaN(g)||"Infinity"==g);){var I="";testvals=ptlist[A].split("~");for(t=0;t<vars.length;t++)I+=
"var "+vars[t]+"="+testvals[t]+";";I+=q;t=_("syntax ok");try{with(Math)g=scopedeval(I)}catch(aa){t=_("syntax error")}"synerr"==g&&(t=_("syntax error"));A++}l=syntaxcheckexpr(l,"",m);if(isNaN(g)||"Infinity"==g)t=_("syntax error");""!=l&&(t=t==_("syntax ok")?t+(". "+_("warning")+": "+l):t+(". "+l));1==iseqn[c]&&E?t=_("syntax error: this is not an equation"):"undefined"!==typeof iseqn[c]||E||(t=_("syntax error: you gave an equation, not an expression"));c=b.substr(1);setupLivePreview(c);LivePreviews[c].RenderNow("`"+
h+"` "+wrapAMnotice(t))}function AMmathpreview(a,b){for(var c=document.getElementById(a).value,g=document.getElementById(b),l=g.childNodes.length,h=0;h<l;h++)g.removeChild(g.firstChild);g.appendChild(document.createTextNode("`"+c+"`"));noMathRender||rendermathnode(g)}
function singlevalsyntaxcheck(a,b){if(!a.match(/DNE/i)&&!a.match(/oo$/)&&!a.match(/oo\W/))if(-1!=b.indexOf("fraction")||-1!=b.indexOf("reducedfraction")){if(a=a.replace(/\s/g,""),!a.match(/^\(?\-?\(?\d+\)?\/\(?\d+\)?$/)&&!a.match(/^\(?\d+\)?\/\(?\-?\d+\)?$/)&&!a.match(/^\s*?\-?\d+\s*$/))return _("not a valid fraction")+". "}else if(-1!=b.indexOf("fracordec")){if(a=a.replace(/\s/g,""),!a.match(/^\-?\(?\d+\s*\/\s*\-?\d+\)?$/)&&!a.match(/^\-?\d+$/)&&!a.match(/^\-?(\d+|\d+\.\d*|\d*\.\d+)$/))return _(" invalid entry format")+
". "}else if(-1!=b.indexOf("mixednumber")){if(!a.match(/^\s*\-?\s*\d+\s*(_|\s)\s*\d+\s*\/\s*\d+\s*$/)&&!a.match(/^\s*?\-?\d+\s*$/)&&!a.match(/^\s*\-?\d+\s*\/\s*\-?\d+\s*$/))return _("not a valid mixed number")+". ";a.replace(/_/," ")}else if(-1!=b.indexOf("scinot")&&(a=a.replace(/\s/g,""),a=a.replace(/(x|X|\u00D7)/,"xx"),!a.match(/^\-?[1-9](\.\d*)?(\*|xx)10\^(\(?\-?\d+\)?)$/)))return _("not valid scientific notation")+". ";return""}
function syntaxcheckexpr(a,b,c){var g="";-1!=b.indexOf("notrig")&&a.match(/(sin|cos|tan|cot|sec|csc)/i)?g+=_("no trig functions allowed")+". ":-1!=b.indexOf("nodecimal")&&-1!=a.indexOf(".")&&(g+=_("no decimals allowed")+". ");for(var l=b=0,h=0;h<a.length;h++)"("==a.charAt(h)?b++:")"==a.charAt(h)?b--:"["==a.charAt(h)?l++:"]"==a.charAt(h)&&l--;if(0!=b||0!=l)g+=" ("+_("unmatched parens")+"). ";reg=c?new RegExp("(sqrt|ln|log|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs)s*("+c+"|\\d+)","i"):
/(sqrt|ln|log|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs)s*(\d+)/i;errstuff=a.match(reg);null!=errstuff&&(g+="["+_("use function notation")+" - "+_("use $1 instead of $2",errstuff[1]+"("+errstuff[2]+")",errstuff[0])+"]. ");c&&(reg=new RegExp("(repvars\\d+|"+c+"|arc|sqrt|root|ln|log|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs|pi|e|sign|DNE|oo)","ig"),a.replace(reg,"").match(/[a-zA-Z]/)&&(g+=_(" Check your variables - you might be using an incorrect one")+". "));a.match(/\|/)&&
(g+=_(" Use abs(x) instead of |x| for absolute values")+". ");a.match(/%/)&&!a.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(g+=_(" Do not use the percent symbol, %")+". ");return g}var greekletters="alpha beta chi delta epsilon gamma phi psi sigma rho theta lambda mu nu omega tau".split(" "),calctoproc={},intcalctoproc={},calcformat={},functoproc={},matcalctoproc={},ntupletoproc={},complextoproc={},callbackstack={},matsize={},vlist={},flist={},pts={},iseqn={};
function doonsubmit(a,b,c){for(var g in callbackstack)callbackstack[g](g);if(null!=a){if("submitted"==a.className)return alert(_("You have already submitted this page.  Please be patient while your submission is processed.")),a.className="submitted2",!1;if("submitted2"==a.className)return!1;a.className="submitted";if(!c&&(b?!confirmSubmit2(a):!confirmSubmit(a)))return a.className="",!1}imathasDraw.encodea11ydraw();for(g in intcalctoproc)if(g=parseInt(g),null!=document.getElementById("tc"+g)){fullstr=
document.getElementById("tc"+g).value;fullstr=fullstr.replace(/\s+/g,"");fullstr=normalizemathunicode(fullstr);if(fullstr.match(/DNE/i))fullstr=fullstr.toUpperCase();else{-1!=calcformat[g].indexOf("inequality")&&(fullstr=ineqtointerval(fullstr));if(-1!=calcformat[g].indexOf("list")){b=0;a=[];for(c=1;c<fullstr.length-1;c++)","!=fullstr.charAt(c)||")"!=fullstr.charAt(c-1)&&"]"!=fullstr.charAt(c-1)||"("!=fullstr.charAt(c+1)&&"["!=fullstr.charAt(c+1)||(a.push(fullstr.substring(b,c)),b=c+1);a.push(fullstr.substring(b))}else a=
fullstr.split(/U/i);for(k=0;k<a.length;k++)if(str=a[k],0<str.length&&str.match(/,/)){sm=str.charAt(0);em=str.charAt(str.length-1);vals=str.substring(1,str.length-1);vals=vals.split(/,/);for(b=0;2>b;b++)if(!vals[b].match(/oo$/)&&!vals[b].match(/oo\W/)){c="";try{with(Math)var l=eval(mathjs(vals[b]))}catch(h){c="syntax incomplete"}isNaN(l)||"Infinity"==l||(vals[b]=(1E-15>Math.abs(l)?0:l)+c)}a[k]=sm+vals[0]+","+vals[1]+em}fullstr=-1!=calcformat[g].indexOf("list")?a.join(","):a.join("U")}document.getElementById("qn"+
g).value=fullstr}for(g in calctoproc)if(g=parseInt(g),null!=document.getElementById("tc"+g)){str=document.getElementById("tc"+g).value;str=normalizemathunicode(str);str=str.replace(/=/,"");if(-1!=calcformat[g].indexOf("list"))a=str.split(/,/);else if(-1!=calcformat[g].indexOf("set"))if(str.match(/^\s*{.*?}\s*$/))a=str.replace(/^\s*{(.*?)}\s*$/,"$1").split(/,/);else continue;else a=[],a[0]=str;for(b=0;b<a.length;b++){str=a[b];str=str.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");str=str.replace(",","*NaN*");
if(-1!=calcformat[g].indexOf("scinot")||-1!=calcformat[g].indexOf("allowxtimes"))str=str.replace(/(x|X|\u00D7)/,"*");str.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(str=str.replace(/%/,"")+"/100");str=str.replace(/(\d+)\s*_\s*(\d+\s*\/\s*\d+)/,"($1+$2)");-1!=calcformat[g].indexOf("mixed")&&(str=str.replace(/(\d+)\s+(\d+\s*\/\s*\d+)/,"($1+$2)"));if(str.match(/^\s*$/))l="";else if(str.match(/oo$/)||str.match(/oo\W/))l=str;else if(str.match(/DNE/i))l=str.toUpperCase();else try{with(Math)l=
eval(mathjs(str))}catch(h){l=""}a[b]=l}document.getElementById("qn"+g).value=a.join(",")}for(g in matcalctoproc){g=parseInt(g);if(null!=matsize[g]){if(null==document.getElementById("qn"+g+"-0"))continue;msize=matsize[g].split(",");str=matrixcalc("qn"+g,null,msize[0],msize[1])}else{if(null==document.getElementById("tc"+g))continue;str=matrixcalc("tc"+g,null)}document.getElementById("qn"+g).value=str}for(g in ntupletoproc)g=parseInt(g),null!=document.getElementById("tc"+g)&&(str=ntuplecalc("tc"+g,null,
""),document.getElementById("qn"+g).value=str);for(g in complextoproc)g=parseInt(g),null!=document.getElementById("tc"+g)&&(str=complexcalc("tc"+g,null,""),document.getElementById("qn"+g).value=str);for(g in functoproc)if(g=parseInt(g),null!=document.getElementById("tc"+g)){str=document.getElementById("tc"+g).value;str=str.replace(/,/g,"");str=normalizemathunicode(str);if(1==iseqn[g])str=str.replace(/(.*)=(.*)/,"$1-($2)");else if(str.match("="))continue;fl=flist[g];varlist=vlist[g];vars=varlist.split("|");
for(l=0;l<vars.length;l++){foundaltcap=!1;for(b=0;b<vars.length;b++)if(l!=b&&vars[b].toLowerCase()==vars[l].toLowerCase()&&vars[b]!=vars[l]){foundaltcap=!0;break}foundaltcap?regmod="g":(str=str.replace(new RegExp(vars[l],"gi"),vars[l]),regmod="gi");2<vars[l].length&&vars[l].match(/^\w+_\w+$/)?(a=vars[l].match(/^(\w+)_(\w+)$/),str=str.replace(new RegExp(a[1]+"_\\("+a[2]+"\\)",regmod),vars[l]),str=str.replace(new RegExp(a[0],"g"),"repvars"+l),vars[l]="repvars"+l):"varE"==vars[l]&&(str=str.replace("E",
"varE"))}varlist=vars.join("|");""!=fl&&(reg=new RegExp("("+fl+")\\(","g"),str=str.replace(reg,"$1*sin($1+"));vars=varlist.split("|");l=document.getElementById("qn"+g);l.value=mathjs(str,varlist);ptlist=pts[g].split(",");vals=[];for(a=0;a<ptlist.length;a++){inputs=ptlist[a].split("~");totest="";for(b=0;b<inputs.length;b++)totest+="var "+vars[b]+"="+inputs[b]+";";totest=""==l.value?totest+(Math.random()+";"):totest+(l.value+";");try{with(Math)vals[a]=scopedeval(totest)}catch(h){vals[a]=NaN}"synerr"==
vals[a]&&(vals[a]=NaN)}document.getElementById("qn"+g+"-vals").value=vals.join(",")}return!0}function scopedeval(a){var b;try{with(Math)b=eval(a);return b}catch(c){return"synerr"}}function arraysearch(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return c;return-1}
function toggleinlinebtn(a,b){var c=document.getElementById(a);"none"==c.style.display?c.style.display="":c.style.display="none";if(null!=b){var c=document.getElementById(b),g=c.innerHTML;c.innerHTML=g.match(/\+/)?g.replace(/\+/,"-"):g.replace(/\-/,"+")}}
function assessbackgsubmit(a,b){if(null!=b&&document.getElementById(b).innerHTML==_("Submitting..."))return!1;window.XMLHttpRequest?req=new XMLHttpRequest:window.ActiveXObject&&(req=new ActiveXObject("Microsoft.XMLHTTP"));if("undefined"!=typeof req){"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();doonsubmit();params="embedpostback=true";if(null!=a){for(var c=[],g=document.getElementsByTagName("input"),l=0;l<g.length;l++)c.push(g[l]);g=document.getElementsByTagName("select");for(l=0;l<g.length;l++)c.push(g[l]);
g=document.getElementsByTagName("textarea");for(l=0;l<g.length;l++)c.push(g[l]);g=new RegExp("^(qn|tc|qs)("+a+"\\b|"+(a+1)+"\\d{3})");for(l=0;l<c.length;l++)c[l].name.match(g)&&("radio"!=c[l].type&&"checkbox"!=c[l].type||c[l].checked)&&(params+="&"+c[l].name+"="+encodeURIComponent(c[l].value));params+="&toscore="+a;params+="&verattempts="+document.getElementById("verattempts"+a).value}else{c=document.getElementsByTagName("input");for(l=0;l<c.length;l++)c[l].name.match(/^(qn|tc)/)&&("radio"!=c[l].type||
"checkbox"!=c[l].type||c[l].checked)&&(params+="&"+c[l].name+"="+encodeURIComponent(c[l].value));params+="&verattempts="+document.getElementById("verattempts").value}params+="&asidverify="+document.getElementById("asidverify").value;params+="&disptime="+document.getElementById("disptime").value;params+="&isreview="+document.getElementById("isreview").value;null!=b&&(document.getElementById(b).innerHTML=_("Submitting..."));req.open("POST",assesspostbackurl,!0);req.setRequestHeader("Content-type","application/x-www-form-urlencoded");
req.onreadystatechange=function(){assessbackgsubmitCallback(a,b)};req.send(params)}else null!=b&&(document.getElementById(b).innerHTML=_("Error Submitting."))}
function assessbackgsubmitCallback(a,b){if(4==req.readyState)if(200==req.status){if(null!=b&&(document.getElementById(b).innerHTML=""),null!=a){for(var c=[],g=req.responseText;-1<g.indexOf("<script")||-1<g.indexOf("\x3c/script");){var l=g.indexOf("<script"),h=g.indexOf(">",l),m=g.indexOf("\x3c/script",l),q=g.indexOf(">",m);c.push(g.substring(h+1,m));g=g.substring(0,l)+g.substring(q+1)}document.getElementById("embedqwrapper"+a).innerHTML=g;usingASCIIMath&&rendermathnode(document.getElementById("embedqwrapper"+
a));usingASCIISvg&&setTimeout("drawPics()",100);usingTinymceEditor&&initeditor("textareas","mceEditor");for(g=initstack.length=0;g<c.length;g++)try{if(k=c[g].match(/canvases\[(\d+)\]/))"undefined"!=typeof G_vmlCanvasManager&&(c[g]=c[g]+'G_vmlCanvasManager.initElement(document.getElementById("canvas'+k[1]+'"));'),c[g]=c[g]+"imathasDraw.initCanvases("+k[1]+");";eval(c[g])}catch(A){}for(g=0;g<initstack.length;g++)initstack[g]();c=(a+1).toString().length;for(g in LivePreviews)(g==a||999<g&&g.toString().substr(0,
c)==a+1)&&LivePreviews[g].Init();$(window).trigger("ImathasEmbedReload");initcreditboxes();c=0;"undefined"!=typeof window.pageYOffset?c=window.pageYOffset:(c=document.body,g=document.documentElement,g=g.clientHeight?g:c,c=g.scrollTop);var t=findPos(document.getElementById("embedqwrapper"+a))[1];c>t&&setTimeout(function(){window.scroll(0,t)},150)}}else null!=b&&(document.getElementById(b).innerHTML=_("Submission Error")+":\n"+req.status+"\n"+req.statusText)}
function AutoSuggest(a,b){var c=this;this.elem=a;this.suggestions=b;this.eligible=[];this.inputText=null;this.highlighted=-1;this.div=document.getElementById("autosuggest");null==this.div&&(this.div=document.createElement("div"),this.div.id="autosuggest",document.getElementsByTagName("body")[0].appendChild(this.div),this.div.appendChild(document.createElement("ul")));a.setAttribute("autocomplete","off");if(!a.id){var g="autosuggest"+AutoSuggestIdCounter;AutoSuggestIdCounter++;a.id=g}a.onkeydown=function(a){a=
c.getKeyCode(a);switch(a){case 9:c.useSuggestion("tab");break;case 13:return c.useSuggestion("enter"),!1;case 27:c.hideDiv();break;case 38:0<c.highlighted&&c.highlighted--;c.changeHighlight(a);break;case 40:c.highlighted<c.eligible.length-1&&c.highlighted++,c.changeHighlight(a)}};a.onkeyup=function(a){switch(c.getKeyCode(a)){case 9:case 27:case 38:case 40:break;default:1<this.value.length?(c.inputText=this.value,c.getEligible(),c.highlighted=0<c.eligible.length?0:-1,c.createDiv(),c.positionDiv(),
c.showDiv()):(c.hideDiv(),0==this.value.length&&(c.inputText=""))}};a.onblur=function(a){setTimeout(c.hideDiv,100)};this.useSuggestion=function(a){-1<this.highlighted&&(this.elem.value=this.eligible[this.highlighted]);this.hideDiv()};this.showDiv=function(){this.div.style.display="block"};this.hideDiv=function(){c.div.style.display="none";c.highlighted=-1};this.changeHighlight=function(){var a=this.div.getElementsByTagName("LI");for(i in a)a[i].className=this.highlighted==i?"selected":""};this.positionDiv=
function(){var a=this.elem,b=findPos(a);b[1]+=a.offsetHeight;this.div.style.left=b[0]+"px";this.div.style.top=b[1]+"px"};this.createDiv=function(){var a=document.createElement("ul");for(i in this.eligible){var b=this.eligible[i],g=document.createElement("li"),q=document.createElement("a");q.href="#";q.onclick=function(){return!1};q.innerHTML=b;g.appendChild(q);c.highlighted==i&&(g.className="selected");a.appendChild(g)}this.div.replaceChild(a,this.div.childNodes[0]);a.onmouseover=function(a){for(a=
c.getEventSource(a);a.parentNode&&"LI"!=a.tagName.toUpperCase();)a=a.parentNode;var b=c.div.getElementsByTagName("LI");for(i in b)if(b[i]==a){c.highlighted=i;break}c.changeHighlight()};a.onclick=function(a){c.useSuggestion("click");c.hideDiv();c.cancelEvent(a);return!1};this.div.className="suggestion_list";this.div.style.position="absolute"};this.getEligible=function(){this.eligible=[];if(-1==this.inputText.indexOf(" ")){var a=new RegExp("\\b"+this.inputText.toLowerCase());for(i in this.suggestions){var b=
this.suggestions[i];b.toLowerCase().match(a)&&(this.eligible[this.eligible.length]=b)}}};this.getKeyCode=function(a){if(a)return a.keyCode;if(window.event)return window.event.keyCode};this.getEventSource=function(a){if(a)return a.target;if(window.event)return window.event.srcElement};this.cancelEvent=function(a){a&&(a.preventDefault(),a.stopPropagation());window.event&&(window.event.returnValue=!1)}}var AutoSuggestIdCounter=0;function isBlank(a){return!a||0===a.length||/^\s*$/.test(a)}
function editdebit(a){var b=$("#qn"+(1*a.id.substr(2)-1));!isBlank(a.value)&&b.hasClass("iscredit")&&(b.is("select")?b.css("margin-right",20):b.width(b.width()+20),b.css("padding-left",0),b.removeClass("iscredit"))}function editcredit(a){var b=$("#qn"+(1*a.id.substr(2)-2));isBlank(a.value)||b.hasClass("iscredit")||(b.is("select")?b.css("margin-right",0):b.width(b.width()-20),b.css("padding-left",20),b.addClass("iscredit"))}
function initcreditboxes(){$(".creditbox").each(function(a,b){if(!isBlank(b.value)&&20!=$(b).css("padding-left")){var c=$("#qn"+(1*b.id.substr(2)-2));c.is("select")?c.css("margin-right",0):c.width(c.width()-20);c.css("padding-left",20);c.addClass("iscredit")}})}initstack.push(initcreditboxes);
function initqsclickchange(){$("input[id^=qs][value=spec]").each(function(a,b){$(b).siblings("input[type=text]").off("keyup.qsclickchange").on("keyup.qsclickchange",function(a){8!=a.keyCode&&46!=a.keyCode&&$(b).prop("checked",!0)})})}$(window).on("ImathasEmbedReload",initqsclickchange);initstack.push(initqsclickchange);
function assessmentTimer(a,b){var c=Date.now(),g,l,h,m,q,t;q=setInterval(function(){g=a-Math.floor((Date.now()-c)/1E3);if(0>=g){g=0;clearInterval(q);if(b){document.getElementById("timelimitholder").className="";document.getElementById("timelimitholder").style.color="#f00";document.getElementById("timelimitholder").innerHTML=_("Time limit expired - submitting now");document.getElementById("timelimitholder").style.fontSize="300%";if(null==document.getElementById("qform")){setTimeout("window.location.pathname='"+
imasroot+"/assessment/showtest.php?action=skip&superdone=true'",2E3);return}var A=document.getElementById("qform"),E=A.getAttribute("action");A.setAttribute("action",E+"&superdone=true");doonsubmit(A,!0,!0)&&setTimeout('document.getElementById("qform").submit()',2E3);return 0}alert(_("Time Limit has elapsed"))}m=Math.floor(g%60);h=Math.floor(g/60%60);l=Math.floor(g/3600);0==l&&5>=h&&(document.getElementById("timeremaining").style.color="#f00");0==l&&0==h&&5>=m&&(document.getElementById("timeremaining").style.fontSize=
"150%");t=(0<l?l+":":"")+(0<l&&10>h?"0":"")+h+":"+(10>m?"0":"")+m;document.getElementById("timeremaining").innerHTML=t},1E3);$(document).ready(function(){var a=$("#timerwrap"),b=a.position();$(window).scroll(function(){$(window).scrollTop()>=b.top?a.addClass("sticky"):a.removeClass("sticky")})})}
function toggletimer(){"[x]"==$("#timerhide").text()?($("#timercontent").hide(),$("#timerhide").text("["+_("Show Timer")+"]"),$("#timerhide").attr("title","["+_("Show Timer")+"]")):($("#timercontent").show(),$("#timerhide").text("[x]"),$("#timerhide").attr("title",_("Hide Timer")))}
function toggleintroshow(a){var b=document.getElementById("introtoggle"+a);a=document.getElementById("intropiece"+a);b.innerHTML.match("Hide")?(b.innerHTML=b.innerHTML.replace("Hide","Show"),a.style.display="none"):(b.innerHTML=b.innerHTML.replace("Show","Hide"),a.style.display="block")}
function togglemainintroshow(a){$("#intro").hasClass("hidden")?($(a).html(_("Hide Intro/Instructions")),$("#intro").removeClass("hidden").addClass("intro")):($("#intro").addClass("hidden"),$(a).html(_("Show Intro/Instructions")))}
function checkComplete(a){if("undefined"!=typeof tinyMCE)try{tinyMCE.triggerSave()}catch(h){}if(!a.elements)return!0;for(var b=0;b<a.elements.length;b++){var c=a.elements[b];if("undefined"!=typeof c.type&&"undefined"!=typeof c.name&&""!=c.name&&!$(c).is(":not(:visible)"))if("text"==c.type||"textarea"==c.type||"password"==c.type||"file"==c.type){if(""==c.value)return!1}else if(-1!=c.type.indexOf("select")){if(-1==c.selectedIndex)return!1}else if("radio"==c.type){var g=a[c.name],l=!1;if(g.length)for(c=
0;c<g.length&&!(l=g[c].checked);c++);else l=c.checked;if(!l)return!1}}return!0}function confirmSubmit(a){return checkComplete(a)?!0:confirm("Not all question parts have been answered.  Are you sure you want to submit this question?")}function confirmSubmit2(a){return checkComplete(a)?!0:confirm("Not all questions have been answered completely.  If you are saving your answers for later, this is fine.  If you are submitting for grading, are you sure you want to submit now?")}
var canvases=[],drawla=[],imathasDraw=function(a){function b(a,d){var b=a[0];ga.push(b);var f=a[1].substr(9).split(","),l=a[2],h=a[3],m=a[4],q=a[5];m==q&&(m=-1,q=1);var z=a[6],v=a[7],y=a[8],t=document.getElementById("a11ydraw"+b);ca[b]=document.getElementById("qn"+b);n[b]={el:t,xmin:l,xmax:h,ymin:m,ymax:q,imgborder:z,imgwidth:v,imgheight:y};n[b].pixperx=(v-2*z)/(h-l);n[b].pixpery=m==q?1:(y-2*z)/(q-m);"inequality"==f[0]?(l=f.shift(),0==f.length?f=["line"]:"both"==f[0]&&(f=["line","parab"])):"twopoint"==
f[0]?(l=f.shift(),0==f.length&&(f=["line","parab","abs","circle","dot"])):"numberline"==f[0]?(l="basic",f.shift()):l="basic";n[b].afgroup=l;for(var h={inequality:{line:[{mode:10,descr:_("Linear inequality with solid line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")},{mode:10.2,descr:_("Linear inequality with dashed line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")}],parab:[{mode:10.3,descr:_("Parabolic inequality with solid line"),
inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")},{mode:10.4,descr:_("Parabolic inequality with dashed line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")}]},twopoint:{line:[{mode:5,descr:_("Line"),inN:2,input:_("Enter two points on the line")}],lineseg:[{mode:5.3,descr:_("Line segment"),inN:2,input:_("Enter the starting and ending point of the line segment")}],ray:[{mode:5.2,descr:_("Ray"),inN:2,input:_("Enter the starting point of the ray and another point on the ray")}],
parab:[{mode:6,descr:_("Parabola"),inN:2,input:_("Enter the vertex, then another point on the parabola")}],sqrt:[{mode:6.5,descr:_("Square root"),inN:2,input:_("Enter the starting point of the square root, then another point on the graph")}],abs:[{mode:8,descr:_("Absolute value"),inN:2,input:_("Enter the corner point of the absolute value, then another point on the graph")}],rational:[{mode:8.2,descr:_("Rational"),inN:2,input:_("Enter the point where the vertical and horizontal asymptote cross, then a point on the graph")}],
exp:[{mode:8.3,descr:_("Exponential"),inN:2,input:_("Enter two points on the graph")}],circle:[{mode:7,descr:_("Circle"),inN:2,input:_("Enter the center point of the circle, then a point on the graph")}],dot:[{mode:1,descr:_("Solid dot"),inN:1,input:_("Enter the coordinates of the dot")}],opendot:[{mode:2,descr:_("Open dot"),inN:1,input:_("Enter the coordinates of the dot")}],trig:[{mode:9,descr:_("Cosine"),inN:2,input:_("Enter a point at the start of a phase, then a point half a phase further")},
{mode:9.2,descr:_("Sine"),inN:2,input:_("Enter a point at the start of a phase, then a point a quarter phase further")}],vector:[{mode:5.4,descr:_("Vector"),inN:2,input:_("Enter the starting and ending point of the vector")}]},basic:{line:[{mode:0,descr:_("Lines"),inN:"list",input:_("Enter list of points to connect with lines")}],lineseg:[{mode:.5,descr:_("Line segment"),inN:2,input:_("Enter the starting and ending point of the line segment")}],freehand:[{mode:.7,descr:_("Freehand"),inN:"list",input:_("Enter list of points to connect with lines")}],
dot:[{mode:1,descr:_("Solid dot"),inN:1,input:_("Enter the coordinates of the dot")}],opendot:[{mode:2,descr:_("Open dot"),inN:1,input:_("Enter the coordinates of the dot")}],polygon:[{mode:1,descr:_("Polygon"),inN:"list",input:_("Enter list of points to place dots connected with lines"),dotline:1}],closedpolygon:[{mode:1,descr:_("Polygon"),inN:"list",input:_("Enter list of points to place dots connected with lines"),dotline:2}]}},F,m=[],q=[],z=[],y=0;y<f.length;y++)if(h[l].hasOwnProperty(f[y]))for(0==
y&&(F=h[l][f[y]][0].mode),t=0;t<h[l][f[y]].length;t++)z[h[l][f[y]][t].mode]=h[l][f[y]][t],m.push(h[l][f[y]][t].mode),v='<option value="'+h[l][f[y]][t].mode+'"',v+=' data-af="'+f[y]+'">'+h[l][f[y]][t].descr+"</option>",q.push(v);n[b].defmode=F;n[b].inputmodes=m;n[b].selects=q;n[b].moderef=z;if(null==d&&w.hasOwnProperty(b)){for(y=0;y<w[b].length;y++)c(b,0,g(w[b][y],b));for(y=0;y<K[b].length;y++)c(b,1,g(K[b][y],b));for(y=0;y<J[b].length;y++)c(b,2,g(J[b][y],b));for(y=0;y<r[b].length;y++)c(b,H[b][y],g(r[b][y][0],
b)+","+g(r[b][y][1],b));for(y=0;y<u[b].length;y++)c(b,P[b][y],g(u[b][y][0],b)+","+g(u[b][y][1],b)+","+g(u[b][y][2],b))}else if(null!=d)for(y=0;y<d.length;y++)c(b,d[y][0],d[y][1].replace(/\[/g,"(").replace(/\]/g,")"))}function c(d,b,c){var f=n[d];b=b||f.defmode;var g=c||"";html='<select aria-label="'+_("Drawing element type")+'" onchange="imathasDraw.changea11ydraw(this,\''+d+"')\">";for(j in f.selects)html+=f.selects[j];html+="</select><br/>";html+='<span class="a11ydrawinstr"></span><br/>';html+=
'<input type="text" aria-label="'+_("Point list")+'" value="'+g+'"/>';html+='<button type="button" class="imgbutton" onclick="imathasDraw.removea11ydraw(this)">';html+=_("Remove")+"</button>";d=a("<li>",{"class":"a11ydrawrow"}).html(html);a(f.el).append(d);d.find("select").val(b);d.find(".a11ydrawinstr").text(f.moderef[b].input);c||d.find("select").focus()}function g(a,d){var b=n[d],f;f=(a[0]-b.imgborder)/b.pixperx+b.xmin;b=(b.imgheight-a[1]-b.imgborder)/b.pixpery+b.ymin;f=Math.round(100*f)/100;b=
Math.round(100*b)/100;return"("+f+","+b+")"}function l(a,b,c,f,g,l,m,q,z,v,y,t,F,D,A){b=document.getElementById(b);b.style.userSelect="none";b.style.webkitUserSelect="none";b.style.MozUserSelect="none";var B=S(b);n[a]={el:b,left:B.x,top:B.y,width:b.offsetWidth,height:b.offsetHeight,xmin:g,xmax:l,ymin:m,ymax:q,imgborder:z,imgwidth:v,imgheight:y,mode:t,dotline:F};"string"==typeof A&&-1!=A.indexOf(":")?(A=A.split(":"),n[a].snaptogridx=1*A[0],n[a].snaptogridy=1*A[1]):(n[a].snaptogridx=A,n[a].snaptogridy=
A);n[a].pixperx=(v-2*z)/(l-g);n[a].pixpery=m==q?1:(y-2*z)/(q-m);ca[a]=document.getElementById(f);null==w[a]&&(w[a]=[]);null==K[a]&&(K[a]=[]);null==J[a]&&(J[a]=[]);null==r[a]&&(r[a]=[]);null==H[a]&&(H[a]=[]);null==u[a]&&(u[a]=[]);null==P[a]&&(P[a]=[]);ja[a]=5<=t?1:0;W[a]=D;da[a]=new Image;da[a].onload=function(){var f=d;d=a;h();d=f};da[a].src=c}function h(a,b){try{var c=n[d].el.getContext("2d")}catch(g){ka||(ka=!0,alert("Your browser does not support drawing answer entry.  Please try again using Internet Explorer 6+ (Windows), FireFox 1.5+ (Win/Mac), Safari 1.3+ (Mac), Opera 9+ (Win/Mac), or Camino (Mac)"))}c.fillStyle=
"rgb(0,0,255)";c.lineWidth=2;c.strokeStyle="rgb(0,0,255)";c.clearRect(0,0,n[d].imgwidth,n[d].imgheight);c.drawImage(da[d],0,0);c.beginPath();for(var f=0;f<u[d].length;f++){var l=f%3;c.strokeStyle=la[l];c.fillStyle=la[l];var h=null,m=null,q=null,z=null,t=null;3==u[d][f].length?(m=u[d][f][1][0],z=u[d][f][1][1],q=u[d][f][2][0],t=u[d][f][2][1]):2==u[d][f].length?(m=u[d][f][1][0],z=u[d][f][1][1],q=a,t=b):L==f&&null!=a&&1==u[d][f].length&&(m=a,z=b);if(null!=q){c.save();c.fillStyle=ta[l];c.beginPath();if(10.2>=
P[d][f]){m!=u[d][f][0][0]&&(h=(z-u[d][f][0][1])/(m-u[d][f][0][0]));if(1>Math.abs(m-u[d][f][0][0])||100<Math.abs(h))c.moveTo(u[d][f][0][0],0),c.lineTo(u[d][f][0][0],n[d].imgheight),q>m?(c.lineTo(n[d].imgwidth,n[d].imgheight),c.lineTo(n[d].imgwidth,0)):(c.lineTo(0,n[d].imgheight),c.lineTo(0,0));else{var l=h*(q-m)+z,q=u[d][f][0][1]-h*u[d][f][0][0],y=u[d][f][0][1]+h*(n[d].imgwidth-u[d][f][0][0]);c.moveTo(0,q);c.lineTo(n[d].imgwidth,y);t>l?(c.lineTo(n[d].imgwidth,n[d].imgheight),c.lineTo(0,n[d].imgheight)):
(c.lineTo(n[d].imgwidth,0),c.lineTo(0,0))}c.closePath()}else{var l=c,A=u[d][f][0][0],F=u[d][f][0][1],B=m,E=z,I=t,t=n[d].imgwidth,y=n[d].imgheight;l.beginPath();if(E==F)l.moveTo(0,E),l.lineTo(t,E),I<F?(l.lineTo(t,0),l.lineTo(0,0)):(l.lineTo(t,y),l.lineTo(0,y));else{var B=(E-F)/((B-A)*(B-A)),Q=-2*B*A,R=0;E>F&&(R=y);var F=B*A*A+F-R,N=Math.sqrt(Q*Q-4*B*F),F=F+R,E=(-Q-N)/(2*B),R=B*E*E+Q*E+F,N=(-Q+N)/(2*B),S=R;if(N<E)var Y=E,E=N,N=Y;var Y=2*B*(E-A),V=R-Y*E,A=-Y,A=(V-(S-A*N))/(A-Y),Y=Y*A+V;0>B&&I<B*q*q+
Q*q+F||0<B&&I>B*q*q+Q*q+F?(l.moveTo(E,R),l.quadraticCurveTo(A,Y,N,S)):(q=y,2>Math.abs(R-y)&&(q=0),l.moveTo(0,R),l.lineTo(E,R),l.quadraticCurveTo(A,Y,N,S),l.lineTo(t,S),l.lineTo(t,q),l.lineTo(0,q))}l.closePath()}c.fill();c.restore()}c.beginPath();if(null!=m)if(10.2>=P[d][f])m!=u[d][f][0][0]&&(h=(z-u[d][f][0][1])/(m-u[d][f][0][0])),1>Math.abs(m-u[d][f][0][0])||100<Math.abs(h)?10.2==P[d][f]?null!=v&&10<=v.mode&&11>v.mode&&v.num==f&&0==v.subnum?(c.dashedLine(u[d][f][1][0],u[d][f][1][1],u[d][f][1][0],
n[d].imgheight),c.dashedLine(u[d][f][1][0],u[d][f][1][1],u[d][f][1][0],0)):(c.dashedLine(u[d][f][0][0],u[d][f][0][1],u[d][f][0][0],n[d].imgheight),c.dashedLine(u[d][f][0][0],u[d][f][0][1],u[d][f][0][0],0)):(c.moveTo(u[d][f][0][0],0),c.lineTo(u[d][f][0][0],n[d].imgheight),c.stroke()):(q=u[d][f][0][1]-h*u[d][f][0][0],y=u[d][f][0][1]+h*(n[d].imgwidth-u[d][f][0][0]),10.2==P[d][f]?null!=v&&10<=v.mode&&11>v.mode&&v.num==f&&0==v.subnum?(c.dashedLine(u[d][f][1][0],u[d][f][1][1],n[d].imgwidth,y),c.dashedLine(u[d][f][1][0],
u[d][f][1][1],0,q)):(c.dashedLine(u[d][f][0][0],u[d][f][0][1],n[d].imgwidth,y),c.dashedLine(u[d][f][0][0],u[d][f][0][1],0,q)):(c.moveTo(0,q),c.lineTo(n[d].imgwidth,y),c.stroke()));else if(10.3==P[d][f]){if(m!=u[d][f][0][0])if(z==u[d][f][0][1])c.moveTo(0,z),c.lineTo(n[d].imgwidth,z);else{var O=(z-u[d][f][0][1])/((m-u[d][f][0][0])*(m-u[d][f][0][0]));z>u[d][f][0][1]?(h=Math.sqrt((n[d].imgheight-u[d][f][0][1])/O)+u[d][f][0][0],l=-1*Math.sqrt((n[d].imgheight-u[d][f][0][1])/O)+u[d][f][0][0],y=u[d][f][0][1]-
(n[d].imgheight-u[d][f][0][1]),q=n[d].imgheight):(h=Math.sqrt((0-u[d][f][0][1])/O)+u[d][f][0][0],l=-1*Math.sqrt((0-u[d][f][0][1])/O)+u[d][f][0][0],y=2*u[d][f][0][1],q=0);t=h+2/3*(u[d][f][0][0]-h);y=q+2/3*(y-q);I=t+(l-h)/3;B=y;c.moveTo(h,q);c.bezierCurveTo(t,y,I,B,l,q)}c.stroke()}else if(m!=u[d][f][0][0]){h=c;l=u[d][f][0][0];q=u[d][f][0][1];y=m;B=z;t=n[d].imgwidth;A=n[d].imgheight;if(B==q)h.moveTo(0,B),h.dashedLine(0,B,t,B);else{y=(B-q)/((y-l)*(y-l));I=-2*y*l;Q=0;B>q&&(Q=A);B=y*l*l+q-Q;A=Math.sqrt(I*
I-4*y*B);B+=Q;Q=(-I-A)/(2*y);A=(-I+A)/(2*y);A<Q&&(F=Q,Q=A,A=F);F=l;E=q;for(R=0;F>Q-5&&-5<F;)0==R%2?h.moveTo(F,E):h.lineTo(F,E),F-=Math.min(Math.sqrt(64/(1+Math.pow(2*y*(F-l),2))),Math.sqrt(8/Math.abs(y))),E=y*F*F+I*F+B,R++;F=l;E=q;for(R=0;F<A+5&&F<t+5;)0==R%2?h.moveTo(F,E):h.lineTo(F,E),F+=Math.min(Math.sqrt(64/(1+Math.pow(2*y*(F-l),2))),Math.sqrt(8/Math.abs(y))),E=y*F*F+I*F+B,R++}h.stroke()}c.beginPath();for(h=0;h<u[d][f].length;h++)2==h?(c.arc(u[d][f][h][0],u[d][f][h][1],4,0,2*Math.PI,!0),c.fill()):
c.fillRect(u[d][f][h][0]-3,u[d][f][h][1]-3,6,6);1==u[d][f].length&&null!=m&&c.fillRect(m-3,z-3,6,6);c.beginPath()}c.fillStyle="rgb(0,0,255)";c.lineWidth=1==W[d]?4:2;c.strokeStyle="rgb(0,0,255)";for(f=0;f<r[d].length;f++){if(5<=H[d][f]&&6>H[d][f])z=m=h=null,2==r[d][f].length?(m=r[d][f][1][0],z=r[d][f][1][1]):G==f&&null!=a&&1==r[d][f].length&&(m=a,z=b),null!=m&&(5.3==H[d][f]||5.4==H[d][f]?(c.moveTo(r[d][f][0][0],r[d][f][0][1]),c.lineTo(m,z),5.4==H[d][f]&&(h=[m-r[d][f][0][0],z-r[d][f][0][1]],l=Math.sqrt(h[0]*
h[0]+h[1]*h[1]),1E-4<l&&(h=[h[0]/l,h[1]/l],l=[-h[1],h[0]],c.moveTo(m-15*h[0]-4*l[0],z-15*h[1]-5*l[1]),c.lineTo(m,z),c.moveTo(m-15*h[0]+4*l[0],z-15*h[1]+5*l[1]),c.lineTo(m,z)))):(m!=r[d][f][0][0]&&(h=(z-r[d][f][0][1])/(m-r[d][f][0][0])),1>Math.abs(m-r[d][f][0][0])||100<Math.abs(h)?5.2==H[d][f]?(c.moveTo(r[d][f][0][0],r[d][f][0][1]),z>r[d][f][0][1]?c.lineTo(r[d][f][0][0],n[d].imgheight):c.lineTo(r[d][f][0][0],0)):(c.moveTo(r[d][f][0][0],0),c.lineTo(r[d][f][0][0],n[d].imgheight)):(q=r[d][f][0][1]-h*
r[d][f][0][0],y=r[d][f][0][1]+h*(n[d].imgwidth-r[d][f][0][0]),5.2==H[d][f]?(c.moveTo(r[d][f][0][0],r[d][f][0][1]),m>r[d][f][0][0]?c.lineTo(n[d].imgwidth,y):c.lineTo(0,q)):(c.moveTo(0,q),c.lineTo(n[d].imgwidth,y)))));else if(6==H[d][f])m=z=null,2==r[d][f].length?(m=r[d][f][1][0],z=r[d][f][1][1]):G==f&&null!=a&&1==r[d][f].length&&(m=a,z=b),null!=m&&m!=r[d][f][0][0]&&(z==r[d][f][0][1]?(c.moveTo(0,z),c.lineTo(n[d].imgwidth,z)):(O=(z-r[d][f][0][1])/((m-r[d][f][0][0])*(m-r[d][f][0][0])),z>r[d][f][0][1]?
(h=Math.sqrt((n[d].imgheight-r[d][f][0][1])/O)+r[d][f][0][0],l=-1*Math.sqrt((n[d].imgheight-r[d][f][0][1])/O)+r[d][f][0][0],y=r[d][f][0][1]-(n[d].imgheight-r[d][f][0][1]),q=n[d].imgheight):(h=Math.sqrt((0-r[d][f][0][1])/O)+r[d][f][0][0],l=-1*Math.sqrt((0-r[d][f][0][1])/O)+r[d][f][0][0],y=2*r[d][f][0][1],q=0),t=h+2/3*(r[d][f][0][0]-h),y=q+2/3*(y-q),I=t+(l-h)/3,B=y,c.moveTo(h,q),c.bezierCurveTo(t,y,I,B,l,q)));else if(6.5==H[d][f]){if(m=z=null,2==r[d][f].length?(m=r[d][f][1][0],z=r[d][f][1][1]):G==f&&
null!=a&&1==r[d][f].length&&(m=a,z=b),null!=m&&m!=r[d][f][0][0])if(z==r[d][f][0][1])c.moveTo(r[d][f][0][0],z),m>r[d][f][0][0]?c.lineTo(n[d].imgwidth,z):c.lineTo(0,z);else{h=m<r[d][f][0][0]?-1:1;O=(z-r[d][f][0][1])/Math.sqrt(h*(m-r[d][f][0][0]));c.moveTo(r[d][f][0][0],r[d][f][0][1]);t=r[d][f][0][0];q=r[d][f][0][1];do t+=3*h,c.lineTo(t,O*Math.sqrt(h*(t-r[d][f][0][0]))+r[d][f][0][1]);while(0<t&&t<n[d].imgwidth&&0<q&&q<n[d].imgheight)}}else if(7==H[d][f])2==r[d][f].length?(m=r[d][f][1][0],z=r[d][f][1][1]):
G==f&&null!=a&&1==r[d][f].length&&(m=a,z=b),null==m||m==r[d][f][0][0]&&z==r[d][f][0][1]||c.arc(r[d][f][0][0],r[d][f][0][1],Math.sqrt((m-r[d][f][0][0])*(m-r[d][f][0][0])+(z-r[d][f][0][1])*(z-r[d][f][0][1])),0,2*Math.PI,!0);else if(8==H[d][f])z=m=h=null,2==r[d][f].length?(m=r[d][f][1][0],z=r[d][f][1][1]):G==f&&null!=a&&1==r[d][f].length&&(m=a,z=b),null!=m&&(m!=r[d][f][0][0]&&(h=(z-r[d][f][0][1])/(m-r[d][f][0][0]),m<r[d][f][0][0]&&(h*=-1)),1>Math.abs(m-r[d][f][0][0])||100<Math.abs(h)?(c.moveTo(r[d][f][0][0],
r[d][f][0][1]),z>r[d][f][0][1]?c.lineTo(r[d][f][0][0],n[d].imgheight):c.lineTo(r[d][f][0][0],0)):(q=r[d][f][0][1]+h*r[d][f][0][0],y=r[d][f][0][1]+h*(n[d].imgwidth-r[d][f][0][0]),c.moveTo(0,q),c.lineTo(r[d][f][0][0],r[d][f][0][1]),c.lineTo(n[d].imgwidth,y)));else if(8.3==H[d][f]){if(m=z=null,2==r[d][f].length?(m=r[d][f][1][0],z=r[d][f][1][1]):G==f&&null!=a&&1==r[d][f].length&&(m=a,z=b),null!=m&&m!=r[d][f][0][0])if(z==r[d][f][0][1])c.moveTo(0,z),c.lineTo(n[d].imgwidth,z);else if(h=n[d].ymax*n[d].pixpery+
n[d].imgborder,l=h-r[d][f][0][1],q=h-z,0<l*q&&m!=r[d][f][0][0])for(l=safepow(q/l,1/(m-r[d][f][0][0])),O=q/safepow(l,m),c.moveTo(r[d][f][0][0],r[d][f][0][1]),t=0;t<n[d].imgwidth+4;t+=3)q=h-O*safepow(l,t),-100>q&&(q=-100),q>n[d].imgheight+100&&(q=n[d].imgheight+100),0==t?c.moveTo(t,q):c.lineTo(t,q)}else if(8.2==H[d][f]){if(m=z=null,2==r[d][f].length?(m=r[d][f][1][0],z=r[d][f][1][1]):G==f&&null!=a&&1==r[d][f].length&&(m=a,z=b),c.strokeStyle="rgb(0,255,0)",c.dashedLine(5,r[d][f][0][1],n[d].imgwidth,r[d][f][0][1]),
c.dashedLine(r[d][f][0][0],5,r[d][f][0][0],n[d].imgheight),c.beginPath(),c.strokeStyle="rgb(0,0,255)",null!=m&&m!=r[d][f][0][0]&&z!=r[d][f][0][1]){O=(z-r[d][f][0][1])*(m-r[d][f][0][0]);for(t=r[d][f][0][0]-1;-4<t;t-=3)q=O/(t-r[d][f][0][0])+r[d][f][0][1],-100>q&&(q=-100),q>n[d].imgheight+100&&(q=n[d].imgheight+100),t==r[d][f][0][0]-1?c.moveTo(t,q):c.lineTo(t,q);for(t=r[d][f][0][0]+1;t<n[d].imgwidth+4;t+=3)q=O/(t-r[d][f][0][0])+r[d][f][0][1],-100>q&&(q=-100),q>n[d].imgheight+100&&(q=n[d].imgheight+100),
t==r[d][f][0][0]+1?c.moveTo(t,q):c.lineTo(t,q);c.stroke()}}else if(9==H[d][f]||9.1==H[d][f])if(m=z=null,2==r[d][f].length?(m=r[d][f][1][0],z=r[d][f][1][1]):G==f&&null!=a&&1==r[d][f].length&&(m=a,z=b),null!=m&&m!=r[d][f][0][0])if(z==r[d][f][0][1])c.moveTo(0,z),c.lineTo(n[d].imgwidth,z);else{if(9==H[d][f])var Z=-1*Math.abs(z-r[d][f][0][1])/2,aa=(z+r[d][f][0][1])/2,O=Math.PI/Math.abs(m-r[d][f][0][0]),ba=z<r[d][f][0][1]?m:r[d][f][0][0];else 9.1==H[d][f]&&(Z=-1*Math.abs(z-r[d][f][0][1]),aa=r[d][f][0][1],
O=.5*Math.PI/Math.abs(m-r[d][f][0][0]),ba=z<r[d][f][0][1]?m:m+2*Math.abs(m-r[d][f][0][0]));for(t=0;t<n[d].imgwidth+4;t+=3)q=Z*Math.cos(O*(t-ba))+aa,0==t?c.moveTo(t,q):c.lineTo(t,q)}c.stroke();c.beginPath()}var M,X,T,U;c.fillStyle="rgba(0,0,255,.5)";for(f=0;f<w[d].length;f++){c.beginPath();for(h=0;h<w[d][f].length;h++)0==h?(c.moveTo(w[d][f][h][0],w[d][f][h][1]),M=w[d][f][h][0],X=w[d][f][h][1]):(c.lineTo(w[d][f][h][0],w[d][f][h][1]),T=w[d][f][h][0],U=w[d][f][h][1]);f==D&&null!=a&&(c.lineTo(a,b),T=a,
U=b);m=.02*n[d].imgwidth;1==W[d]&&T>.98*n[d].imgwidth?(c.moveTo(T,U),c.lineTo(T-m,U+m),c.moveTo(T,U),c.lineTo(T-m,U-m)):1==W[d]&&M>.98*n[d].imgwidth&&(c.moveTo(M,X),c.lineTo(M-m,X+m),c.moveTo(M,X),c.lineTo(M-m,X-m));1==W[d]&&T<.02*n[d].imgwidth?(c.moveTo(T,U),c.lineTo(T+m,U+m),c.moveTo(T,U),c.lineTo(T+m,U-m)):1==W[d]&&M<.02*n[d].imgwidth&&(c.moveTo(M,X),c.lineTo(M+m,X+m),c.moveTo(M,X),c.lineTo(M+m,X-m));c.stroke();if(1<n[d].dotline&&!(1>w[d][f].length-1)&&25>Math.pow(T-M,2)+Math.pow(U-X,2)){c.moveTo(w[d][f][0][0],
w[d][f][0][1]);for(h=1;h<w[d][f].length;h++)c.lineTo(w[d][f][h][0],w[d][f][h][1]);c.closePath();c.fill()}}c.fillStyle="rgb(0,0,255)";c.beginPath();for(f=0;f<K[d].length;f++)c.moveTo(K[d][f][0]+5,K[d][f][1]),c.arc(K[d][f][0],K[d][f][1],5,0,2*Math.PI,!0);c.fill();if(0<n[d].dotline){c.beginPath();for(f=0;f<w[d].length;f++)for(h=0;h<w[d][f].length;h++)if(0==h||25<Math.pow(w[d][f][h][0]-w[d][f][h-1][0],2)+Math.pow(w[d][f][h][1]-w[d][f][h-1][1],2))c.moveTo(w[d][f][h][0]+5,w[d][f][h][1]),c.arc(w[d][f][h][0],
w[d][f][h][1],5,0,2*Math.PI,!0);c.fill()}c.fillStyle="rgb(255,255,255)";c.beginPath();for(f=0;f<J[d].length;f++)c.moveTo(J[d][f][0]+5,J[d][f][1]),c.arc(J[d][f][0],J[d][f][1],4,0,2*Math.PI,!0);3>n[d].mode?c.fill():c.stroke();c.lineWidth=2;c.beginPath();for(f=0;f<J[d].length;f++)c.moveTo(J[d][f][0]+5,J[d][f][1]),c.arc(J[d][f][0],J[d][f][1],4,0,2*Math.PI,!0);c.stroke();for(f=0;f<r[d].length;f++)if(H[d][f]==n[d].mode){c.fillStyle="rgb(255,0,0)";for(h=0;h<r[d][f].length;h++)c.fillRect(r[d][f][h][0]-3,
r[d][f][h][1]-3,6,6);1==r[d][f].length&&null!=a&&G==f&&c.fillRect(a-3,b-3,6,6);c.fillStyle="rgb(0,0,255)"}c="";for(f=0;f<w[d].length;f++)for(0!=f&&(c+=";"),M=0;M<w[d][f].length;M++)0!=M&&(c+=","),c+="("+w[d][f][M][0]+","+w[d][f][M][1]+")";c+=";;";for(f=0;f<K[d].length;f++)0!=f&&(c+=","),c+="("+K[d][f][0]+","+K[d][f][1]+")";c+=";;";for(f=0;f<J[d].length;f++)0!=f&&(c+=","),c+="("+J[d][f][0]+","+J[d][f][1]+")";c+=";;";M=[];for(f=0;f<r[d].length;f++)1<r[d][f].length&&M.push("("+H[d][f]+","+r[d][f][0][0]+
","+r[d][f][0][1]+","+r[d][f][1][0]+","+r[d][f][1][1]+")");c+=M.join(",");c+=";;";M=[];for(f=0;f<u[d].length;f++)2<u[d][f].length&&M.push("("+P[d][f]+","+u[d][f][0][0]+","+u[d][f][0][1]+","+u[d][f][1][0]+","+u[d][f][1][1]+","+u[d][f][2][0]+","+u[d][f][2][1]+")");c+=M.join(",");ca[d].value=c}function m(c){ua++;ba();if(N&&1<c.originalEvent.touches.length)return Z=!0,a(document).on("touchend.imathasdraw",t),!0;N?(window.clearTimeout(ma),a(document).on("touchstart.imathasdraw",function(a){N=!0;m(a)}),
a(document).on("touchmove.imathasdraw",A),a(document).on("touchend.imathasdraw",t)):(a(document).on("mousemove.imathasdraw",A),a(document).on("mouseup.imathasdraw",t));c=E(c);if(null==d||null==D&&null==G&&null==L)for(i in n){var b=S(n[i].el);if(b.x<c.x&&b.x+n[i].width>c.x&&b.y<c.y&&b.y+n[i].height>c.y){d=i;break}}null!=d&&(V=!0,b=S(n[d].el),c={x:c.x-b.x,y:c.y-b.y},-1<c.x&&c.x<n[d].width&&-1<c.y&&c.y<n[d].height?(navigator.userAgent.match(/Android/i),0<n[d].snaptogridx&&(c=I(c,d)),1==W[d]&&(c.y=n[d].imgheight/
2),b=q(d,c),null!=b&&(null!=D&&1>b[0]&&D!=b[1]?b=null:null!=G&5<=b[0]&&10>b[0]&&G!=b[1]?b=null:null!=L&&10<=b[0]&&11>b[0]&&L!=b[1]&&(b=null)),null==b?(n[d].el.style.cursor="url("+imasroot+"/img/pendown.cur), default",1==n[d].mode?(K[d].push([c.x,c.y]),v={mode:1,num:K[d].length-1}):2==n[d].mode?(J[d].push([c.x,c.y]),v={mode:2,num:J[d].length-1}):0==n[d].mode||.7==n[d].mode?null==D?(w[d].push([[c.x,c.y]]),D=w[d].length-1):w[d][D].push([c.x,c.y]):.5==n[d].mode?null==D?(w[d].push([[c.x,c.y]]),D=w[d].length-
1):(w[d][D].push([c.x,c.y]),v=D=null):5<=n[d].mode&&10>n[d].mode?null==G?(r[d].push([[c.x,c.y]]),G=r[d].length-1,H[d][G]=n[d].mode,V=!1):(r[d][G].push([c.x,c.y]),2==r[d][G].length&&(v={mode:n[d].mode,num:G,subnum:1},G=null)):10<=n[d].mode&&11>n[d].mode&&(null==L?(u[d].push([[c.x,c.y]]),L=u[d].length-1,P[d][L]=n[d].mode,V=!1):(u[d][L].push([c.x,c.y]),3==u[d][L].length&&(v={mode:n[d].mode,num:L,subnum:1},L=null)))):(0==b[0]||.5==b[0]?null==D?(n[d].el.style.cursor="move",v={mode:n[d].mode,num:b[1],subnum:b[2]},
ea=w[d][b[1]][b[2]],b[2]==w[d][b[1]].length-1&&0==n[d].mode?D=b[1]:0==b[2]&&0==n[d].mode&&(D=b[1],w[d][D].reverse(),v.subnum=w[d][D].length-1)):b[1]==D&&b[2]==w[d][b[1]].length-1?(2>w[d][D].length&&w[d].splice(D,1),D=null):1<n[d].dotline&&b[1]==D&&0==b[2]?(w[d][D].push(w[d][D][0]),D=null):(n[d].el.style.cursor="url("+imasroot+"/img/pendown.cur), default",w[d][D].push([c.x,c.y])):1==b[0]?(n[d].el.style.cursor="move",v={mode:1,num:b[1]}):2==b[0]?(n[d].el.style.cursor="move",v={mode:2,num:b[1]}):5<=
b[0]&&10>b[0]?(n[d].el.style.cursor="move",v={mode:b[0],num:b[1],subnum:b[2]},ea=r[d][b[1]][b[2]]):10<=b[0]&&11>b[0]&&(n[d].el.style.cursor="move",v={mode:b[0],num:b[1],subnum:b[2]},ea=u[d][b[1]][b[2]]),ha=!0),h()):(null!=D&&(2>w[d][D].length&&w[d].splice(D,1),n[d].el.style.cursor="url("+imasroot+"/img/pen.cur), default"),null!=G&&(2>r[d][G].length&&r[d].splice(G,1),n[d].el.style.cursor="url("+imasroot+"/img/pen.cur), default"),null!=L&&(3>u[d][L].length&&u[d].splice(L,1),n[d].el.style.cursor="url("+
imasroot+"/img/pen.cur), default"),v=L=G=D=null,h(),d=null))}function q(a,b){if(N)var c=Math.max(15*window.innerWidth/screen.width,15),c=c*c;else c=25;if(0==ja[a])if(0==n[a].mode||.5==n[a].mode)for(var f=0;f<w[a].length;f++)for(var d=w[a][f].length-1;0<=d;d--){var g=Math.pow(w[a][f][d][0]-b.x,2)+Math.pow(w[a][f][d][1]-b.y,2);if(g<c)return[n[a].mode,f,d]}else if(1==n[a].mode)for(f=0;f<K[a].length;f++){if(Math.pow(K[a][f][0]-b.x,2)+Math.pow(K[a][f][1]-b.y,2)<c)return[1,f]}else if(2==n[a].mode)for(f=
0;f<J[a].length;f++){if(Math.pow(J[a][f][0]-b.x,2)+Math.pow(J[a][f][1]-b.y,2)<c)return[2,f]}else if(5<=n[a].mode&&10>n[a].mode)for(f=0;f<r[a].length;f++){if(H[a][f]==n[a].mode)for(d=r[a][f].length-1;0<=d;d--)if(g=Math.pow(r[a][f][d][0]-b.x,2)+Math.pow(r[a][f][d][1]-b.y,2),g<c)return[H[a][f],f,d]}else{if(10<=n[a].mode&&11>n[a].mode)for(f=0;f<u[a].length;f++)for(d=u[a][f].length-1;0<=d;d--)if(g=Math.pow(u[a][f][d][0]-b.x,2)+Math.pow(u[a][f][d][1]-b.y,2),g<c)return[P[a][f],f,d]}else if(1==n[a].mode)for(f=
0;f<K[a].length;f++){if(Math.pow(K[a][f][0]-b.x,2)+Math.pow(K[a][f][1]-b.y,2)<c)return[1,f]}else if(2==n[a].mode)for(f=0;f<J[a].length;f++){if(Math.pow(J[a][f][0]-b.x,2)+Math.pow(J[a][f][1]-b.y,2)<c)return[2,f]}else if(5<=n[a].mode&&10>n[a].mode)for(f=0;f<r[a].length;f++)for(d=r[a][f].length-1;0<=d;d--){if(H[a][f]==n[a].mode&&(g=Math.pow(r[a][f][d][0]-b.x,2)+Math.pow(r[a][f][d][1]-b.y,2),g<c))return[H[a][f],f,d]}else if(10<=n[a].mode&&11>n[a].mode)for(f=0;f<u[a].length;f++)for(d=u[a][f].length-1;0<=
d;d--)if(g=Math.pow(u[a][f][d][0]-b.x,2)+Math.pow(u[a][f][d][1]-b.y,2),g<c)return[P[a][f],f,d];return null}function t(b){var c=E(b);V=!1;if(null!=d){var g=S(n[d].el),f={x:c.x-g.x,y:c.y-g.y};0<n[d].snaptogridx&&(f=I(f,d));g=-1<f.x&&f.x<n[d].width&&-1<f.y&&f.y<n[d].height;1==ha&&(5<=n[d].mode&&10>n[d].mode?(r[d].push([[f.x,f.y]]),G=r[d].length-1,H[d][G]=n[d].mode):10<=n[d].mode&&11>n[d].mode&&(u[d].push([[f.x,f.y]]),L=u[d].length-1,P[d][L]=n[d].mode));null!=fa&&c.x==fa.x&&c.y==fa.y&&null!=D&&null==
v&&(2>w[d][D].length&&w[d].splice(D,1),v=D=null,h());null!=D&&null==v&&(.5==n[d].mode&&1<w[d][D].length?(dragobj=D=null,h()):.7==n[d].mode&&(dragobj=D=null,h()));null!=G&&1==r[d][G].length&&(Z||!g?(r[d].splice(G,1),G=null,h()):null==q(d,f)&&(r[d][G].push([f.x,f.y]),G=null,h()));null!=L&&1==u[d][L].length&&(Z||!g?(u[d].splice(L,1),L=null,h()):null==q(d,f)&&(u[d][L].push([f.x,f.y]),h()));n[d].el.style.cursor=null==D&&null==G?"move":"url("+imasroot+"/img/pen.cur), default";"undefined"!=typeof b&&b.preventDefault()}fa=
c;null!=d&&null!=v&&(g=S(n[d].el),-1<f.x&&f.x<n[d].width&&-1<f.y&&f.y<n[d].height?(0==v.mode&&1<n[d].dotline&&(0==v.subnum||v.subnum==w[d][v.num].length-1)&&25>Math.pow(w[d][v.num][0][0]-w[d][v.num][w[d][v.num].length-1][0],2)+Math.pow(w[d][v.num][0][1]-w[d][v.num][w[d][v.num].length-1][1],2)&&(0==v.subnum?(w[d][v.num][w[d][v.num].length-1][0]=w[d][v.num][0][0],w[d][v.num][w[d][v.num].length-1][1]=w[d][v.num][0][1]):(w[d][v.num][0][0]=w[d][v.num][w[d][v.num].length-1][0],w[d][v.num][0][1]=w[d][v.num][w[d][v.num].length-
1][1]),D=null,h()),v=null):(1==W[d]&&(f.y=n[d].imgheight/2),1==v.mode?K[d].splice(v.num,1):2==v.mode?J[d].splice(v.num,1):.5==v.mode?w[d].splice(v.num,1):0==v.mode?w[d][v.num][v.subnum]=ea:5<=v.mode&&10>v.mode?(r[d].splice(v.num,1),G=null):10<=v.mode&&11>v.mode&&(u[d].splice(v.num,1),L=null),v=null,h()));Z=!1;N?ma=window.setTimeout(function(){N=!1;ba();a(document).on("mousemove.imathasdraw",A);a(document).on("touchstart.imathasdraw",function(a){N=!0;m(a)});a(document).on("mousedown.imathasdraw",m)},
350):(ba(),a(document).on("mousemove.imathasdraw",A),a(document).on("touchstart.imathasdraw",function(a){N=!0;m(a)}),a(document).on("mousedown.imathasdraw",m))}function A(a){var b=null;ha=!1;var c=E(a);for(i in n){var f=S(n[i].el);if(f.x<c.x&&f.x+n[i].width>c.x&&f.y<c.y&&f.y+n[i].height>c.y){b=i;break}}null!=b&&(f=S(n[b].el),f={x:c.x-f.x,y:c.y-f.y},0<n[b].snaptogridx&&(f=I(f,b)),1==W[b]&&(f.y=n[b].imgheight/2),-1<f.x&&f.x<n[b].width&&-1<f.y&&f.y<n[b].height&&null==v&&null==D&&(f=q(b,f),n[b].el.style.cursor=
null==f?"url("+imasroot+"/img/pen.cur), default":"move"));if(null!=d){if(a.originalEvent.touches&&1<a.originalEvent.touches.length)return Z=!0;"undefined"!=typeof a&&a.preventDefault();f=S(n[d].el);f={x:c.x-f.x,y:c.y-f.y};0<n[d].snaptogridx&&(f=I(f,d));1==W[d]&&(f.y=n[d].imgheight/2);if(-1<f.x&&f.x<n[d].width&&-1<f.y&&f.y<n[d].height)return null==v?null!=D?!V||0!=n[d].mode&&.7!=n[d].mode?V&&.5==n[d].mode?(a=w[d][D].length-1,0==a?(a=Math.pow(w[d][D][a][0]-f.x,2)+Math.pow(w[d][D][a][1]-f.y,2),25<a?
(w[d][D].push([f.x,f.y]),h()):h(f.x,f.y)):(w[d][D][a]=[f.x,f.y],h())):h(f.x,f.y):(a=w[d][D].length-1,a=Math.pow(w[d][D][a][0]-f.x,2)+Math.pow(w[d][D][a][1]-f.y,2),25<a?(w[d][D].push([f.x,f.y]),h()):h(f.x,f.y)):null!=G?V?h():h(f.x,f.y):null!=L?V?h():h(f.x,f.y):(f=q(d,f),n[d].el.style.cursor=null==f?"url("+imasroot+"/img/pen.cur), default":"move"):(n[d].el.style.cursor="move",0==v.mode||.5==v.mode?w[d][v.num][v.subnum]=[f.x,f.y]:1==v.mode?K[d][v.num]=[f.x,f.y]:2==v.mode?J[d][v.num]=[f.x,f.y]:5<=v.mode&&
10>v.mode?r[d][v.num][v.subnum]=[f.x,f.y]:10<=v.mode&&11>v.mode&&(u[d][v.num][v.subnum]=[f.x,f.y]),h()),!1}}function E(a){a=a||window.event;if(N)return a=a.originalEvent.changedTouches[0]||a.originalEvent.touches[0],{x:a.pageX,y:a.pageY};if(a.pageX||a.pageY)return{x:a.pageX,y:a.pageY};var b=document.documentElement,c=document.body;if(b&&(b.scrollTop||b.scrollLeft))var d=b.scrollLeft,b=b.scrollTop;else c?(d=c.scrollLeft,b=c.scrollTop):b=d=0;return{x:a.clientX+d,y:a.clientY+b}}function I(a,b){var c=
a.x-n[b].imgborder+n[b].xmin*n[b].pixperx,d=a.y-n[b].imgborder-n[b].ymax*n[b].pixpery,c=Math.round(Math.round(c/(n[b].pixperx*n[b].snaptogridx))*n[b].pixperx*n[b].snaptogridx+n[b].imgborder-n[b].xmin*n[b].pixperx),d=Math.round(Math.round(d/(n[b].pixpery*n[b].snaptogridy))*n[b].pixpery*n[b].snaptogridy+n[b].imgborder+n[b].ymax*n[b].pixpery);return{x:c,y:d}}function aa(a,b){var c=S(a),d=E(b);return{x:d.x-c.x,y:d.y-c.y}}function S(a){for(var b=0,c=0;a.offsetParent;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;
b+=a.offsetLeft;c+=a.offsetTop;return{x:b,y:c}}function ba(){a(document).off("mousedown.imathasdraw").off("mousemove.imathasdraw").off("mouseup.imathasdraw");a(document).off("touchstart.imathasdraw").off("touchmove.imathasdraw").off("touchend.imathasdraw")}function ia(c){ba();a(document).on("mousemove.imathasdraw",A);a(document).on("touchstart.imathasdraw",function(a){N=!0;m(a)});a(document).on("mousedown.imathasdraw",m);try{CanvasRenderingContext2D.prototype.dashedLine=function(a,b,c,f,g){void 0==
g&&(g=10);this.beginPath();this.moveTo(a,b);var h=c-a,l=f-b;g=Math.sqrt(h*h+l*l)/g;h/=g;l/=g;g=Math.round(g);for(var m=0;m++<g&&-1<b&&b<n[d].imgheight+1&&-1<a&&a<n[d].imgwidth+1;)a+=h,b+=l,this[0==m%2?"moveTo":"lineTo"](a,b);this[0==m%2?"moveTo":"lineTo"](c,f);this.stroke();this.closePath()}}catch(g){}for(var h in canvases)if("undefined"==typeof c||c==h){var q=null;if(null!=drawla[h]&&2<drawla[h].length){w[canvases[h][0]]=drawla[h][0];K[canvases[h][0]]=drawla[h][1];J[canvases[h][0]]=drawla[h][2];
H[canvases[h][0]]=[];r[canvases[h][0]]=[];if(3<drawla[h].length&&0<drawla[h][3].length)for(var f=0;f<drawla[h][3].length;f++)H[canvases[h][0]][f]=drawla[h][3][f][0],r[canvases[h][0]][f]=[drawla[h][3][f].slice(1,3),drawla[h][3][f].slice(3)];P[canvases[h][0]]=[];u[canvases[h][0]]=[];if(4<drawla[h].length&&0<drawla[h][4].length)for(f=0;f<drawla[h][4].length;f++)P[canvases[h][0]][f]=drawla[h][4][f][0],u[canvases[h][0]][f]=[drawla[h][4][f].slice(1,3),drawla[h][4][f].slice(3,5),drawla[h][4][f].slice(5)];
5<drawla[h].length&&(q=drawla[h][5])}"a11ydraw"==canvases[h][1].substr(0,8)?b(canvases[h],q):l(canvases[h][0],"canvas"+canvases[h][0],imasroot+"/filter/graph/imgs/"+canvases[h][1],"qn"+canvases[h][0],canvases[h][2],canvases[h][3],canvases[h][4],canvases[h][5],canvases[h][6],canvases[h][7],canvases[h][8],canvases[h][9],canvases[h][10],canvases[h][11],canvases[h][12])}}function na(b){for(var c,d=0;d<B.idnums.length;d++)if("undefined"==typeof b||b==B.idnums[d]){var f=c=B.idnums[d],g,h,l;g=document.getElementById("qn"+
f).value;(l=g.match(/\(-oo,([\-\d\.]+)\)U\(([\-\d\.]+),oo\)/))?(g=3,h=l[1],l=l[2]):(l=g.match(/\(-oo,([\-\d\.]+)\)/))?(g=0,h=l[1],l=2.5):(l=g.match(/\(([\-\d\.]+),oo\)/))?(g=1,h=l[1],l=2.5):(l=g.match(/\(([\-\d\.]+),([\-\d\.]+)\)/))?(g=2,h=l[1],l=l[2]):(g=0,h=-1.5,l=2.5);document.getElementById("slid1"+f).style.left=60*h+250-6+"px";document.getElementById("slid2"+f).style.left=60*l+250-6+"px";document.getElementById("shaderegions"+f).selectedIndex=g;B.curslider.type=document.getElementById("shaderegions"+
f).value;oa(f);a("#slid1"+c).on("touchstart.normslider mousedown.normslider",pa);a("#slid2"+c).on("touchstart.normslider mousedown.normslider",pa)}}function pa(b){b=b||window.event;b.originalEvent.touches&&0<b.originalEvent.touches.length?(N=!0,a(document).on("touchmove.normslider",qa),a(document).on("touchend.normslider",ra)):(a(document).on("mousemove.normslider",qa),a(document).on("mouseup.normslider",ra));B.curslider.el=b.target||b.srcElement;B.curslider.id=B.curslider.el.id.substring(5);B.curslider.type=
document.getElementById("shaderegions"+B.curslider.id).value;B.curslider.outnode=document.getElementById(B.outputid);B.curslider.startpos=aa(B.curslider.el,b);B.curslider.el.parentNode.style.cursor="pointer";S(B.curslider.el.parentNode);b.preventDefault&&b.preventDefault();return!1}function qa(a){var b=B.curslider.id;a=a||window.event;var c=aa(B.curslider.el.parentNode,a);if(!(5>c.x||c.x>B.curslider.el.parentNode.offsetWidth-5||5>c.y||c.y>B.curslider.el.parentNode.offsetHeight-5))return B.curslider.el.style.left=
6*Math.round((c.x-B.curslider.startpos.x-10)/6)+10+"px",sa(b),a.preventDefault&&a.preventDefault(),!1}function ra(b){null!==B.curslider.el&&(N=!1,a(document).off("touchmove.normslider touchend.normslider"),a(document).off("mousemove.normslider mouseup.normslider"),B.curslider.el.parentNode.style.cursor="",B.curslider.el=null)}function sa(a){var b=parseInt(document.getElementById("slid1"+a).style.left)+6,c=parseInt(document.getElementById("slid2"+a).style.left)+6,d=Math.min(b,c),g=Math.max(b,c);"2O"==
B.curslider.type?document.getElementById("normleft"+a).style.width=d+1+"px":"1L"==B.curslider.type?document.getElementById("normleft"+a).style.width=b+1+"px":"2B"==B.curslider.type&&(document.getElementById("normleft"+a).style.left=d+"px",document.getElementById("normleft"+a).style.width=g-d+1+"px");"2O"==B.curslider.type?document.getElementById("normright"+a).style.width=500-g+"px":"1R"==B.curslider.type&&(document.getElementById("normright"+a).style.width=500-b+"px");var d=(-4+(b-10)/60).toFixed(1),
g=(-4+(c-10)/60).toFixed(1),h=document.getElementById("slid1txt"+a);h.innerHTML=d;h.style.left=b-6+"px";b=document.getElementById("slid2txt"+a);b.innerHTML=g;b.style.left=c-6+"px";c=Math.min(d,g);b=Math.max(d,g);if("2O"==B.curslider.type)var l="(-oo,"+c+")U("+b+",oo)";else"2B"==B.curslider.type?l="("+c+","+b+")":"1L"==B.curslider.type?l="(-oo,"+d+")":"1R"==B.curslider.type&&(l="("+d+",oo)");document.getElementById("qn"+a).value=l}function oa(a){var b=document.getElementById("shaderegions"+a).value;
B.curslider.type=b;var c=parseInt(document.getElementById("slid1"+a).style.left)+6,d=parseInt(document.getElementById("slid2"+a).style.left)+6,g=Math.min(c,d),d=Math.max(c,d);"1R"==b||"1L"==b?(document.getElementById("slid2"+a).style.display="none",document.getElementById("slid2txt"+a).style.display="none","1R"==b?(document.getElementById("normleft"+a).style.display="none",document.getElementById("normright"+a).style.display="",document.getElementById("normright"+a).style.right="0px",document.getElementById("normright"+
a).style.width=500-c+"px"):(document.getElementById("normright"+a).style.display="none",document.getElementById("normleft"+a).style.display="",document.getElementById("normleft"+a).style.left="0px",document.getElementById("normleft"+a).style.width=c+"px")):"2O"==b?(document.getElementById("slid2"+a).style.display="",document.getElementById("slid2txt"+a).style.display="",document.getElementById("normleft"+a).style.display="",document.getElementById("normright"+a).style.display="",document.getElementById("normright"+
a).style.right="0px",document.getElementById("normleft"+a).style.left="0px",document.getElementById("normright"+a).style.width=500-d+"px",document.getElementById("normleft"+a).style.width=g+"px"):"2B"==b&&(document.getElementById("slid2"+a).style.display="",document.getElementById("slid2txt"+a).style.display="",document.getElementById("normleft"+a).style.display="",document.getElementById("normright"+a).style.display="none",document.getElementById("normleft"+a).style.left=g+"px",document.getElementById("normleft"+
a).style.width=d-g+"px");sa(a)}var V=!1,n=[],da=[],ca=[],ga=[],w=[],K=[],J=[],r=[],H=[],u=[],P=[],D=null,ja=[],W=[],G=null,L=null,la=["rgb(0,0,255)","rgb(255,0,0)","rgb(0,255,0)"],ta=["rgba(0,0,255,.4)","rgba(255,0,0,.4)","rgba(0,255,0,.4)"],v=null,ea=null,d=null,ka=!1,N=!1,Z=!1,ha=!1,ma=null,ua=0,fa=null;"undefined"!=typeof initstack?initstack.push(ia):a(function(){ia()});var B={idnums:[],curslider:{el:null,startpos:[0,0],outnode:null}};"undefined"!=typeof initstack&&initstack.push(na);return{initCanvases:ia,
clearcanvas:function(a){w[a].length=0;K[a].length=0;J[a].length=0;r[a].length=0;H[a].length=0;u[a].length=0;P[a].length=0;d=a;h();v=D=d=null},settool:function(a,b,c){for(var f=document.getElementById("drawtools"+b),g=f.getElementsByTagName("span"),l=0;l<g.length;l++)g[l].className="";g=f.getElementsByTagName("img");for(l=0;l<g.length;l++)g[l].className="";a.className="sel";n[b].mode=c;d=b;h()},addnormslider:function(a){-1==arraysearch(a,B.idnums)?B.idnums.push(a):na(a)},chgnormtype:oa,adda11ydraw:c,
changea11ydraw:function(b,c){var d=a(b).val(),d=n[c].moderef[d];a(b).parent().find(".a11ydrawinstr").text(d.input)},encodea11ydraw:function(){for(var b=0;b<ga.length;b++){var c=ga[b],d=n[c],f=[],g=[],h=[],l=[],m=[],q=[];a("#a11ydraw"+c).find(".a11ydrawrow").each(function(b,c){var n=a(c).find("select").val(),r=a(c).find("input").val();q.push("["+n+',"'+r+'"]');var r=r.replace(/[\(\)]/g,"").split(/\s*,\s*/),t=[];for(b=1;b<r.length;b+=2){try{with(Math)r[b-1]=eval(mathjs(r[b-1]))}catch(u){r[b-1]=NaN}try{with(Math)r[b]=
eval(mathjs(r[b]))}catch(u){r[b]=NaN}r[b-1]=(r[b-1]-d.xmin)*d.pixperx+d.imgborder;r[b]=d.imgheight-(r[b]-d.ymin)*d.pixpery-d.imgborder;t.push(Math.round(r[b-1])+","+Math.round(r[b]))}1==n?g.push("("+t.join("),(")+")"):2==n?h.push("("+t.join("),(")+")"):1>n?f.push("("+t.join("),(")+")"):5<=n&&10>n&&2==t.length?l.push("("+n+","+t.join(",")+")"):10<n&&3==t.length&&m.push("("+n+","+t.join(",")+")")});ca[c].value=f.join(";")+";;"+g.join(",")+";;"+h.join(",")+";;"+l.join(",")+";;"+m.join(",")+";;"+q.join(",")}},
removea11ydraw:function(b){a(b).parent().remove()}}}(jQuery),ehcurel=null,ehclosetimer=0,ehddclosetimer=0,curehdd=null,eecurel=null;function showeh(a){if(null==eecurel){unhideeh(0);el=document.getElementById(a);var b=document.getElementById("eh");a!=ehcurel?(ehcurel=a,p=findPos(el),b.style.display="block",b.style.left=p[0]+"px",b.style.top=p[1]+el.offsetHeight+"px"):(b.style.display="none",ehcurel=null);el.focus()}}
function reshrinkeh(a){null==eecurel&&a==ehcurel&&(document.getElementById("ehdd").style.display="block",document.getElementById("eh").style.display="none",ehcurel=null,curehdd=a,unhideeh(0))}function unhideeh(a){ehcancelclosetimer()}function hideeh(a){null==ehcurel?ehddclosetimer=window.setTimeout(function(){curehdd=null;document.getElementById("ehdd").style.display="none"},250):ehclosetimer=window.setTimeout(reallyhideeh,250)}
function reallyhideeh(){document.getElementById("eh").style.display="none";ehcurel=null}function ehcancelclosetimer(){ehclosetimer&&(window.clearTimeout(ehclosetimer),ehclosetimer=null)}
function showehdd(a,b,c){if((null==eecurel||eecurel!=a)&&null!=document.getElementById("tips"+c)){ehddclosetimer&&a!=curehdd&&(window.clearTimeout(ehddclosetimer),ehddclosetimer=null);if(a!=ehcurel){var g=document.getElementById("ehdd"),l=document.getElementById(a);p=findPos(l);document.getElementById("ehddtext").innerHTML=b;document.getElementById("eh").innerHTML=document.getElementById("tips"+c).innerHTML;g.style.display="block";g.style.left=p[0]+"px";g.style.top=p[1]+l.offsetHeight+"px"}curehdd=
a}}function updateehpos(){if(curehdd||ehcurel){var a=document.getElementById("eh"),b=document.getElementById("ehdd"),c=document.getElementById(curehdd||ehcurel);p=findPos(c);a.style.left=p[0]+"px";a.style.top=p[1]+c.offsetHeight+"px";b.style.left=p[0]+"px";b.style.top=p[1]+c.offsetHeight+"px"}};
